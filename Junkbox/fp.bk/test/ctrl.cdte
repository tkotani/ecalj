TESTLMF  lmfa cdte -vnsp=2 -vnit=10 -vmetal=2 -vasa=f -vlmf=t -vnl=5 -vlmxb=4 -vtpdc=4 -vlfc=t -vlfa=t -vbigbas=12 -vgwbas=t -vnk=4
         echo self-consistent LDA+U calculation, U=4 eV on Cd d
         echo " " IDU= 2 0 2 UH= 0/13.6 0 4/13.6  JH= 0 0 0 >specialspecc
         lmf cdte  -vnsp=2 -vnit=10 -vmetal=2 -vasa=f -vlmf=t -vnl=5 -vbzj=0 -vlmxb=4 -vtpdc=4 -vlfc=t -vlfa=t -vbigbas=12 -vgwbas=t -vnk=4 --iactiv=no --pr31
         echo " " IDU= 2 0 4 UH= 0/13.6 0 -2/13.6  JH= 0 0 0 >specialspecc
         lmf cdte  -vnsp=2 -vnit=1 -vmetal=2 -vasa=f -vlmf=t -vnl=5 -vbzj=0 -vlmxb=4 -vtpdc=4 -vlfc=t -vlfa=t -vbigbas=12 -vgwbas=t -vnk=4 --iactiv=no --pr31 --rs=1,0
         echo " " IDU= 4 0 4 UH= 1/13.6 0 -2/13.6  JH= 0 0 0 >specialspecc
         lmf cdte  -vnsp=2 -vnit=1 -vmetal=2 -vasa=f -vlmf=t -vnl=5 -vbzj=0 -vlmxb=4 -vtpdc=4 -vlfc=t -vlfa=t -vbigbas=12 -vgwbas=t -vnk=4 --iactiv=no --pr31 --rs=1,0
         echo " " IDU= 2 0 4 UH= .337 0 -2/13.6  JH= 0 0 0 >specialspecc
         lmf cdte  -vnsp=2 -vnit=1 -vmetal=2 -vasa=f -vlmf=t -vnl=5 -vbzj=0 -vlmxb=4 -vtpdc=4 -vlfc=t -vlfa=t -vbigbas=12 -vgwbas=t -vnk=4 --iactiv=no --pr31 --rs=1,0
ENDTEST
# --- Master file for supercells of ZB semiconductors ---
# Updates
#   24 Jun 08  Modifications to SQS structures
#   27 Mar 07  New general 'file' structure
#   28 Feb 07  New trigonal structure
#   18 Oct 06  Chalcopyrite structure
#   15 Aug 06  Antiflourite structure, e.g. Cu2S
#   23 Jul 05  Added L21 structure for full Heusler alloys
#    8 Jul 05  10's digit les signifies floating orbitals
#   25 Mar 05  Added cuprite structure
#    3 Sep 04  optional input of special SPEC data file specialspec
#   19 Jun 04  New C1 structure.
#   10 Jun 04  New C1_b structure.
#      Mar 04  NiAs structure and other small modifications
#   25 Jun 03  Switches for self-consistent GW
#   05 Oct 01  clean up misc variables and separate basis declarations.
#   22 Sep 01  Use G-vector tol=1e-6 QASA=3
#   22 May 01  split off les from tbe
#   13 Sep 00  added input for lmf
# ... strx one of the following:
#     ZB DO22 CUAU SQS4 SQS8 NaCl CsCl CsCl-A3B WZ CuPt NiAs C1 C1b
# ... Typical job for ASA screened exchange:
#     lm -vso=f -long -csxopts='rssig;nit=3' -vnit=0 -vbzj=0 -vccor=1 -vtwoc=0
#     -vnk=8 -vnk2=nk -vsx=3 -vscr=10 -vgamma=sx -vadnf=f -vnl=3 sx
# ... Typical job for lmf:
#     lmf semi -vasa=f -vlmf=t -vnit=10 -vnk=2 -vngd=20 -vlmxb=3 -vlmbe=2
# ... Typical job for tbe (unchecked)
#     rdfile -va=9.37 -vtbe=t -vnl=2 ctrl.semi > ctrl.tb
# ... Typical job for ofp (unchecked ... you are on your own)
#     ofp-specific treatment of two panel
#     tp[spd]c are for treatment of cation s,pd orbitals:
#     Use tpdc=0,1 for cation  hi d, no 2pan, low d pan 1, no 2pan
#                2 for cation  hi d pan1 + low d pan 2
#                4  for low d pan1 + pan 2
#     Ditto tpsc,tppc for cation s and p orbitals
# --- Uncomment one of the following ---
#% char cmpd AlN strx CuAu eltc Al elta N eltb Ga
#% char cmpd Si2GeC strx DO22 elta Si eltc C eltb Ge
#% char cmpd SiGe strx ZB eltc Si elta Ge
#% char cmpd SiC strx ZB eltc Si elta C
#% char cmpd GeC strx ZB eltc Ge elta C
#% char cmpd C  strx ZB  eltc C  elta C
#% char cmpd Si strx ZB  eltc Si elta Si
#% char cmpd Ge strx ZB  eltc Ge elta Ge
#% char cmpd Sn strx ZB  eltc Sn elta Sn
#% char cmpd BeO strx WZ  eltc Be elta O
#% char cmpd BeS strx ZB  eltc Be elta S
#% char cmpd BeSe strx ZB  eltc Be elta Se
#% char cmpd BeTe strx ZB  eltc Be elta Te
#% char cmpd MgO strx NaCl eltc Mg elta O
#% char cmpd MgS strx ZB  eltc Mg elta S
#% char cmpd MgSe strx ZB  eltc Mg elta Se
#% char cmpd MgTe strx ZB  eltc Mg elta Te
#% char cmpd CdO strx NaCl eltc Cd elta O
#% char cmpd CaO strx NaCl eltc Ca elta O
#% char cmpd BaO strx NaCl eltc Ba elta O
#% char cmpd AlN strx WZ  eltc Al elta N
#% char cmpd GaN strx WZ  eltc Ga elta N
#% char cmpd InN strx WZ  eltc In elta N
#% char cmpd MnN strx ZB  eltc Mn elta N
#% char cmpd CrN strx ZB  eltc Cr elta N
#% char cmpd BN strx ZB  eltc B elta N
#% char cmpd BP strx ZB  eltc B elta P
#% char cmpd BAs strx ZB  eltc B elta As
#% char cmpd AlP strx ZB  eltc Al elta P
#% char cmpd GaP strx ZB  eltc Ga elta P
#% char cmpd InP strx ZB  eltc In elta P
#% char cmpd TlP strx ZB  eltc Tl elta P
#% char cmpd CrP strx ZB  eltc Cr elta P
#% char cmpd MnP strx ZB  eltc Mn elta P
#% char cmpd AlAs strx ZB eltc Al elta As
#% char cmpd  NiMnSb strx C1b eltc Ni elta Sb eltb=Mn
#  This line for CoMnGa, CoMnSi, CoMnGe, CoMnSn; change elta to suit
#% char cmpd  CoMnGa strx L21 eltc Co elta Ga eltb=Mn
#% char cmpd CrAs strx ZB  eltc Cr elta As
#% char cmpd MnAs strx NiAs eltc Mn elta As
#% char cmpd GaAs strx ZB eltc Ga elta As
#% char cmpd InAs strx ZB eltc In elta As
#% char cmpd TlAs strx ZB eltc Tl elta As
#% char cmpd ScN strx NaCl eltc Sc elta N
#% char0 cmpd ErAs strx NaCl eltc Er elta As
#% char cmpd EuN strx NaCl eltc Eu elta N
#% char cmpd GdN strx NaCl eltc Gd elta N
#% char cmpd GdP strx NaCl eltc Gd elta P
#% char cmpd GdAs strx NaCl eltc Gd elta As
#% char cmpd SrO strx NaCl eltc Sr elta O
#% char cmpd AlSb strx ZB eltc Al elta Sb
#% char cmpd GaSb strx ZB eltc Ga elta Sb
#% char cmpd InSb strx ZB eltc In elta Sb
#% char cmpd TlSb strx ZB eltc Tl elta Sb
#% char cmpd ZnO strx WZ eltc Zn elta O
#% char cmpd ZnS strx ZB eltc Zn elta S
#% char cmpd CdS strx WZ eltc Cd elta S
#% char cmpd HgS strx ZB eltc Hg elta S
#% char cmpd ZnSe strx ZB eltc Zn elta Se
#% char cmpd CuCl strx ZB eltc Cu elta Cl
#% char cmpd CuBr strx ZB eltc Cu elta Br
#% char cmpd CdSe strx WZ eltc Cd elta Se
#% char cmpd HgSe strx ZB eltc Hg elta Se
#% char cmpd ZnTe strx ZB eltc Zn elta Te
% char cmpd CdTe strx ZB eltc Cd elta Te
#% char cmpd HgTe strx ZB eltc Hg elta Te
#% char cmpd NiAs strx NiAs eltc Ni elta As
#% char cmpd CaF2 strx C1 eltc Ca elta F
#% char cmpd CeO2 strx C1 eltc Ce elta O
#% char cmpd Ce2O3 strx file eltc Ce elta O
#% char cmpd ZrO2 strx file eltc Zr elta O
#% char cmpd HfO2 strx file eltc Hf elta O
#% char cmpd Al2O3 strx file eltc Al elta O
#% char cmpd CuAlO2 strx delafossite eltc Cu eltb Al elta O
#% char cmpd Bi2Te3 strx tetradymite eltc Te eltb Te elta Bi
#% char cmpd Bi2Se3 strx tetradymite eltc Se eltb Se elta Bi
#% char cmpd CuGaSe2 strx chalcopyrite eltc Cu eltb Ga elta Se
#% char cmpd CuInSe2 strx chalcopyrite eltc Cu eltb In elta Se
#% char cmpd MgSiP2 strx chalcopyrite eltc Mg eltb Si elta P
#% char cmpd ZnSiP2 strx chalcopyrite eltc Zn eltb Si elta P
#% char cmpd ZnGeP2 strx chalcopyrite eltc Zn eltb Ge elta P
#% char cmpd ZnSnP2 strx chalcopyrite eltc Zn eltb Sn elta P
#% char cmpd ZnSiAs2 strx chalcopyrite eltc Zn eltb Si elta As
#% char cmpd ZnGeAs2 strx chalcopyrite eltc Zn eltb Ge elta As
#% char cmpd ZnSnAs2 strx chalcopyrite eltc Zn eltb Sn elta As
#% char cmpd CdSiP2 strx chalcopyrite eltc Cd eltb Si elta P
#% char cmpd CdGeP2 strx chalcopyrite eltc Cd eltb Ge elta P
#% char cmpd CdSnP2 strx chalcopyrite eltc Cd eltb Sn elta P
#% char cmpd CdSiAs2 strx chalcopyrite eltc Cd eltb Si elta As
#% char cmpd CdGeAs2 strx chalcopyrite eltc Cd eltb Ge elta As
#% char cmpd CdSnAs2 strx chalcopyrite eltc Cd eltb Sn elta As
#% char cmpd Cu2O strx cuprite eltc Cu elta O
#% char cmpd Cu2S strx aC1 eltc Cu elta S
#% char cmpd CoO2 strx trigonal eltc Co elta O
#% char cmpd FeO strx NaCl eltc Fe elta O eltb Fe
#
#% const lmxb=321 lmbe=199
% const  asa=1 lmf=0 tbe=0 ofp=~(asa|lmf|tbe) les=asa|ofp sx=f scr=0 twoc=f nl=lmf?4:3 so=f hf=f
% const  xcn=0 lmh=f link=0 elink=-2 lmxb=asa?2:(lmf?2:(link?129:221)) lmbe=asa?2:(lmf?2:999)
% const  bmod=1 scale=.983 nit=0 lf1=lmf?nl-1:6 tetra=t ef0=0 xcf=2 gga=0 tpan=2 ef=0 da=0
% cconst npan+1 tpan=npan-1
% const  elind=-1
% cvar  les>=10 rwec=0 rwea=0
#---------------- Materials-dependent constants ----------------
% ifdef strx=='ZB' | strx=='WZ' | strx=='NaCl'
% else
%   const metal=t
% endif
% cconst eltb nelt=3
% const  nelt=2
% char0 eltb ""
% char strn "({eltb}){cmpd} in the {strx} structure"
% ifdef asa
%   char strn "{strn} nl={nl}"
% elseif ofp
%   char strn "{strn} tpan={tpan}"
% endif
% echo {strn}
% includo semi.mater
% ifdef tbe | rpos
% includo tbparms
% endif
# ... defaults: for any Zb
% ifdef strx=='DO22'
%   const Zb=Zc erefb=erefc
% endif
#HEADER {cmpd} in the {strx} structure, a(ZB)={azb} {strn2}
#---------------- Materials-dependent class data ----------------
% var ixx=0
% while  ixx+=1 ixx<=nelt
%   cchar eltxx ixx==1 a ixx<nelt b ixx==nelt c
%   char0 strn{eltxx} ""
%   char0 strne{eltxx} ""
%   ifdef lmb{eltxx}
%     char strn{eltxx} "{strn{eltxx}} LMX={lmb{eltxx}}"
%   endif
%   ifdef lmbe{eltxx}
%     char strne{eltxx} "{strne{eltxx}} LMX={lmbe{eltxx}}"
%   endif
%   ifdef lmae{eltxx}
%     char strne{eltxx} "{strne{eltxx}} LMXA={lmae{eltxx}}"
%   endif
%   ifdef lmf | asa
%   ifdef lmf
%     char strn{eltxx} "{strn{eltxx}} LMX={lmxb} LMXA=lmxa"
%     char strne{eltxx} "{strne{eltxx}} LMX={lmbe} LMXA=lmxae"
%   else
%     char strn{eltxx} "{strn{eltxx}} LMX={lmxb}"
%     char strne{eltxx} "{strne{eltxx}} LMX={lmbe}"
%   endif
%   elseif ofp
%     char strn{eltxx}  "{strn{eltxx}} LMXB={lmxb} LMXF=lf1 LMXA=lmxa"
%     char strne{eltxx} "{strne{eltxx}} LMXB={lmbe} LMXF=lf2 LMXA=lmxae"
%     ifdef link{eltxx}
%       stop 1 archaic string 'link{eltxx}' ... change to strn{eltxx}
%     endif
%   endif
% end
% udef ixx eltxx
# Suppress symmetry operations for m-resolved dos.  Add switches:
# -vmdos=mdos --pdos:mode=mdos?2:1:sites=1,3 --no-fixef0
%ifdef mdos
SYMGRP  E
%endif
% ifdef strx=='ZB' | strx=='zb'
---------------- ZB structure ----------------
% const a=azb nk=6 avw=(3*a^3/64/pi)^(1/3)
% ifdef bmod
SYMGRP  R4Z*I MX*I R3D find
% elseifd tet
SYMGRP  R4Z*I MX*I find
% elseifd trig
SYMGRP  R3D M(1,-1,0) find
% endif
# special to col IV: uncomment special STRUC and SITE categories
# STRUC   NBAS=4/{les?1:2} NCLASS=2/{les?1:2} NL={nl} ELINK={elink}
#         ALAT=a DALAT=da PLAT= 0 .5 .5    .5 0 .5    .5 .5 0
# % ifdef tet
#         SHEAR=0 0 1 {tet}
# % elseifd trig
#         SHEAR=1 1 1 {trig}
# % endif
# SITE    FILE=site
STRUC   NBAS=4/{les?1:2} NCLASS=4/{les?1:2} NL={nl} ELINK={elink}
        ALAT=a DALAT=da PLAT= 0 .5 .5    .5 0 .5    .5 .5 0
% ifdef tet
        SHEAR=0 0 1 {tet}
% elseifd trig
        SHEAR=1 1 1 {trig}
% endif
% ifdef file
        FILE=site
SITE    FILE=site
% endif
SITE    ATOM=C1  POS=  0+wto   0+wto   0+wto
        ATOM=A1  POS= .25-wto+kl .25-wto+kl .25-wto+kl
        ATOM=EA1 POS= .50+kl/2   .50+kl/2   .50+kl/2
        ATOM=EC1 POS= .75   .75   .75
% elseifd strx=='file'
---------------- A general cell with 2 or 3 species, + ES ----------------
# If nelt is 2, species are C1, A1, EA1, optionally EC1
# If nelt is 3, species are C1, B1, A1, EA1, optionally EC1
# `avw' is assumed to be unity; `a' is taken from the site file
# Required data (in semi.mater): Zc(,Zb),Za  and rwc(,rwb),rwa (rwea,rwec)
% const nk=4 a=0 avw=1
SYMGRP  find
STRUC   NSPEC={(les%10)+nelt} NL={nl} FILE=site
        DALAT={da}
% ifdef tet
        SHEAR=0 0 1 {tet}
% elseifd trig
        SHEAR=1 1 1 {trig}
% endif
SITE    FILE=site
SPEC
#       SCLWSR=T OMAX1=.15 .20 .3
%iffile specialspec
%  echo including file specialspec in SPEC category
%  include specialspec
%endif
        ATOM=C1 Z={Zc} R/A=rwc A=.015 EREF={tbe?0:erefc}
         {strnc}
% ifdef basc
          {basc}
% endif
%iffile specialspecc
%  echo including file specialspecc in SPEC category
%  include specialspecc
%endif
% ifdef nelt>2
        ATOM=B1 Z={Zb} R/A=rwc A=.015 EREF={tbe?0:erefb}
         {strnb}
% ifdef basb
          {basb}
% endif
%iffile specialspecb
%  echo including file specialspecb in SPEC category
%  include specialspecb
%endif
%endif
        ATOM=A1 Z={Za} R/A=rwa A=.015 EREF={tbe?0:erefa}
         {strna}
% ifdef basa
          {basa}
% endif
%iffile specialspeca
%  echo including file specialspeca in SPEC category
%  include specialspeca
%endif
        ATOM=EA1 Z=0 R/A=rwea*{(les>10)?0:1} A=.015
% ifndef strnea==' '
         {strnea}
% ifdef base
          {base}
% endif
% endif
        ATOM=EC1 Z=0 R/A=rwec*{(les>10)?0:1} A=.015
% ifndef strnec==' '
         {strnec}
%        ifdef base
          {base}
%        endif
% endif
% elseifd strx=='trigonal'
---------------- General trigonal structure -3m (AKA Gamma_rh or D3d) ------
# Required data (in semi.mater) is nbas,nspec, a,q and 
# rwc(,rwb),rwa (rwea,rwec) (in atomic units, since avw=1)
# Also required are positions in file site
% const nk=4 avw=1 
#% const vol=a^3*q*'sqrt(3)*3/2'
SYMGRP  find
STRUC   NBAS={nbas} NSPEC={nspec} NL={nl}
        ALAT={a}  PLAT= 1  0  {q}  -0.5 {sqrt(3)/2} {q}  -0.5 -{sqrt(3)/2} {q}
SITE   FILE=site
% elseifd strx=='slat'
---------------- A superlattice defined by `site' with one impurity (supersede with 'file') ----------------
# You must supply `a' and `avw'
%const a=0 avw=0 nk=4
STRUC   NL={nl} NSPEC={les?5:3} ALAT=a FILE=site
SITE    FILE=site
SPEC
%iffile specialspec
%  echo including file specialspec in SPEC category
%  include specialspec
%endif
        ATOM=C1 Z={Zc} R=avw*rwc A=.015 EREF={tbe?0:erefc}
         {strnc}
% ifdef basc
          {basc}
% endif
%iffile specialspecc
%  echo including file specialspecc in SPEC category
%  include specialspecc
%endif
        ATOM=B1 Z={Zb} R=avw*rwc A=.015 EREF={tbe?0:erefb}
         {strnb}
% ifdef basb
          {basb}
% endif
%iffile specialspecb
%  echo including file specialspecb in SPEC category
%  include specialspecb
%endif
        ATOM=A1 Z={Za} R=avw*rwa A=.015 EREF={tbe?0:erefa}
         {strna}
% ifdef basa
          {basa}
% endif
%iffile specialspeca
%  echo including file specialspeca in SPEC category
%  include specialspeca
%endif
        ATOM=EA1 Z=0 R=avw*rwea A=.015
% ifndef strnea==' '
         {strnea}
% ifdef base
          {base}
% endif
% endif
        ATOM=EC1 Z=0 R=avw*rwec A=.015
% ifndef strnec==' '
         {strnec}
%        ifdef base
          {base}
%        endif
% endif
% elseifd strx=='CuPt'
---------------- CuPt structure ----------------
% const a=azb nk=6 ncell=2
SYMGRP  R3D M(1,-1,0)
STRUC   NBAS=8/{les?1:2} NCLASS=8/{les?1:2} NL={nl} ELINK={elink}
        ALAT=a DALAT=da PLAT=  1 .5 .5   .5 1 .5   .5 .5 1
SITE    ATOM=C1    POS=   0.00+y         0.00+y         0.00+y
        ATOM=A1    POS=   0.25+y2        0.25+y2        0.25+y2
        ATOM=B1    POS=   0.50+y3        0.50+y3        0.00+y3
        ATOM=A2    POS=   0.25-y-y2-y3  -0.25-y-y2-y3  -0.25-y-y2-y3
        ATOM=EA1   POS=   0.50           0.00           0.00
        ATOM=EC1   POS=   0.25           0.25          -0.25
        ATOM=EA2   POS=  -0.50           0.00           0.00
        ATOM=EB1   POS=  -0.25          -0.25          -0.25
CLASS   ATOM=C1 Z={Zc} R/W=rwc A=.015 EREF={tbe?0:erefc} LMXA=lmxa
          {strnc}
        ATOM=B1 Z={Zb} R/W=rwb A=.015 EREF={tbe?0:erefb} LMXA=lmxa
          {strnb}
% repeat i=1:2
        ATOM=A{i} Z={Za} R/W=rwa A=.015 EREF={tbe?0:erefa} LMXA=lmxa
          {strna}
% end
% repeat i=1:2
        ATOM=EA{i} Z=0 R/W=rwea LMX={lmbe} LMXA=lmxae A=.015
% ifndef strnea==' '
          {strnea}
% endif
        ATOM=EC{i} Z=0 R/W=rwec LMX={lmbe} LMXA=lmxae A=.015
% ifndef strnec==' '
          {strnec}
% endif
% end
% const bzj=1
CONST   a={a} bzj={bzj} lf1={lf1} lf2=lf1 lmxa=lf1 lmxae=lf2
        rw={ASA?1:(LMF?.9:.85)} rwe=rw nk={nk}
        y=0 y2=0 y3=0
% elseifd strx=='WZ'
---------------- Wurzite structure ----------------
% const awz=azb/sqrt(2) q=sqrt(8/3) avw=(3*(awz*sqrt(2))^3*q/sqrt(8/3)/64/pi)^(1/3)
% const a=awz nk=6 lf1={lf1} lfea=lf1 lfec=3 tetra=0
SYMGRP  find
SYMGRP  R6Z:(1/sqrt(3),0,q/2) MY
% var i=8/{les?1:2} j=4/{les?1:2}
%ifdef les&lmbec<0
% var i=6 j=3
%endif
STRUC   NBAS={i} NCLASS={j} NL={nl} ALAT=a DALAT=da
        PLAT= 0 -1 0   sqrt(3)/2 1/2 0   0 0 q ELINK=-2 
% ifdef tet
        SHEAR=0 0 1 {tet}
% endif
CLASS
        ATOM=C1 Z={Zc} R=avw*rwc A=.015 EREF={tbe?0:erefc}
#       IDXDN=1 1 1 2
         {strnc}
%        ifdef basc
          {basc}
%        endif
        ATOM=A1 Z={Za} R=avw*rwa A=.015 EREF={tbe?0:erefa}
#       IDXDN=1 1 1 2
         {strna}
%        ifdef basa
          {basa}
%        endif
        ATOM=EA1 Z=0 R=avw*rwea A=.015
#       IDXDN=1 1 1 2
% ifndef strnea==' '
         {strnea}
% endif
%        ifdef base
          {base}
% endif
        ATOM=EC1 Z=0 R=avw*rwec A=.015
#       IDXDN=1 1 1 2
% ifndef strnec==' '
         {strnec}
% endif
%        ifdef base
          {base}
% endif
% const conv=.00005 convc=.002 xipmxs=f
SITE    ATOM=C1  POS= 0              0   0*q
        ATOM=A1  POS= 0              0   5/8*y*q
        ATOM=C1  POS= 1/sqrt(3)      0   1/2*q
        ATOM=A1  POS= 1/sqrt(3)      0   5/8*y*q-q/2
        ATOM=EA1 POS= 1/sqrt(3)/2  -.5   5/16*y*q
        ATOM=EA1 POS= 1/sqrt(3)/2  -.5   (5/8*y+1)/2*q
        ATOM=EC1 POS= 0              0   5/16*y*q
        ATOM=EC1 POS= 1/sqrt(3)      0   (5/8*y+1)/2*q
% const bzj=0
#CONST   a={a} da={da} bzj={bzj} avw={avw} q={q} nk={nk} nk2=nk/2 nit={nit}
# % ifdef rwc
#         rwc={rwc}
# % endif
# % ifdef rwa
#         rwa={rwa}
# % endif
# % ifdef rwea
#         rwea={rwea}
# % endif
# % ifdef rwec
#         rwec={rwec}
# % endif
#         rw={ASA?1.0176:(lmf?.90:.85)} rwc=rw rwa=rw rwe=rw
#         sbig=1.14  rwea=rwe*sbig
#         small=0.68 rwec=rwe*small
#         lf1={asa?nl-1:lf1} lf2=lf1 lmxa=lf1 lmxae=lf2
# % ifdef xwz
#         xwz={xwz}
# % endif
#         xwz=0 y=1-xwz/2
#         nkgw=nk nkgw2=nkgw
% elseifd strx=='wzx'
---------------- Wurzite-like structure, but diff. cation -------
% const awz=azb/sqrt(2) q=sqrt(8/3)
% const a=awz nk=6 lfea=lf1 lfec=3
SYMGRP  R3Z MY
STRUC   NBAS=8/{les?1:2} NCLASS=8/{les?1:2} NL={nl} ALAT=a
        PLAT= 0 -1 0   sqrt(3)/2 1/2 0   0 0 q
CLASS   ATOM=C1  Z={Zc} R/W=rwc LMXB={lmxb}
        EREF={tbe?0:erefc} LMXF={lf1} A=.015
        ATOM=A1  Z={Za} R/W=rwa LMXB={lmxb} LMXF={lf1} A=.015
        EREF={tbe?0:erefa}
        ATOM=B1  Z={Zb} R/W=rwb LMXB={Zb==49|Zb==31?lbx3d:lmxb}
        EREF={tbe?0:erefb} LMXF={lf1} A=.015
        ATOM=A2  Z={Za} R/W=rwa LMXB={lmxb} LMXF={lf1} A=.015
        EREF={tbe?0:erefa}
        ATOM=EA2 Z=0    R/W=rwea LMXB={lmbe} LMXF={lfea} A=.015
        ATOM=EB1 Z=0    R/W=rwec LMXB={lmbe} LMXF={lfec} A=.015
        ATOM=EA1 Z=0    R/W=rwea LMXB={lmbe} LMXF={lfea} A=.015
        ATOM=EC1 Z=0    R/W=rwec LMXB={lmbe} LMXF={lfec} A=.015
SITE    ATOM=C1  POS= 0              0   0*q+y
        ATOM=A1  POS= 0              0   5/8*xx*q+y2
        ATOM=B1  POS= 1/sqrt(3)      0   1/2*q+y3
        ATOM=A2  POS= 1/sqrt(3)      0   5/8*xx*q-q/2-y-y2-y3
        ATOM=EC1 POS= 0              0   5/16*xx*q
        ATOM=EB1 POS= 1/sqrt(3)      0   (5/8*xx+1)/2*q-(y+y2+y3)/2
        ATOM=EA1 POS= 1/sqrt(3)/2  -.5   5/16*xx*q
        ATOM=EA2 POS= 1/sqrt(3)/2  -.5   (5/8*xx+1)/2*q
% const bzj=1
CONST   a={a} bzj={bzj}  q={q} x=0 xx=1-x/2
        nk={nk} nk2=nk/2 nit={nit}
        rw={ASA?1:(LMF?.9:.85)} rwc=rw rwb=rw rwa=rw rwe=rw
        sbig={asa?1.14:1.16} rwea=rwe*{les>=10?0:{(asa?1.0176:1)}}*sbig
        small=0.68 rwec=rwe*{les>=10?0:{(asa?1.0176:1)}}*small
        lf1={lf1} lf2=lf1 y=0 y2=0 y3=0
% cchar strn2 asa|tbe " " t 0
BZ      NKABC=nk nk nk2 BZJOB=0 0 {strn2} bzj NKABC2=nk>2?2:nk
                        BZJOB2=0 0 {strn2} bzj
        EFMAX=1 EF0={ef0} TETRA={tetra}
        NPTS=5001 DOS={ef0}-7 {ef0}+.5 DELEF=.2 METAL={metal}
% elseifd strx=='b19'
---------------- B19 structure ----------------
% const awz=azb/sqrt(2) q=sqrt(8/3)
% const a=awz nk=6 lfea=lf1 lfec=3
SYMGRP  MX R2Z:(0,0,q/2)
STRUC   NBAS=16/{les?1:2} NCLASS=8/{les?1:2}  NL={nl} ALAT=a
        PLAT= 1 0 0   0 sr3*y3 0   0 0 q
CLASS   ATOM=C1  Z={Zc} R/W=rwc LMXB={lmxb}
        EREF={tbe?0:erefc} LMXF={lf1} A=.015
        ATOM=A1  Z={Za} R/W=rwa LMXB={lmxb} LMXF={lf1} A=.015
        EREF={tbe?0:erefa}
        ATOM=B1  Z={Zb} R/W=rwb LMXB={Zb==49|Zb==31?lbx3d:lmxb}
        EREF={tbe?0:erefb} LMXF={lf1} A=.015
        ATOM=A2  Z={Za} R/W=rwa LMXB={lmxb} LMXF={lf1} A=.015
        EREF={tbe?0:erefa}
        ATOM=EA1 Z=0    R/W=rwea LMXB={lmbe} LMXF={lfea} A=.015
        ATOM=EC1 Z=0    R/W=rwec LMXB={lmbe} LMXF={lfec} A=.015
        ATOM=EA2 Z=0    R/W=rwea LMXB={lmbe} LMXF={lfea} A=.015
        ATOM=EB1 Z=0    R/W=rwec LMXB={lmbe} LMXF={lfec} A=.015
SITE    ATOM=C1  POS=  1/2  sr3*y3*y/6     0
        ATOM=C1  POS=  1/2 -sr3*y3*y/6     q/2
        ATOM=A1  POS=  1/2  sr3*y3*y/6-y4  5/8*xx*q+y6
        ATOM=A1  POS=  1/2 -sr3*y3*y/6+y4  5/8*xx*q-q/2+y6
        ATOM=B1  POS=  0   -sr3*y3*y2/3    0
        ATOM=B1  POS=  0    sr3*y3*y2/3    q/2
        ATOM=A2  POS=  0   -sr3*y3*y2/3+y5 5/8*xx*q-y6
        ATOM=A2  POS=  0    sr3*y3*y2/3-y5 5/8*xx*q-q/2-y6
        ATOM=EC1 POS=  1/2  sr3*y3*y/6     5/16*xx*q+y6/2
        ATOM=EC1 POS=  1/2 -sr3*y3*y/6     (5/8*xx+1)/2*q+y6/2
        ATOM=EA1 POS=  0    0              5/16*xx*q
        ATOM=EA1 POS=  0    0              (5/8*xx+1)/2*q
        ATOM=EB1 POS=  0   -sr3*y3*y2/3    5/16*xx*q-y6/2
        ATOM=EB1 POS=  0    sr3*y3*y2/3    (5/8*xx+1)/2*q-y6/2
        ATOM=EA2 POS= -1/2 -sr3*y3*y/2     5/16*xx*q
        ATOM=EA2 POS=  1/2  sr3*y3*y/2     (5/8*xx+1)/2*q
% const bzj=1
CONST   a={a} bzj={bzj} q={q} x=0 xx=1-x/2 sr3=sqrt(3)
        nk={nk} nk2=nk/1.7 nit={nit}
        rw={ASA?1:(LMF?.9:.85)} rwc=rw rwb=rw rwa=rw rwe=rw
        sbig={asa?1.14:1.16} rwea=rwe*{les>=10?0:{(asa?1.0176:1)}}*sbig
        small=0.68 rwec=rwe*{les>=10?0:{(asa?1.0176:1)}}*small
        lf1={lf1} lf2=lf1
        y=1 y2=1 y3=1 y4=0 y5=y4 y6=y4
% cchar strn2 asa|tbe " " t 0
BZ      NKABC=nk nk nk2 BZJOB=0 0 {strn2} bzj NKABC2=nk>2?2:nk
                        BZJOB2=0 0 {strn2} bzj
        EFMAX=1 EF0={ef0} TETRA={tetra}
        NPTS=5001 DOS={ef0}-7 {ef0}+.5 DELEF=.2 METAL={metal}
% elseifd strx=='BSnx'
---------------- BSnx structure ----------------
% const a=azb*.9 nk=6
STRUC  NBAS=4 NCLASS=3 NL={nl} NLFIT=5 ALAT=a DALAT=da
       PLAT=   1 0 0   0 1 0    0 0 cbya
SYMGRP R2Z MX R2(-1,1,0)
CLASS  ATOM=C1 Z={Zc} R/W=rw LMXB={lmxb}
       EREF={tbe?0:erefc} LMXF=lf1 A=.015
       ATOM=C2 Z={Zc} R/W=rw LMXB={lmxb} LMXF=lf1 A=.015
       EREF={tbe?0:erefc}
       ATOM=A1 Z={Za} R/W=rw LMXB={lmxb} LMXF=lf1 A=.015
       EREF={tbe?0:erefa}
       ATOM=E  Z=0    R/W=rw LMXB={lmbe} LMXF=lf2 A=.015
SITE   ATOM=C1    POS=  0    0     0
       ATOM=C2    POS=  1/2  1/2   1/2*cbya
       ATOM=A1    POS=  0/2  1/2   1/4*cbya
       ATOM=A1    POS=  1/2  0/2   3/4*cbya
       ATOM=E     POS=  0/2  1/2   3/4*cbya
       ATOM=E     POS=  1/2  0/2   1/4*cbya
% const bzj={sx?0:1}
CONST  a={a} bzj={bzj} lf1={lf1} lf2=5 rw={ASA?1:.80} nk={nk}
       cbya=3.175/5.819 nit={nit}
% elseifd strx=='BSn'
---------------- BSn structure ----------------
% const a=azb*.9 nk=6
STRUC  NBAS=4 NCLASS=1 NL={nl} NLFIT=5 ALAT=a DALAT=da
       PLAT=   1 0 0   0 1 0    0 0 cbya
SYMGRP R2X:(0,.5,cbya/4) R2Y:(0,.5,cbya/4) R2(-1,1,0)
CLASS  ATOM=C1 Z={Zc} R/W=rw LMXB={lmxb}
       EREF={tbe?0:erefc} LMXF=lf1 A=.015
SITE   ATOM=C1    POS=  0    0     0
       ATOM=C1    POS=  0/2  1/2   1/4*cbya
       ATOM=C1    POS=  1/2  0/2   3/4*cbya
       ATOM=C1    POS=  1/2  1/2   1/2*cbya
% const bzj={sx?0:1}
CONST  a={a} bzj={bzj} lf1={lf1} lf2=5 rw={ASA?1:.81} nk={nk}
       cbya=3.175/5.819 nit={nit}
% elseifd strx=='C1' | strx=='aC1'
---------------- Calcium Flourite (C1) structure Fm3m (#225), and antiflourite ------
% const nk=6 avw=(3*a^3/64/pi)^(1/3)
SYMGRP  find
STRUC   NBAS=3+{les?1:0} NCLASS=2+{les?1:0} NL={nl}
        ALAT=a DALAT=da PLAT= 0 .5 .5    .5 0 .5    .5 .5 0
% ifdef tet
        SHEAR=0 0 1 {tet}
% endif
% ifdef strx=='C1' 
SITE    MODE=t
        ATOM=C1  POS=  0       0       0
        ATOM=A1  POS= .25     .25     .25
        ATOM=A1  POS= .75     .75     .75
        ATOM=EA1 POS= .50     .50     .50
% else
SITE    MODE=t
        ATOM=A1  POS=  0       0       0
        ATOM=C1  POS= .25     .25     .25
        ATOM=C1  POS= .75     .75     .75
        ATOM=EA1 POS= .50     .50     .50
% endif
CLASS
        ATOM=C1 Z={Zc} R=avw*rwc A=.015 EREF={tbe?0:erefc}
#       IDXDN=1 1 1 2
         {strnc}
%        ifdef basc
          {basc}
%        endif
        ATOM=A1 Z={Za} R=avw*rwa A=.015 EREF={tbe?0:erefa}
#       IDXDN=1 1 1 2
         {strna}
%        ifdef basa
          {basa}
%        endif
        ATOM=EA1 Z=0 R=avw*rwea A=.015
#       IDXDN=1 1 1 2
% ifndef strnea==' '
         {strnea}
% endif
%        ifdef base
          {base}
% endif
% const bzj=1
CONST   a={a} da={da} bzj={bzj} avw={avw} q={q} nk={nk} nk2=nk nit={nit}
        alatj=a
% ifdef rw
        rw={rw}
% endif
% ifdef rwc
        rwc={rwc}
% endif
% ifdef rwa
        rwa={rwa}
% endif
% ifdef les>=10
        rwec=0 rwea=0
% endif
% ifdef rwea
        rwea={rwea}
% endif
        rw={ASA?1:(LMF?.9:.85)} rwc=rw rwb=rw rwa=rw rwec=rw rwea=rw nk={nk} nk2=nk nkgw=4 nkgw2=nkgw
        lf1={asa?nl-1:lf1} lf2=lf1 lmxa=lf1 lmxae=lf2
        nkgw=nk nkgw2=nkgw
% elseifd strx=='C1b' | strx=='L21'
---------------- C1_b (half Heusler) and L2_1 (full Heusler) structures ----------------
% const nk=6 avw=(3*a^3/64/pi)^(1/3)
SYMGRP  find
STRUC 
% ifdef strx=='C1b' 
        NBAS=3+{les?1:0} NSPEC=3+{les?1:0} NL={nl}
% else
        NBAS=4 NSPEC=3 NL={nl}
% endif
        ALAT=a DALAT=da PLAT= 0 .5 .5    .5 0 .5    .5 .5 0
% ifdef tet
        SHEAR=0 0 1 {tet}
% endif
% ifdef strx=='C1b' 
SITE    ATOM=C1  POS=  0       0       0    
        ATOM=A1  POS= .25     .25     .25
        ATOM=B1  POS= .75     .75     .75
        ATOM=EA1 POS= .50     .50     .50
% else
SITE    ATOM=C1  POS=  0       0       0    
        ATOM=C1  POS= .50     .50     .50
        ATOM=A1  POS= .75     .75     .75
        ATOM=B1  POS= .25     .25     .25
% endif
CLASS
        ATOM=C1 Z={Zc} R=avw*rwc A=.015 EREF={tbe?0:erefc}
#       IDXDN=1 1 1 2
         {strnc}
%        ifdef basc
          {basc}
%        endif
        ATOM=B1 Z={Zb} R=avw*rwb A=.015 EREF={tbe?0:erefb}
#       IDXDN=1 1 1 2
         {strnb}
%        ifdef basb
          {basb}
%        endif
        ATOM=A1 Z={Za} R=avw*rwa A=.015 EREF={tbe?0:erefa}
#       IDXDN=1 1 1 2
         {strna}
%        ifdef basa
          {basa}
%        endif
        ATOM=EA1 Z=0 R=avw*rwea A=.015
#       IDXDN=1 1 1 2
% ifndef strnea==' '
         {strnea}
% endif
%        ifdef base
          {base}
% endif

CONST   a={a} da={da} bzj={bzj} avw={avw} q={q} nk={nk} nk2=nk nit={nit}
        alatj=a
% ifdef rw
        rw={rw}
% endif
% ifdef rwc
        rwc={rwc}
% endif
% ifdef rwa
        rwa={rwa}
% endif
% ifdef les>=10
        rwec=0 rwea=0
% endif
% ifdef rwea
        rwea={rwea}
% endif
        rw={ASA?1:(LMF?.9:.85)} rwc=rw rwb=rwc rwa=rw rwec=rw rweb=rwec rwea=rw nk={nk} nk2=nk nkgw=4 nkgw2=nkgw
        lf1={asa?nl-1:lf1} lf2=lf1 lmxa=lf1 lmxae=lf2
        nkgw=nk nkgw2=nkgw
% elseifd strx=='chalcopyrite'
# Lattice from Lambrecht Phys. Rev. B 69, 035201 (2004).  He transposed u and 1/4
# Required data (in semi.mater) is a,q,u
% const nk=4 avw=(3*a^3*q/128/pi)^(1/3)
SYMGRP  find
STRUC   NBAS=8+{les?8:0} NSPEC=3+{les?2:0} NL={nl} DALAT={da}
        ALAT={a} PLAT= 1/2 1/2 -{q}/2  1/2  -1/2 {q}/2  -1/2 1/2 {q}/2
% ifdef tet
        SHEAR=0 0 1 {tet}
% endif
%ifdef file
        FILE=site
SITE 
        FILE=site
% endif
SITE 
   ATOM=C1 POS= 0    0    0
   ATOM=C1 POS= 1/2  0    1/4*{q}
   ATOM=B1 POS= 1/2  1/2  0
   ATOM=B1 POS= 0    1/2  1/4*{q}
   ATOM=A1 POS= 1/4  {u}  1/8*{q}
   ATOM=A1 POS=-1/4 -{u}  1/8*{q}
   ATOM=A1 POS=-{u}  1/4 -1/8*{q}
   ATOM=A1 POS= {u} -1/4 -1/8*{q}

   ATOM=EC1 POS= 0    1/2  0
   ATOM=EC1 POS= 1/2  0    0
   ATOM=EC1 POS= 0    0    1/4*{q} 
   ATOM=EC1 POS= 1/2  1/2  1/4*{q}
   ATOM=EA1 POS= 1/4 -1/4  1/8*{q}
   ATOM=EA1 POS=-1/4  1/4  1/8*{q}
   ATOM=EA1 POS= 1/4  1/4 -1/8*{q}
   ATOM=EA1 POS=-1/4 -1/4 -1/8*{q}

% elseifd strx=='tetradymite'
---------------- tetradymite structure R-3m (No 166) ------
# Required data (in semi.mater) is a,q,zTe,ZBi  and rwc,rwb,rwa (rwea,rwec)
% const nk=4 avw=1
SYMGRP  find
STRUC   NBAS=5+{les?5:0} NSPEC=3+{les?1:0} NL={nl}
  ALAT={a} DALAT=da PLAT=1 0 {q}  -0.5 sqrt(3)/2 {q}  -0.5 -sqrt(3)/2 {q}
SITE
  ATOM=B1  POS=  0.0000000   0.0000000   0.00000
  ATOM=C1  POS= -0.5000000  -0.8660254   {zTe*q}
  ATOM=C1  POS=  0.5000000   0.8660254  -{zTe*q}
  ATOM=A1  POS=  0.5000000   0.8660254   {zBi*q}
  ATOM=A1  POS= -0.5000000  -0.8660254  -{zBi*q}

  ATOM=EA1 POS=  0.00000  0.00000  {1.5*q}
  ATOM=EA1 POS=  0.00000  0.00000  {.90*q}
  ATOM=EA1 POS=  0.00000  0.00000 -{.90*q}
  ATOM=EA1 POS=  0.00000  0.00000  {.29*q}
  ATOM=EA1 POS=  0.00000  0.00000 -{.29*q}
% elseifd strx=='delafossite'
---------------- Delafossite? structure R-3m (No 166) ------
# Required data (in semi.mater) is a,q,zo  and rwc,rwb,rwa (rwea,rwec)
# This data is for CuAlO2
% const a=2.8604/sqrt(3)/.52918 c=16.953/.52918 q=c/a/3 zo=.10979 
% const nk=4 avw=1
SYMGRP  find
STRUC   NBAS=4+{les?{(les%10)==2?4:2}:0} NSPEC=3+{les?{(les%10)==2?2:1}:0} NL={nl}
        ALAT={a}  PLAT= 1  0  {q}  -0.5 {sqrt(3/4)} {q}  -0.5 -{sqrt(3/4)} {q}
#       ROT=(0,0,1)pi/12,(1,-1,0)acos(1/sqrt(3))
SITE 
       ATOM=C1         POS=  0   0   0
       ATOM=B1         POS=  0   0  -{3*q/2}
       ATOM=A1         POS=  0   0   {3*zo*q}
       ATOM=A1         POS=  0   0  -{3*zo*q}

       ATOM=EA1  POS=  0.00000  0.00000  2.76688
       ATOM=EA1  POS=  0.00000  0.00000 -2.76688
       ATOM=EC1  POS=  0.00000  0.00000  3.80385
       ATOM=EC1  POS=  0.00000  0.00000 -3.80385
% elseifd strx=='cuprite'
---------------- Cuprite structure Pn-3m (#224) ----------------
% const nk=6 avw=a/pi^(1/3)/2
SYMGRP  find
STRUC   NBAS=6+{les?{(les%10)==2?10:4}:0} NCLASS=2+{les?{(les%10)==2?2:1}:0} NL={nl}
        ALAT=a DALAT=da PLAT=1 0 0   0 1 0   0 0 1
% ifdef tet
        SHEAR=0 0 1 {tet}
% endif
SITE                   
        ATOM=C1   POS=  0.00    0.00    0.00
        ATOM=C1   POS=  0.00    0.50    0.50
        ATOM=C1   POS=  0.50    0.00    0.50
        ATOM=C1   POS=  0.50    0.50    0.00
        ATOM=A1   POS=  0.25    0.25    0.25
        ATOM=A1   POS= -0.25   -0.25   -0.25
        ATOM=EA1  POS=  0.50    0.00    0.00
        ATOM=EA1  POS=  0.00    0.50    0.00
        ATOM=EA1  POS=  0.00    0.00    0.50
        ATOM=EA1  POS=  0.50    0.50    0.50
        ATOM=EC1  POS=  0.25    0.25   -0.25
        ATOM=EC1  POS=  0.25   -0.25    0.25
        ATOM=EC1  POS=  0.25   -0.25   -0.25
        ATOM=EC1  POS= -0.25    0.25    0.25
        ATOM=EC1  POS= -0.25    0.25   -0.25
        ATOM=EC1  POS= -0.25   -0.25    0.25
SPEC
        ATOM=C1 Z={Zc} R/A=rwc A=.015 EREF={tbe?0:erefc}
         {strnc}
%        ifdef basc
          {basc}
%        endif
        ATOM=A1 Z={Za} R/A=rwa A=.015 EREF={tbe?0:erefa}
         {strna}
%        ifdef basa
          {basa}
%        endif
        ATOM=EA1 Z=0 R/A=rwea A=.015
% ifndef strnea==' '
         {strnea}
% endif
%        ifdef base
          {base}
% endif
        ATOM=EC1 Z=0 R/A=rwec A=.015
% ifndef strnec==' '
         {strnec}
%        ifdef base
          {base}
%        endif
% endif
% elseifd strx=='DO22'
---------------- DO22 structure ----------------
% const a=azb*.9 nk=6
BZ     NKABC=nk nk nk BZJOB=0 0 0 1 NKABC2=1 BZJOB2=0 0 0 1
       TETRA={metal} METAL={metal} DOS=-1.5 0.5 EF0={ef0} DELEF=.1
SYMGRP R2X R2Y M(-1,1,0)
CLASS  ATOM=C1 Z={Zc} R/W=rw/xx LMXB={lmxb}
       EREF={tbe?0:erefc} LMXF=lf1 A=.015
       ATOM=C2 Z={Zc} R/W=rw/xx LMXB={lmxb}
       EREF={tbe?0:erefc} LMXF=lf1 A=.015
       ATOM=B1 Z={Zb} R/W=rw*xx LMXB={Zb==49|Zb==31?lbx3d:lmxb}
       EREF={tbe?0:erefb} LMXF=lf1 A=.015
       ATOM=A1 Z={Za} R/W=rw LMXB={lmxb} LMXF=lf1 A=.015
       EREF={tbe?0:erefa}
       ATOM=EA1 Z=0   R/W=rw/xx LMXB={lmbe} LMXF=lf2 A=.015
       ATOM=EA2 Z=0   R/W=rw*xx LMXB={lmbe} LMXF=lf2 A=.015
       ATOM=EC1 Z=0   R/W=rw LMXB={lmbe} LMXF=lf2 A=.015
STRUC  NBAS=16 NCLASS=7 NL={nl} NLFIT=5 ALAT=a DALAT=da
       PLAT=   1 0 0   0 1 0    .5 .5 1
SITE   ATOM=C1    POS=  .00   .00   .00
       ATOM=A1    POS=  .25   .25   .25+y
       ATOM=B1    POS=  .50   .00   .50
       ATOM=A1    POS=  .25  -.25  -.25-y
       ATOM=B1    POS=  .50   .00  -.50
       ATOM=A1    POS= -.25   .25  -.25-y
       ATOM=C2    POS=  .50   .50   .00
       ATOM=A1    POS= -.25  -.25   .25+y
       ATOM=EA1   POS=  .50   .00   .00
       ATOM=EC1   POS=  .25   .25  -.25-y*0
       ATOM=EA2   POS=  .00   .00   .50
       ATOM=EC1   POS= -.25   .25   .25+y*0
       ATOM=EA2   POS=  .00   .00  -.50
       ATOM=EC1   POS=  .25  -.25   .25-y*0
       ATOM=EA1   POS=  .00   .50   .00
       ATOM=EC1   POS= -.25  -.25  -.25+y*0
% elseifd strx=='CsCl-A3B'
---------------- CsCl-A3B structure ----------------
% const a=azb/4^(1/3) nk=6
SYMGRP  R3D I
STRUC   NBAS=8 NCLASS=4 NL={nl} ALAT=a
        PLAT=1 1 -1   1 -1 1   -1 1 1
SITE    ATOM=C1 POS=  1   0   0
        ATOM=C1 POS=  0   1   0
        ATOM=C1 POS=  0   0   1
        ATOM=B1 POS=  0   0   0
        ATOM=A1 POS=  1+1/2   0+1/2   0+1/2
        ATOM=A1 POS=  0+1/2   1+1/2   0+1/2
        ATOM=A1 POS=  0+1/2   0+1/2   1+1/2
        ATOM=A2 POS=  0+1/2   0+1/2   0+1/2
CLASS   ATOM=C1 Z={Zc}  R/W=rw LMXB={lmxb}
        EREF={tbe?0:erefc} LMXF=lf1 A=.015
        ATOM=B1 Z={Zb}  R/W=rw LMXB={Zb==49|Zb==31?lbx3d:lmxb}
        EREF={tbe?0:erefb} LMXF=lf1 A=.015
        ATOM=A1 Z={Za}  R/W=rw LMXB={lmxb} LMXF=lf1 A=.015
        EREF={tbe?0:erefa}
        ATOM=A2 Z={Za}  R/W=rw LMXB={lmxb} LMXF=lf1 A=.015
        EREF={tbe?0:erefa}
% elseifd strx=='CsCl-AB3'
SYMGRP  R3D I
STRUC   NBAS=8 NCLASS=4 NL={nl} ALAT=a
        PLAT=1 1 -1   1 -1 1   -1 1 1
SITE    ATOM=B1 POS=  1   0   0
        ATOM=B1 POS=  0   1   0
        ATOM=B1 POS=  0   0   1
        ATOM=C1 POS=  0   0   0
        ATOM=A1 POS=  1+1/2   0+1/2   0+1/2
        ATOM=A1 POS=  0+1/2   1+1/2   0+1/2
        ATOM=A1 POS=  0+1/2   0+1/2   1+1/2
        ATOM=A2 POS=  0+1/2   0+1/2   0+1/2
CLASS   ATOM=C1 Z={Zc}  R/W=rw LMXB={lmxb}
        EREF={tbe?0:erefc} LMXF=lf1 A=.015
        ATOM=B1 Z={Zb}  R/W=rw LMXB={Zb==49|Zb==31?lbx3d:lmxb}
        EREF={tbe?0:erefb} LMXF=lf1 A=.015
        ATOM=A1 Z={Za}  R/W=rw LMXB={lmxb} LMXF=lf1 A=.015
        EREF={tbe?0:erefa}
        ATOM=A2 Z={Za}  R/W=rw LMXB={lmxb} LMXF=lf1 A=.015
        EREF={tbe?0:erefa}
% elseifd strx=='CsCl'
---------------- CsCl structure ----------------
% const a=azb/4^(1/3) nk=6
SYMGRP  R4Z*I MX*I R3D
STRUC   NBAS=2 NCLASS=2 NL={nl} ALAT=a
        PLAT= 1 0 0   0 1 0   0 0 1
SITE    ATOM=C1 POS=  0   0   0
        ATOM=A1 POS= 1/2 1/2  1/2
CLASS   ATOM=C1 Z={Zc}  R/W=rw LMXB={lmxb}
        EREF={tbe?0:erefc} LMXF=lf1 A=.015
        ATOM=A1 Z={Za}  R/W=rw LMXB={lmxb} LMXF=lf1 A=.015
        EREF={tbe?0:erefa}
% elseifd strx=='NaCl'
---------------- NaCl structure ----------------
# set file=t for AFII structure, or some superlattice of NaCl
% const nk=6 avw=(3*a^3/64/pi)^(1/3)
% ifdef bmod
SYMGRP  find
SYMGRP  R4Z*I MX*I R3D find
% elseifd tet
SYMGRP  R4Z*I MX*I find
% elseifd trig
SYMGRP  R3D M(1,-1,0) find
% endif
STRUC 
%ifdef file
    NCLASS={les?5:3}
    FILE=site
%endif
    NBAS={les?4:2} NCLASS={les?4:2} NL={nl} ALAT=a
        ALAT=a DALAT=da PLAT= 0 .5 .5  .5 0 .5  .5 .5 0
% ifdef tet
        SHEAR=0 0 1 {tet}
% elseifd trig
        SHEAR=1 1 1 {trig}
% endif
%ifdef file
SITE    FILE=site
%endif
SITE    ATOM=C1  POS=  0   0    0
        ATOM=A1  POS= 1/2  1/2  1/2
        ATOM=EA1 POS=-1/4  1/4  1/4
        ATOM=EC1 POS= 1/4  1/4  1/4
% elseifd strx=='NiAs'
---------------- NiAs structure ----------------
% const awz=azb/sqrt(2)
% const a=awz nk=6 lfea=lf1 lfec=3 avw=(4*(awz*sqrt(2))^3*q/sqrt(8/3)/64/pi)^(1/3)
#SYMGRP  R4Z*I MX*I R3D
STRUC   NBAS={les?6:4} NCLASS={les?3:2} NL={nl} ALAT=a
        ALAT={a} DALAT=da PLAT= 0.75^0.5  -0.5  0  0  1  0  0  0  {q}
SITE    ATOM=C1  POS=  0.000000   0.0   0.0
        ATOM=C1  POS=  0.000000   0.0   {q}/2
        ATOM=A1  POS=  1/12^0.5  -1/2   {q}/4
        ATOM=A1  POS= -1/12^0.5   1/2  -{q}/4
        ATOM=EA1 POS= -1/12^0.5   1/2   {q}/4
        ATOM=EA1 POS=  1/12^0.5  -1/2  -{q}/4
% elseifd strx=='CuAu'
---------------- CuAu structure ----------------
% const a=azb nk=6
SYMGRP  R2Z M(1,1,0)
STRUC   NBAS=8/{les?1:2} NCLASS=8/{les?1:2} NL={nl} ALAT=a
        PLAT= .5 .5 0   0 0 1   .5 -.5 0
SITE    ATOM=C1  POS=  0.00 .00 .00
        ATOM=A1  POS=  0.25 .25 .25+y
        ATOM=B1  POS=  0.50 .00 .50
        ATOM=A2  POS=  0.75 .25 .75-y
        ATOM=EA1 POS=  0.50 .50 .50
        ATOM=EC1 POS=  0.75 .75 .75-y
        ATOM=EA2 POS=  1.00 .50 .00
        ATOM=EB1 POS=  1.25 .75 .25+y
CLASS   ATOM=C1 Z={Zc} R/W=rwc A=.015 EREF={tbe?0:erefc} LMXA=lmxa
             {strnc}
        ATOM=B1 Z={Zb} R/W=rwb A=.015 EREF={tbe?0:erefb} LMXA=lmxa
             {strnb}
% repeat i=1:2
        ATOM=A{i} Z={Za} R/W=rwa A=.015 EREF={tbe?0:erefa} LMXA=lmxa
             {strna}
% end
% repeat i=1:2
        ATOM=EA{i} Z=0 R/W=rwea LMX={lmbe} LMXA=lmxae A=.015
% ifndef strnea==' '
             {strnea}
% endif
        ATOM=EC{i} Z=0 R/W=rwec LMX={lmbe} LMXA=lmxae A=.015
% ifndef strnec==' '
             {strnec}
% endif
% end
% const bzj=0
CONST   a={a} bzj={bzj} lf1={lf1} lf2=lf1 lmxa=lf1 lmxae=lf2
        rw={ASA?1:(LMF?.9:.85)} rwc=rw rwb=rw rwa=(rwc+rwb)/2 rwe=rwa nk={nk}
        nit={nit} y=0
# ---------------- SQS4 structure ----------------
% elseifd strx=='SQS4'
% const a=azb ncell=1 nk=6 avw=(3*a^3/64/pi)^(1/3)
SYMGRP  M(-1,1,0)
STRUC   NBAS={les?16:8} NSPEC={les?6:3} NL={nl} ALAT=a
        PLAT= -.5 .5 0   0 0 1    1 1 0
SITE    ATOM=C1  POS= -1/8    -1/8    0/8
        ATOM=C1  POS= -1/8     3/8    4/8
        ATOM=B1  POS=  3/8     3/8    0/8
        ATOM=B1  POS= -5/8    -1/8    4/8
        ATOM=A1  POS=  1/8     1/8    2/8
        ATOM=A1  POS= -3/8     1/8    6/8
        ATOM=A1  POS= -3/8    -3/8    2/8
        ATOM=A1  POS=  1/8     5/8    6/8
        ATOM=EC1 POS= -1/8-1/4 -1/8-1/4 0/8-1/4
        ATOM=EC1 POS= -1/8-1/4  3/8-1/4 4/8-1/4
        ATOM=EB1 POS=  3/8-1/4  3/8-1/4 0/8-1/4
        ATOM=EB1 POS= -5/8-1/4 -1/8-1/4 4/8-1/4
        ATOM=EA1 POS=  1/8+1/4      1/8+1/4     2/8+1/4
        ATOM=EA1 POS= -3/8+1/4      1/8+1/4     6/8+1/4
        ATOM=EA1 POS= -3/8+1/4     -3/8+1/4     2/8+1/4
        ATOM=EA1 POS=  1/8+1/4      5/8+1/4     6/8+1/4
MIX     MODE=A2,b=.5,bv=.5,k=3,n=3;B2,b=.5,bv=.5,k=3
        AMIX=T BETA=.5 BETSW=F CONV=.00001 CONVC=.001 
# ---------------- SQS8 structure ----------------
% elseifd strx=='SQS8'
% const a=azb nk=4 avw=(3*a^3/64/pi)^(1/3)
SYMGRP  M(-1,1,0)
STRUC   NBAS=32/{les?1:2} NCLASS=32/{les?1:2} NL={nl} ALAT=a
        PLAT= 1 1/2 -1/2    1/2 -1/2 0   1 1 2
SITE    ATOM=C1  POS=0       0       0
        ATOM=C2  POS=1/2     1/2     0
        ATOM=C3  POS=1/2     0       3/2
        ATOM=C4  POS=0       0       2
        ATOM=B1  POS=1/2     0       1/2
        ATOM=B2  POS=0       0       1
        ATOM=B3  POS=1/2     1/2     1
        ATOM=B4  POS=1/2     1/2     2
        ATOM=A1  POS=1/4     1/4     1/4
        ATOM=A2  POS=3/4     3/4     1/4
        ATOM=A3  POS=3/4     1/4     3/4
        ATOM=A4  POS=1/4     1/4     5/4
        ATOM=A5  POS=3/4     3/4     5/4
        ATOM=A6  POS=3/4     1/4     7/4
        ATOM=A7  POS=1/4     1/4     9/4
        ATOM=A8  POS=3/4     3/4     9/4

        ATOM=EC1 POS=0-1/4   0-1/4   0-1/4
        ATOM=EC2 POS=1/2-1/4 1/2-1/4 0-1/4
        ATOM=EC3 POS=1/2-1/4 0-1/4   3/2-1/4
        ATOM=EC4 POS=0-1/4   0-1/4   2-1/4
        ATOM=EC5 POS=1/2-1/4 0-1/4   1/2-1/4
        ATOM=EC6 POS=0-1/4   0-1/4   1-1/4
        ATOM=EC7 POS=1/2-1/4 1/2-1/4 1-1/4
        ATOM=EC8 POS=1/2-1/4 1/2-1/4 2-1/4
        ATOM=EA1 POS=1/4+1/4 1/4+1/4 1/4+1/4
        ATOM=EA2 POS=3/4+1/4 3/4+1/4 1/4+1/4
        ATOM=EA3 POS=3/4+1/4 1/4+1/4 3/4+1/4
        ATOM=EA4 POS=1/4+1/4 1/4+1/4 5/4+1/4
        ATOM=EA5 POS=3/4+1/4 3/4+1/4 5/4+1/4
        ATOM=EA6 POS=3/4+1/4 1/4+1/4 7/4+1/4
        ATOM=EA7 POS=1/4+1/4 1/4+1/4 9/4+1/4
        ATOM=EA8 POS=3/4+1/4 3/4+1/4 9/4+1/4
SPEC
% repeat j=1:4
        ATOM=C{j} Z={Zc} R/W=rwc A=.015 EREF={tbe?0:erefc} LMXA=lmxa
             {strnc}
        ATOM=B{j} Z={Zb} R/W=rwb A=.015 EREF={tbe?0:erefb} LMXA=lmxa
             {strnb}
% end
% repeat j=1:8
        ATOM=A{j} Z={Za} R/W=rwa A=.015 EREF={tbe?0:erefa} LMXA=lmxa
             {strna}
% end
% repeat j=1:8
        ATOM=EC{j} Z=0 R/W=rwec LMX={lmbe} LMXA=lmxae A=.015
% ifndef strnec==' '
             {strnec}
% endif
        ATOM=EA{j} Z=0 R/W=rwea LMX={lmbe} LMXA=lmxae A=.015
% ifndef strnea==' '
             {strnea}
% endif
% end
% const bzj=0
CONST   a={a} bzj={bzj} lf1={lf1} lf2=lf1 lmxa=lf1 lmxae=lf2
        rw={ASA?1:(LMF?.9:.85)} rwe=rw nk={nk}
        nit={nit}
% endif
---------------- Default categories ----------------
% const ncell=1
SPEC
#       SCLWSR=T 
%iffile specialspec
%  echo including file specialspec in SPEC category
%  include specialspec
%endif
%repeat i= 1:ncell
        ATOM=C{i} Z={Zc} R=avw*rwc A=.015 EREF={tbe?0:erefc}
%iffile specialspecc
%  echo including file specialspecc in SPEC category
%  include specialspecc
%endif
         {strnc}
%        ifdef basc
          {basc}
%        endif
%ifdef nelt==3 & strnb
        ATOM=B{i} Z={Zb} R=avw*rwb A=.015 EREF={tbe?0:erefb}
%iffile specialspecb
%  echo including file specialspecb in SPEC category
%  include specialspecb
%endif
         {strnb}
%        ifdef basb
          {basb}
%        endif
%endif
# special to col IV: comment out this species
        ATOM=A{i} Z={Za} R=avw*rwa A=.015 EREF={tbe?0:erefa}
%iffile specialspeca
%  echo including file specialspeca in SPEC category
%  include specialspeca
%endif
         {strna}
%        ifdef basa
          {basa}
%        endif
% end
% repeat i=1:ncell
# special to col IV: comment out this species
        ATOM=EA{i} Z=0 R=avw*rwea A=.015
% iffile specialspecea
%   echo including file specialspecea in SPEC category
%   include specialspecea
% endif
% ifndef strnea==' '
         {strnea}
%        ifdef base
          {base}
% endif
% endif
        ATOM=EC{i} Z=0 R=avw*rwec A=.015
% iffile specialspecec
%   echo including file specialspecec in SPEC category
%   include specialspecec
% endif
% ifndef strnec==' '
         {strnec}
%        ifdef base
          {base}
%        endif
% endif
%ifdef strneb
        ATOM=EB{i} Z=0 R=avw*rweb A=.015
% ifndef strneb==' '
         {strneb}
%        ifdef base
          {base}
%        endif
% endif
% endif
% end
% const conv=.00005 convc=.002 beta=.7 xipmxs=f
# uncomment the following for large very basis sets causing difficulty in convergence
# MIX     MODE=A0,b={beta},bv=.5,k=3,n=3;B2,b=.5,bv=.5,k=3 CONV={conv} CONVC={convc}
MIX     MODE={?~lmf~A~B}3,b={beta},k=5 AMIX=T BETA=.5 BETSW=F CONV={conv} CONVC={convc}
        XIPMX={xipmxs} BETXV=.4 NMIX=1 ELIND=-.7 UMIX=1
BZ      NKABC=nk nk nk2 BZJOB=bzj NKABC2=2 BZJOB2=bzj EF0={ef0} DELEF=.1 EFMAX={ef0+1}
% ifdef ofp
        DOS=-7 0.5 NPTS=6001
% endif
#       NEVMX=999 EMAX=99 SAVDOS=T DOS=-2 1 NPTS=2001 
        TETRA={metal} METAL={metal} SAVDOS=F DOS=-1 {lmf?2:0.5} NPTS=1001 INVIT=f PUTQP=f
% ifdef hf
        NEVMX=-1
% endif
#       FSMOM=0.0001
# % const ef=0
#       EMESH=30 10 {ef-1.1} {ef} 0.6 0.0
%ifdef relax
DYN     MSTAT: 5,t,.000,0.005,.005,0 NIT={relax}
DYN     MSTAT: 5,t,.000,0.002,.005,0 NIT={relax}
DYN     MSTAT: 6,t,.000,0.005,.005,0 NIT={relax}
%endif
STR     RMAX=3.5
% const bzj={sx?0:1}
CONST   a={a} bzj={bzj} avw={avw} 
% ifdef lmxa
        lmxa={lmxa}
% endif
% ifdef lmxae
        lmxae={lmxae}
% endif
% ifdef rw
        rw={rw}
% endif
% ifdef rwc
        rwc={rwc}
% endif
% ifdef rwb
        rwb={rwb}
% endif
% ifdef rwa
        rwa={rwa}
% endif
% ifdef les>=10
        rwec=0 rweb=0 rwea=0
% endif
% ifdef rwec
        rwec={rwec}
% endif
% ifdef rwea
        rwea={rwea}
% endif
% ifdef kl0&trig
        kl=(1-{trig})/6*kl0
% endif
% ifdef nk2
        nk2={nk2}
% endif
% ifdef strx=='WZ'
        q={q} nk={nk} nk2=nk/2
        rw={ASA?1.0176:(lmf?.90:.85)} rwc=rw rwa=rw rwe=rw
        sbig=1.14  rwea=rwe*sbig
        small=0.68 rwec=rwe*small
        lf1={asa?nl-1:lf1} lf2=lf1 lmxa=lf1 lmxae=lf2
% ifdef xwz
        xwz={xwz}
% endif
        xwz=0 y=1-xwz/2
% endif
        lf1={asa?nl-1:lf1} lf2=lf1 lmxa=lf1 lmxae=lf2
        rw={ASA?1:(LMF?.9:.85)} rwc=rw rwb=rwc rwa=rw rwec=rw rweb=rwec rwea=rw 
        nk={nk} nk2=nk nkgw=4 nkgw2=nkgw
        da={da} xx=1 y=0 wto=0 kl=0 nit={nit}
EWALD   AS=2.0 TOL=1D-10 ALAT0=a NKRMX=400 NKDMX=400
% const gamma=sx ccor=~twoc adnf=~(sx|twoc) nsp=1
OPTIONS NSPIN={so?2:nsp} REL=t INVIT=f HF={hf}
% ifdef asa
        CCOR={ccor} ADNF={adnf} TWOC={twoc} T GAMMA={gamma} SCR={scr}
% elseif ofp
        LINK={link} XCN={xcn} LMH={lmh} NPAN={tpan+1}
% endif
% ifdef so
        NONCOL=t SO={so}
% endif
% ifdef sx
% ifdef sxopts
% else
%   char sxopts
% endif
        SX={sx} SXOPTS={sxopts}
% endif
IO      SHOW=f HELP=f VERBOS=41 20 WKP=F IACTIV=t
% const nmto=0 ngd=16
HAM     NMTO={nmto} KMTO=-.4 .1 .6 1.1 EWALD=T
%iffile specialh
%echo including file specialh in HAM category
%include specialh
%endif
%ifdef gmax
        GMAX={gmax}
%endif
        FORCES={so<>1&hf==0} ELIND={elind} FTMESH={ngd} XCFUN={xcf} GGA={gga} TOL=1d-6 QASA=3
# the following line for GW
% const sig=12 modsgp=3 nmins=0 emins=0 nmaxs=0 emaxs=2.5 asig=0.0 bsig=0.09 efits=0
        RDSIG={sig} SIGP:{modsgp},{nmins},{emins},{nmaxs},{emaxs},{asig},{bsig},{efits}
#       RSRNGE=8
% const modsig=3 ecuts=2 pwb=2.7 pwc=2.2
GW      NKABC=nkgw nkgw nkgw2 GCUTB={pwb} GCUTX={pwc} MKSIG={modsig} ECUTS={ecuts}
GF      MODE=1 GFOPTS=pdos;emom#;p3
VERS    LMFP-5.0 LMASA-6 TB-6 LMF-6 FTB-6
---------------- START ----------------
.START   CNTROL=f BEGMOM=f
START   CNTROL={nit<=0} BEGMOM={nit<=0} CNVG=1d-5 NIT={abs(nit)}
# %ifdef {so|nsp==2}
# %exit
# %endif
%iffile qasa
%include qasa
%exit
%endif
%ifdef ofp
% char strn "5.08 6.06 7.05 8.05 9.04"
% char zero "0 0 0 0 0 0 0 0 0 0 0 0 0 0 0"
%cvar asa tpsc=1 tppc=1 tpdc=1 tpsb=1 tppb=1 tpdb=1 tpsa=1 tppa=1 tpda=1
% repeat i= 1:ncell
# Makes pqn for s,p,d, given atomic number
% var pnus=1 pnup=1 pnud=0
% repeat j=2,10,18,36,54,86
% cvar zc>j pnus+=1 pnup+=1 pnud+=1
% cvar zc>=32&j>=zc&zc>=j-4 pnud+=1
% end
% var pnup=pnup<2?2:pnup pnud=pnud<3?3:pnud
% var pnus += tpsc==4?1.3:.5
% var pnup += tppc==4?1.3:.5
% var pnud += tpdc==4?1.3:.8
  ATOM=C{i} P={pnus} {pnup} {pnud} 0.11 {strn}
  Q=2 0 0 {qc} 0 0 {zc>=29?10:0} 0 0 0 0 0 {zero}
  TPAN={tpsc<2?1:2} {tppc<2?1:2} {tpdc<2?1:tpdc} 1
% ifdef Zb
# Makes pqn for s,p,d, given atomic number
% var pnus=1 pnup=1 pnud=0
% repeat j=2,10,18,36,54,86
% cvar zb>j pnus+=1 pnup+=1 pnud+=1
% cvar zb>=32&j>=zb&zb>=j-4 pnud+=1
% end
% var pnup=pnup<2?2:pnup pnud=pnud<3?3:pnud
% var pnus += tpsb==4?1.3:.5
% var pnup += tppb==4?1.3:.5
% var pnud += tpdb==4?1.3:.8
  ATOM=B{i} P={pnus} {pnup} {pnud} 0.11 {strn}
  Q=2 0 0 {qb} 0 0 {zb>=29?10:0} 0 0 0 0 0 {zero}
  TPAN={tpsb<2?1:2} {tppb<2?1:2} {tpdb<2?1:tpdb} 1
% endif
# Makes pqn for s,p,d, given atomic number
% var pnus=1 pnup=1 pnud=0
% repeat j=2,10,18,36,54,86
% cvar za>j pnus+=1 pnup+=1 pnud+=1
% cvar za>=32&j>=za&za>=j-4 pnud+=1
% end
% var pnup=pnup<2?2:pnup pnud=pnud<3?3:pnud
% var pnus += tpsa==4?1.3:.86
% var pnup += tppa==4?1.3:.75
% var pnud += tpda==4?1.3:.3
  ATOM=A{2*i-1} P={pnus} {pnup} {pnud} 0.11 {strn}
  Q={tpsa<=2?2:0} 0 0 {qa} 0 0 0 0 0 0 0 0 {zero}
  TPAN={tpsa<2?1:2} {tppa<2?1:2} {tpda<2?1:tpda} 1
  ATOM=A{2*i} P={pnus} {pnup} {pnud} 0.11 {strn}
  Q={tpsa<=2?2:0} 0 0 {qa} 0 0 0 0 0 0 0 0 {zero}
  TPAN={tpsa<2?1:2} {tppa<2?1:2} {tpda<2?1:tpda} 1
  ATOM=EC{i} P=1.40 2.23 3.15 0.11 {strn}
  Q=0 0 0 0 0 0 0 0 0 0 0 0 {zero}
% ifdef Zb
  ATOM=EB{i} P=1.40 2.23 3.15 0.11 {strn}
  Q=0 0 0 0 0 0 0 0 0 0 0 0 {zero}
% endif
  ATOM=EA{2*i-1} P=1.40 2.23 3.15 0.11 {strn}
  Q=0 0 0 0 0 0 0 0 0 0 0 0 {zero}
  ATOM=EA{2*i}  P=1.40 2.23 3.15 0.11 {strn}
  Q=0 0 0 0 0 0 0 0 0 0 0 0 {zero}
% end
#  ---------------- START, tbe ----------------
% elseif tbe
START   CNTROL={nit==0} BEGMOM=T FREE=f NIT=nit
% var es=es{eltc} ep=ep{eltc} nq=nq{eltc}
% cvar zc==5|zc==13|zc==31|zc==49 qp=1
% cvar zc==6|zc==14|zc==32|zc==50 qp=2
% cvar zc==7|zc==15|zc==33|zc==51 qp=3
% cvar zc>=2&zc<=10  ps=2.5 pp=2.5
% cvar zc>=10&zc<=18 ps=3.5 pp=3.5
% cvar zc>=28&zc<=36 ps=4.5 pp=4.5
% cvar zc>=46&zc<=54 ps=5.5 pp=5.5
% repeat i= 1:ncell
  ATOM=C{i} P={ps} {pp} Q=2 {es} 0 {qp} {ep} 0
% end
% udef ps pp es ep qp
% var es=es{elta} ep=ep{elta}
% cvar za==5|za==13|za==31|za==49 qp=1
% cvar za==6|za==14|za==32|za==50 qp=2
% cvar za==7|za==15|za==33|za==51 qp=3
% cvar za>=2&za<=10  ps=2.5 pp=2.5
% cvar za>=10&za<=18 ps=3.5 pp=3.5
% cvar za>=28&za<=36 ps=4.5 pp=4.5
% cvar za>=46&za<=54 ps=5.5 pp=5.5
% repeat i= 1:ncell
  ATOM=A{2*i-1} P={ps} {pp} Q=2 {es} 0 {qp} {ep} 0
  ATOM=A{2*i} P={ps} {pp} Q=2 {es} 0 {qp} {ep} 0
% end
% ifdef eltb
% var es=es{eltb} ep=ep{eltb}
% cvar zb==5|zb==13|zb==31|zb==49 qp=1
% cvar zb==6|zb==14|zb==32|zb==50 qp=2
% cvar zb==7|zb==15|zb==33|zb==51 qp=3
% cvar zb>=2&zb<=10  ps=2.5 pp=2.5
% cvar zb>=10&zb<=18 ps=3.5 pp=3.5
% cvar zb>=28&zb<=36 ps=4.5 pp=4.5
% cvar zb>=46&zb<=54 ps=5.5 pp=5.5
% repeat i= 1:ncell
  ATOM=B{i} P={ps} {pp} Q=2 {es} 0 {qp} {ep} 0
% end
% endif
% endif
# --- ofp-specific ---
# %ifdef ofp
# MAP     F  *: \h\t:g
# SOLVE   SMODE=0*11 TOL=.001 H=.01 EEPS=4e-6 VAR=y y2 y3 tet
# FIT     WVS=1 1  NFIT=2 EFIT=-.5 -2
# MASTER  a={a} job=1
#         JOB  1  alatj=a*{scale}^(5-job)
#         JOB  2  alatj=a*{scale}^(5-job)
#         JOB  3  alatj=a*{scale}^(5-job)
#         JOB  4  alatj=a*{scale}^(5-job)
#         JOB  5  alatj=a*{scale}^(5-job)
#         JOB  6  alatj=a*{scale}^(5-job)
#         JOB  7  alatj=a*{scale}^(5-job)
#         JOB  8  alatj=a*{scale}^(5-job)
#         JOB  9  alatj=a*{scale}^(5)

#         JOB 11 tet= 0.96
#         JOB 12 tet= 0.97
#         JOB 13 tet= 0.98
#         JOB 14 tet= 0.99
#         JOB 15 tet= 1.00
#         JOB 16 tet= 1.01
#         JOB 17 tet= 1.02
#         JOB 18 tet= 1.03
#         JOB 19 tet= 1.04

#         JOB 21 wto= -4*.0009
#         JOB 22 wto= -3*.0009
#         JOB 23 wto= -2*.0009
#         JOB 24 wto= -1*.0009
#         JOB 25 wto=  0*.0009
#         JOB 26 wto=  1*.0009
#         JOB 27 wto=  2*.0009
#         JOB 28 wto=  3*.0009
#         JOB 29 wto=  4*.0009

# % const kl0=1
#         JOB 31 trig=1 trig+= 0.96-trig kl=(1-trig)/6*{kl0}
#         JOB 32 trig=1 trig+= 0.97-trig kl=(1-trig)/6*{kl0}
#         JOB 33 trig=1 trig+= 0.98-trig kl=(1-trig)/6*{kl0}
#         JOB 34 trig=1 trig+= 0.99-trig kl=(1-trig)/6*{kl0}
#         JOB 35 trig=1 trig+= 1.00-trig kl=(1-trig)/6*{kl0}
#         JOB 36 trig=1 trig+= 1.01-trig kl=(1-trig)/6*{kl0}
#         JOB 37 trig=1 trig+= 1.02-trig kl=(1-trig)/6*{kl0}
#         JOB 38 trig=1 trig+= 1.03-trig kl=(1-trig)/6*{kl0}
#         JOB 39 trig=1 trig+= 1.04-trig kl=(1-trig)/6*{kl0}
# JOB    5  20
# %endif
