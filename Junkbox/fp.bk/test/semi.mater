# Segment of input file containing material- class-dependent properties
# .. As INPUT, require
#   nelt=2 for binary or 3 for ternary
#   strings eltc and elta (and eltb if nelt=3) defining elements
#
#   OPTIONAL compound name (see below)
#
# .. File GENERATES for each of nelt elements {c,a,b}
#    Z{c,a,b}  atomic number
#    tps{c,a,b}, tpp{c,a,b}, tpd{c,a,b} :
#      tpd=0 => hi d, no 2pan
#      tpd=1 => lo d, no 2pan
#      tpd=2 => hi d, pan 1 + lo d pan2
#      tpd=3 => extended local orbitals
#      tpd=4 => lo d, pan 1 + hi d pan2
#    The following MAY be generated, if xcf and gga are set
#     eref{c,a,b}
#
# .. OPTIONALLY if cmpd is defined, the following input variables may be set:
#    tp{s,p,d,f}{c,a} ={0,1,2,3,4} defines orbitals are low, which are high
#
# .. File GENERATES
#    azb  equil. lattice in zb structure
#    awz  equil. lattice in wz structure
#    basis-specifying strings  basc, basa, base
#    (following apply only to OFP)
#      tpan
#   MAY generate: lmbe[ca] lmae[ca]
# .. ChangeLog
# 24 Apr 08  Setup for LaFeAsO
# 24 Mar 08  Setup for GeGaAs alloys
# 28 Dec 07  In the II-IV-V compounds, freeze d pnu for Ge,Sn
# 21 Apr 07  New compound BaO; update TaO
# 21 Apr 07  New compounds HfO2,ZrO2.  Note CeO2, Ce2O3 basis slightly different
# 28 Feb 07  New compound CoO2
# 10 Jul 06  New compound FeAl
#  2 Jul 06  New compounds LaN,CeN,EuN,YbN
# 12 Jun 06  New compounds BN,BP,BAs
#  6 May 06  New compound Bi2Te3
# 29 Apr 06  New basis for CuAlO2,CuGaO2,CuInO2,BeS,BeSe,MgS,MgSe
# 25 Apr 06  New basis for BeTe,MgTe
#  1 Feb 06  New basis for TaO
# 22 Jan 06  bas12 for AlP
#  6 Nov 05  New compounds CdSe,HgSe,HgS
# 22 Oct 05  Some updates for CdO
# 16 Aug 05  New compound Cu2S
#  4 Aug 05  New compound CuBr
# 24 Jul 05  redesign of P,PZ for GaN
# 22 Jul 05  New basis for NiMnSb and Heusler alloys
# 12 Jul 05  Clean up GaAs basis; RSMH to f orbitals for E.S.
#  2 Jul 05  fixed bigbas=11 for InSb
# 26 May 05  New compound SiGe
# 24 May 05  New basis for MnAs; new CrN; updates to eref lookup
# 26 Mar 05  New compound Cu2O
# 16 Feb 05  New basis for ErAs
# 29 Jan 05  New basis for Sn
# 16 Dec 04  New basis for GdP,GdAs,CaO
#  6 Dec 04  New basis for C,SiC,MgO
#  6 Nov 04  New basis for HgTe,CdS,CdTe,ZnS,ZnTe,ZnSe,AlSb,ZnO,GaN,InN,ScN,SrO,AlN
# 10 Oct 04  New basis for InP,Ge,InAs,GaSb,AlAs
# 27 Sep 04  New basis for CaO, new basis for Si
# 11 Sep 04  New basis for CeO2
#  6 Sep 04  New bigbas for InSb,GaAs with extended local orbitals
# 10 Jun 04  New NiMnSb,ZnTe
#  9 May 04  bigbas=6 for GaP
# 21 Apr 04  adjusted gwbas=f basis for InN. bigbas=6 for AlSb
# 12 Feb 04  new basis for GdN,GdP,GdAs
#  6 Feb 04  new basis for SrO,NiAs,ScN; revised basis for MnAs
#  1 Feb 04  new basis for AlP
#  4 Jan 04  new basis for ErAs
#  4 Jan 04  new basis for InP
#  2 Dec 03  new basis for GaN
# 28 Nov 03  new basis for AlAs,AlN,GaAs
#  6 Nov 03  new basis for AlN
# 25 Sep 03  bigbas=5 for Si,GaSb,InSb,GaAs,AlSb,GaP
# 19 Sep 03  bigbas=4 w/ 2nd f orbitals for Si,InP,ZnS,ZnSe,GaN,GaAs,CdS,InSb,InN,GaP,AlSb
# 15 Sep 03  bigbas=3 w/ g orbitals for GaAs,ZnS,ZnSe,InSb,Si,CdS,InP
# 26 Aug 03  gwbas for Alsb
# 22 Aug 03  gwbas for InAs
# 18 Aug 03  gwbas and/or bigbas=2 for CdS,ZnSe,ZnS,InP
#  8 Aug 03  New bases for ZnS, ZnSe bigbas=2 for HgTe
#  7 Aug 03  New basis for HgTe
#  6 Aug 03  Reworked basis for InN; gwbas for Ge
#  5 Aug 03  gwbas for GaAs; extra basis choices for Si
#  1 Aug 03  tpada=2 for GaSb
# 31 Jul 03  gwbas for GaP
# 30 Jul 03  bigbas and tpdc=4 for CdO
# 29 Jul 03  gwbas for ZnO
# 24 Jul 03  bigbas=2 for InN
# 23 Jul 03  bigbas=2 for GaP, tpda=2 for InSb
# 22 Jul 03  bigbas=3 for GaN and GaAs
# 21 Jul 03  bigbas=2 for AlSb and for GaN
# 19 Jul 03  gwbas for GaN, to avoid interpolation problems in GW bands
# 18 Jul 03  new larger basis sets for C, to test conv. w.r.t. basis
# 17 Jul 03  new gwbas for MgO, to avoid interpolation problems in GW bands
#            new gwbas for SiC, to avoid interpolation problems in GW bands
# 15 Jul 03  tppc=2 for ZnO
#  8 Jul 03  new gwbas for diamond, to avoid interpolation problems in GW bands
#            tpdc=4 basis for CdTe
#            tpda=2 basis for AlSb
#
# --- Macros and default values ---
# ... Macro pval(tp,default-p,low-p,high-p) select which P valence
#     Macro ploc(tp,default-p,low-p,high-p) select which PZ local
# macro   makes  tp=0    tp=1    tp=2    tp=3    tp=4
#  pval     P     p0      plo     phi     phi     plo
#  ploc     PZ     0      0       plo  10+plo     phi
% macro pval(tp,p0,plo,phi) tp==0?p0:((tp==1|tp==4)?plo:((tp==2|tp==3)?phi:0))
% macro ploc(tp,p0,plo,phi) tp<2?0:(tp==2?plo:(tp==3?10+plo:(tp==4?phi:0)))
# macro for principal quantum number for sp semi core states
% macro pqnsc(z) z<11?1:(z<19?2:(z<37?3:(z<55?4:5)))
# macro for principal quantum number for TM d valence states
# Elements marking transition from d in valence to d in core:  Ge, Sn, Pb
% macro pqnd(z)  z<32?3:(z<50?4:(z<82?5:6))
# Element marking transition from 4f to 5f in valence:  Hf/Ta
% macro pqnf(z)  z>72?5:4
% macro min(a,b) (a<b?a:b)
#---------------- Default values for basis constants ----------------
% ifdef gwbas
%   const ehmax=-.3
% else
%   const ehmax=-.1
% endif
% const tpsc=0 tppc=0 tpdc=0 tpfc=0 tpsa=0 tppa=0 tpda=0 lfc=0 lfa=0 lgc=0 lga=0
% ifdef nelt>2
% const tpsb=0 tppb=0 tpdb=0 lfb=0 lgb=0
% endif
% ifdef nelt>3
% const tpsd=0 tppd=0 tpdd=0 lfd=0 lgd=0
% endif
#---------------- Free-atom energies ----------------
% vec erefbh[83]
% vec erefbh(1:5) -0.8981-0.0781 0 -14.7106 -28.9148 -48.7408
% vec erefbh(6:8) -74.9949 -108.3613 -149.1822
% vec erefbh(9:14) -198.4228 0 -323.3409 -398.9159 -483.5463 -577.69658
% vec erefbh(15:18) -681.7019 -795.7136 -920.2358 0
% vec erefbh(19:22) -1201.1108 -1357.3538 -1524.6173 -1703.4890
% vec erefbh(23:26) -1894.2951 -2097.3033 -2312.6092 -2540.5681
% vec erefbh(27:30) -2781.6524 -3036.1820 -3304.4345 -3586.5189
% vec erefbh(31:34) -3882.1256 -4191.6569-0.0522 -4515.4714 -4853.4670
% vec erefbh(35:40) -5206.0715 0 -5955.1147 -6351.4281 -6762.5727 -7189.0263
% vec erefbh(41:44) -7631.0823 -8088.9209 -8562.5418 -9052.4204
% vec erefbh(45:48) -9558.7907 -10081.8924 -10621.9685 -11178.8931
% vec erefbh(49:54) -11752.5630 -12343.4222 -12951.6632 -13577.3544 0 0
% vec erefbh(55:57) -15561.2527 -16258.1782 -16973.2948
# Ce:  Q=2,0,0,2 MMOM=2,0,0,2
% vec erefbh(58:71) -17707.4198 0 0 0 0 -21673.2077 -22527.181222 0 0 0 -26155.2775 0 -28101.5723 0
% vec erefbh(72:75) -30137.6046 -31189.9017 -32265.5134 -33364.4264
% vec erefbh(76:79) -34487.2370 -35634.0931 -36805.4789 -38001.6756
% vec erefbh(80:83) -39222.8479 -40468.8134 0 -43037.4922
% vec ereflm[83]
% vec ereflm(1:8) -0.9894 0 -14.8363 -29.0952 -48.9840
% vec ereflm(6:8) -75.3053 -108.7417 -149.6055
% vec ereflm(9:14) -198.9010 0 -323.9536 -399.5824 -484.2945 -578.53355
% vec ereflm(15:18) -682.6306 -796.7102 -921.3120 0
% vec ereflm(19:22) -1202.3534 -1358.6611 -1526.0016 -1704.9844
% vec ereflm(23:26) -1895.8753 -2098.9693 -2314.3248 -2542.3426
% vec ereflm(27:30) -2783.53 -3038.1050 -3306.4359 -3588.5895
% vec ereflm(31:34) -3884.2872 -4193.9012-0.0720 -4517.8415 -4855.9134
% vec ereflm(35:40) 0 0 -5957.8443 -6354.2361 -6765.4799 -7192.0796
% vec ereflm(41:44) -7634.2494 -8092.2041 -8565.9731 -9055.8738
% vec ereflm(45:48) -9562.3473 -10085.5577 -10625.7667 -11182.7667
% vec ereflm(49:54) -11756.5524 -12347.5389 -12955.9104 -13581.7015 0 0
% vec ereflm(55:57) -15565.9590 -16262.9903 -16978.2357
% vec ereflm(58:71) 0 0 0 0 0 0 0 0 0 0 0 0 0 0
% vec ereflm(72:75) -30144.5720 -31197.1092 -32272.8772 -33371.9218
% vec ereflm(76:79) -34494.8876 -35641.9213 -36813.4896 -38009.8780
% vec ereflm(80:82) -39231.2340 -40477.3968 0
% vec erefvo[82]
% vec erefpw[82]
% vec erefp6[82]
#
% vec erefvo(1:5)   -.8918-.0660 0 0 -28.9001 -48.7219
% vec erefvo(6:8)   -74.88394-0.0883 -108.11284-.2237 -149.1664
% vec erefvo(9:14)   0 0 0 -398.9207 -483.5517 -577.65247-0.0485
% vec erefvo(15:18) -681.7055 -795.7303 -920.2604
% vec erefvo(19:22)         0  -1357.3968          0 -1703.5284
% vec erefvo(23:26)         0  -2097.3569 -2312.6902 -2540.6621
% vec erefvo(27:30)         0 -3036.2988 -3304.5648
% vec erefvo(31:34) -3882.2788 -4191.8235-0.0446 -4515.6359 -4853.6510
% vec erefvo(35:40) -5206.2690 0 0 0 0 0
% vec erefvo(45:48) 0 -12952.0424 0 0
% vec erefvo(49:51) -11752.9277 -12343.75667-0.0377 -12952.0426
% vec erefvo(52:54) -13577.7553 0 0
# erefpw is for PW91 functional (LDA)
% vec erefpw(1:5)   0 0 0 0 -48.9650
% vec erefpw(6:8)   -75.2826 -108.3315 0 0 0
% vec erefpw(9:14)  0 0 0 0 -484.2999 -578.5380
% vec erefpw(15:18) -682.6343 0 0 0
% vec erefpw(23:26) 0 -2097.3249 0 0
% vec erefpw(26:28) -2545.8752 0 -3042.0250
% vec erefpw(31:34) -3884.4404 0 -4515.6084 0
% vec erefpw(49:51) -11756.9171 0 -12956.2896
# erefp6 is for PBE functional with PBE GGA
% vec erefp6(1:5)   0 0 0 0 -49.2260
% vec erefp6(6:8)   -75.6206 -109.135579 0 0 0
% vec erefp6(9:14)  0 0 0 0 -485.3835 -579.7322
% vec erefp6(15:18) -683.9418 0 0 0
% vec erefp6(23:26)  0 -2101.4335 -2316.9972 0
% vec erefp6(31:34) -3887.8879 -4197.7197 -4521.7362 0
% vec erefp6(45:48) 0 -12962.9868 0 0
# warning: seems to be a problem with PBE functional for Sb
% vec erefp6(49:54) -11763.2675 0 -12967.6656 0 0 0
#---------------- Element-dependent constants ----------------
# ... do for C, A, and optionally B and D
% repeat i=1:nelt
%   udef -f Zz
%   cchar elt i==1 {eltc} i==2 {elta} i==3 {eltb}
%   ifdef i==4
%     char elt "{eltd}"
%   endif
%   cconst elt=='Be' Zz=4
%   cconst elt=='B'  Zz=5
%   cconst elt=='C'  Zz=6
%   cconst elt=='N'  Zz=7  rc=2.8
%   cconst elt=='O'  Zz=8
%   cconst elt=='Na' Zz=11
%   cconst elt=='Mg' Zz=12
%   cconst elt=='Al' Zz=13 tpd=0
%   cconst elt=='Si' Zz=14 rc=4.8
%   cconst elt=='P'  Zz=15 rc=3.5
%   cconst elt=='S'  Zz=16
%   cconst elt=='Cl' Zz=17
%   cconst elt=='Ca' Zz=20 tps=2 tpp=2
%   cconst elt=='Cr' Zz=24 tps=2 tpp=0
%   cconst elt=='Mn' Zz=25 tps=2 tpp=0
%   cconst elt=='Fe' Zz=26
%   cconst elt=='Co' Zz=27 tps=2 tpp=0
%   cconst elt=='Ni' Zz=28 tps=2 tpp=0
%   cconst elt=='Cu' Zz=29 tps=2 tpp=0
%   cconst elt=='Ge' Zz=32 tpd=2
%   cconst elt=='Sn' Zz=50 tpd=2
%   cconst elt=='Ga' Zz=31 tpd=tpan==2?4:1
%   cconst elt=='In' Zz=49 tpd=tpan==2?4:1
%   cconst elt=='Zn' Zz=30 tpd=tpan==2?4:1
%   cconst elt=='Cd' Zz=48 tpd=tpan==2?4:1
%   cconst elt=='Ta' Zz=73
%   cconst elt=='W'  Zz=74
%   cconst elt=='Hg' Zz=80 tpd=tpan==2?4:1
%   cconst elt=='Tl' Zz=81 tpd=tpan==2?4:1
%   cconst elt=='Pb' Zz=82 tpd=tpan==2?4:1
%   cconst elt=='Bi' Zz=83 tpd=tpan==2?4:1
%   cconst elt=='As' Zz=33 tpd=2 rc=4.5
%   cconst elt=='Sb' Zz=51 tpd=2 rc=4.6
%   cconst elt=='Se' Zz=34 tpd=2
%   cconst elt=='Br' Zz=35 tpd=2
%   cconst elt=='Te' Zz=52 tpd=2
%   cconst elt=='Sc' Zz=21
%   cconst elt=='Ti' Zz=22
%   cconst elt=='Sr' Zz=38
%   cconst elt=='Zr' Zz=40
%   cconst elt=='Ba' Zz=56
%   cconst elt=='La' Zz=57
%   cconst elt=='Ce' Zz=58
%   cconst elt=='Eu' Zz=63
%   cconst elt=='Gd' Zz=64
%   cconst elt=='Er' Zz=68
%   cconst elt=='Tm' Zz=69
%   cconst elt=='Yb' Zz=70
%   cconst elt=='Hf' Zz=72
%   cconst elt=='Ir' Zz=77
%   cconst elt=='Pt' Zz=78
%   cconst elt=='Au' Zz=79

# --- Sanity check
% ifdef Zz
% else
%   stop 1 (semi.mater) missing Z for element {elt}
% endif
# ... default values
% const tps=0 tpp=0 tpd=0
% udef -f eref
% cconst gga==3&xcf==4 eref=erefp6(Zz)
% cconst gga==1&xcf==2 eref=ereflm(Zz)
% ifndef gga
% cconst xcf eref=xcf==2?erefbh(Zz):(xcf==1?erefvo(Zz):(xcf==3?erefpw(Zz):0))
% endif
% const  eref=0
# % const  lesi=0
# % cvar les lesi=flor(les/10)
# --- copy to c,b,a,d depending on i
% cchar strn i==1 c i==2 a i==3 b i==4 d
% const Z{strn}=Zz eref{strn}=eref
# ... printout
% char strn "Z={Zz}"
% echo {elt} parms : {strn} eref={eref}
% udef elt  tps tpp tpd zz
% end
#---------------- Compound-dependent constants ----------------
% ifdef cmpd=='MgSiP2' 
%   var calco245=t
% elseifd cmpd=='ZnSiP2' | cmpd=='ZnGeP2' | cmpd=='ZnSnP2' | cmpd=='ZnSiAs2' | cmpd=='ZnGeAs2' | cmpd=='ZnSnAs2'
%   var calco245=t
% elseifd cmpd=='CdSiP2' | cmpd=='CdGeP2' | cmpd=='CdSnP2' | cmpd=='CdSiAs2' | cmpd=='CdGeAs2' | cmpd=='CdSnAs2'
%   var calco245=t
% endif
% ifdef cmpd=='C' | cmpd=='CC'
%   const tpan=f metal=f azb=6.74
%   char  strnc          "P={pval(tpsc,2.75,2.75,2.75)},{pval(tppc,2.60,2.60,2.60)},{pval(tpdc,3.25,3.25,3.25)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,2.75,2.75,3.50)},{ploc(tppc,2.60,2.60,3.50)},{ploc(tpdc,0,0,0)} IDMOD=0,0,1,1,1"
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.0,0.8,0.8,{lfc?0.8:0},{lgc?0.8:0} EH={-0.5},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.0,{bigbas==11?0:0.8},{bigbas==11?0:0.8} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.80"
%     char  base "RSMH=1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd gwbas
%   char  basc "RSMH=1,0.8,0.8,0.8 EH=-.3,-.3,-.3,-.3"
%   char  base "RSMH=1.6,1.6,1.6 EH=-.5,-.5,-.5"
%   ifdef f
%   elseifd bigbas==3
%     char  basc "RSMH=1,0.8,0.8,0.8 EH=-.5,-.3,-.3,-.3 RSMH2=0.8,0.8,0.8 EH2=-1.2,-1.2,-1.2"
%     char  base "RSMH=1.6,1.6,1.6,1.6 EH=-.5,-.5,-.5,-.5"
%     char  strnec "LMX=3"
%   elseifd bigbas==2
%     char  basc "RSMH=1,0.8,0.8,0.8 EH=-.5,-.3,-.3,-.3 RSMH2=0.8,0.8,0.8 EH2=-1.2,-1.2,-1.2"
%   elseifd bigbas
%     char  basc "RSMH=1,0.8,0.8,0.8 EH=-.5,-.3,-.3,-.3 RSMH2=0.8,0.8 EH2=-1.2,-1.2"
%   endif
%   char  basa "{basc}"
%   else
%   char  basc "RSMH=1,0.8,0.8,0.8 EH=-.1,-.1,-.1,-.1"
%   char  base "RSMH=1.6,1.6,1.6 EH=-.1,-.1,-.1"
%   ifdef f
%   elseifd bigbas==3
%     char  basc "RSMH=1,0.8,0.8,0.8 EH=-.1,-.1,-.1,-.1 RSMH2=0.8,0.8,0.8 EH2=-1.2,-1.2,-1.2"
%     char  base "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1"
%     char  strnec "LMX=3"
%   elseifd bigbas==2
%     char  basc "RSMH=1,0.8,0.8,0.8 EH=-.1,-.1,-.1,-.1 RSMH2=0.8,0.8,0.8 EH2=-1.2,-1.2,-1.2"
%     char  base "RSMH=1.6,1.6,1.6 EH=-.1,-.1,-.1"
%   elseifd bigbas
%     char  basc "RSMH=1,0.8,0.8,0.8 EH=-.1,-.1,-.1,-.1 RSMH2=0.8,0.8 EH2=-1.2,-1.2"
%   endif
%   char  basa "{basc}"
%   endif
% elseifd cmpd=='BeO'
%   const tpan=t metal=f azb=7.0
% elseifd cmpd=='MgO'
#   RT lattice constant from Adachi: a=4.203/.5292 = 7.945 at RT and 'a=4.203/.5292*(1-4e-6*300)' = 7.936 at 0K
%   const tpan=t metal=f a=7.96 tpsc=2 tppc=2
%   char  strnc "P={pval(tpsc,0,2.94,3.5)},{pval(tppc,0,2.93,3.5)},3.3,4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,2.94,3.5)},{ploc(tppc,0,2.93,3.5)},{ploc(tpdc,0,0,4.15)} IDMOD=0,0,1,1,1"
%   char  strna "P={pval(tpsa,0,2.83,3.5)},{pval(tppa,0,2.70,3.5)},3.25,4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,2.83,3.5)},{ploc(tppa,0,2.70,3.5)},0 IDMOD=0,0,1,1,1"
%   ifdef tpsc==2 | tpsc==3
%   char  strnc "{strnc} Q=0,0,0"
%   endif
%   ifdef tpsc+tppc>0
%     const ngd=24
%     char  strnc "{strnc} RS3=.80"
%   else
%     const ngd=20
%   endif
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.6,1.6,1.6,{lfc?1.6:0},{lgc?1.6:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.6,{tppc==2?.8:{bigbas==11?0:1.6}},1.6 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.80"
%     char  basa "RSMH=.85,.85,.85,{lfa?.85:0},{lga?.85:0} EH={tpsa==3?ehmax:-.6},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=.85,.85,.85 EH2={tpsa==3?ehmax-.8:-1.4},{ehmax-.8},{ehmax-.8} RS3=.9"
%     char  base "RSMH=1.5,1.5,1.5*0,1.5*0 EH={ehmax-.2},{ehmax-.2},{ehmax-.2},{ehmax-.2}"
%   elseifd bigbas&(tppc==1|tppc==2|tppc==4)
%     char  basc "RSMH=1.6,1.6,1.6,1.6,{lgc?1.6:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.6,0.8,1.6 EH2={ehmax-.8},-1.5,{ehmax-.8}"
%     char  basa "RSMH=.85,.85,.85,.85 EH=-.5,{ehmax},{ehmax},{ehmax} RSMH2=.85,.85 EH2={-.5-.8},{ehmax-.8}"
%     char  base "RSMH=1.5,1.5,1.5*0   EH=-.5,-.5,-.5"
%   elseifd bigbas==2
%     char  basc "RSMH=1.6,1.6,1.6,1.6,{lgc?1.6:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.6,1.6,1.6 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8}"
%     char  basa "RSMH=.85,.85,.85,.85 EH=-.5,{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=.85,.85,.85 EH2={-.5-.8},{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.5,1.5,1.5*0   EH=-.5,-.5,-.5"
%   elseifd bigbas
%     char  basc "RSMH=1.6,1.6,1.6,1.6,{lgc?1.6:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.6,1.6,1.6 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8}"
%     char  basa "RSMH=.85,.85,.85,.85 EH=-.5,{ehmax},{ehmax},{ehmax} RSMH2=.85,.85 EH2={-.5-.8},{ehmax-.8}"
%     char  base "RSMH=1.5,1.5,1.5*0   EH=-.5,-.5,-.5"
%   else
%     char  basc "RSMH=1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "RSMH=.85,1.0,1.6,1.6 EH=-.7,{ehmax},{ehmax},{ehmax}"
%     char  base "RSMH=2.2,2.2,2.2*0   EH={ehmax},{ehmax},{ehmax}"
%   endif
% elseifd cmpd=='CaO'
%   const tpan=t metal=f a=9.09 tppc=2 tpsc=2 ngd=21
%   char  strnc "P={pval(tpsc,0,3.94,4.5)},{pval(tppc,0,3.93,4.5)},{tpdc==4?3.3:3.6},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,3.94,4.5)},{ploc(tppc,0,3.93,4.5)},{ploc(tpdc,0,0,4.15)} IDMOD=0,0,1,1,1"
%   char  strna "P={pval(tpsa,0,2.83,3.5)},{pval(tppa,0,2.70,3.5)},3.25,4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,2.83,3.5)},{ploc(tppa,0,2.70,3.5)},0 IDMOD=0,0,1,1,1"
%   ifdef tpsc==2 | tpsc==3
%   char  strnc "{strnc} Q=0,0,0"
%   endif
%   ifdef tpsc+tppc>0
%     const ngd=24
%     char  strnc "{strnc} RS3=.80"
%   else
%     const ngd=20
%   endif
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.3,1.3,1.3,{lfc?1.3:0},{lgc?1.3:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.3,{tppc==2?.8:{bigbas==11?0:1.3}},1.3 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.80"
%     char  basa "RSMH=.85,.85,.85,{lfa?.85:0},{lga?.85:0} EH={tpsa==3?ehmax:-.6},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=.85,.85,.85 EH2={tpsa==3?ehmax-.8:-1.4},{ehmax-.8},{ehmax-.8} RS3=.9"
%     char  base "RSMH=1.5,1.5,1.5*0,1.5*0 EH={ehmax-.2},{ehmax-.2},{ehmax-.2},{ehmax-.2}"
%   elseifd bigbas&(tppc==1|tppc==2|tppc==4)
%     char  basc "RSMH=1.3,1.3,1.3,1.3,{lgc?1.3:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.3,0.8,1.3 EH2={ehmax-.8},-1.5,{ehmax-.8}"
%     char  basa "RSMH=.85,.85,.85,.85 EH=-.5,{ehmax},{ehmax},{ehmax} RSMH2=.85,.85 EH2={-.5-.8},{ehmax-.8}"
%     char  base "RSMH=1.5,1.5,1.5*0   EH=-.5,-.5,-.5"
%   elseifd bigbas
%     char  basc "RSMH=1.3,1.3,1.3,1.3,{lgc?1.3:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.3,1.3,1.3 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8}"
%     char  basa "RSMH=.85,.85,.85,.85 EH=-.5,{ehmax},{ehmax},{ehmax} RSMH2=.85,.85 EH2={-.5-.8},{ehmax-.8}"
%     char  base "RSMH=1.5,1.5,1.5*0   EH=-.5,-.5,-.5"
%   else
%     char  basc "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "RSMH=.85,1.1,.85,.85 EH=-.7,{ehmax},{ehmax},{ehmax}"
%     char  base "RSMH=2.2,2.2,2.2*0   EH={ehmax},{ehmax},{ehmax}"
%   endif
% elseifd cmpd=='ZnO'
#   RT Lattice parameters taken from Adachi
#   a=3.2495/.5292 = 6.1404 q=5.2069/3.2495 = 1.602
#   lattice parameters taken from Usuda's paper
#%   const tpan=f metal=f awz=3.242/.5292 q=1.602 xwz=.024 tppc=0 tpsc=0
#   a,q taken from LB: H.Schulz, K.H.Theimann, Sol. St. Comm. 32, 783 (1979)
#   xwz was minimized for this q.  Usual parameter 'u=1-5/8*(1-x/2)'
%   const tpan=f metal=f awz=3.253/.529 q=1.603 xwz=.0175 tppc=0 tpsc=0 gmax=10
%   const azb=awz*sqrt(2)*(q/sqrt(8/3))^(1/3)
%   ifdef strx=='WZ' | strx=='wzx'
%     const lmbec=-1
%     ifdef asa
%     char  strnea "LMX={nl-1} IDXDN=1,1,1,3 P=0,0,0,4.15"
%     endif
%   endif
%   char  strnc "P={pval(tpsc,0,3.94,5.5)},{pval(tppc,0,3.93,5.5)},{pval(tpdc,3.91,3.91,4.4)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,3.94,5.5)},{ploc(tppc,0,3.93,5.5)},{ploc(tpdc,0,3.91,4.4)} IDMOD=0,0,0,1,1"
%   char  strna "P={pval(tpsa,0,2.88,3.5)},{pval(tppa,0,2.70,3.5)},3.25,4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,2.88,3.5)},{ploc(tppa,0,2.70,3.5)},0 IDMOD=0,0,1,1,1"
# %   ifdef tpdc==4
# %     char  strnc "PZ=0,0,4.5"
# %     cchar strnc tppc==2 "PZ=0,3.9,4.5" t "PZ=0,0,4.5"
# %     char  strna "P=0,0,3.20 PZ=3.5 IDMOD=0,0,1"
# %   elseifd tppc==2
# %     char strnc "PZ=0,3.9,0"
# %   endif
# %   char0 strna "P=0,0,3.20 IDMOD=0,0,1"
%   ifdef f
#   Patterned after bigbas11 in ZnS
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.5,1.5,0.90,{lfc?1.5:0},{lgc?1.5:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef f
%     elseif bigbas==11
%     char  basc "{basc} RSMH2=1.5,0,0.90 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.5,1.5,0.90 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     endif
%     char  basa "RSMH=0.80,0.85,0.85,{lfa?.85:0} EH={tpsa==3?ehmax:-.7},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=0.80,0.85,0.85 EH2={tpsa==3?ehmax-.8:-1.5},{ehmax-.8},{ehmax-.8} RS3=.9"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd gwbas&bigbas
%     char  basc "RSMH=1.4,1.4,0.85,1.4 EH=-.3,-.3,-.3,-.3     RSMH2=1.4,1.4,.85 EH2=-1,-1,-1"
%     char  basa "RSMH=0.80,0.85,0.85,0.85 EH=-0.7,-.3,-.3,-.3 RSMH2=0.80,0.85,0 EH2=-1.5,-1.2,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.3,-.3,-.3,-.3"
%   elseifd gwbas
%     stop 1 'semi.mater abort : ZnO not set up for this gwbas'
%   elseifd bigbas==2&tppc==2
%     char  basc "RSMH=1.4,1.4,0.85,1.4 EH=-.1,-.1,-.3,-.1     RSMH2=1.4,.80,.85 EH2=-1,-3,-1"
%     char  basa "RSMH=0.80,0.85,0.85,0.85 EH=-0.7,-.1,-.1,-.1 RSMH2=0.80,0.85,0.85 EH2=-1.5,-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas==2
%     char  basc "RSMH=1.4,1.4,0.85,1.4 EH=-.1,-.1,-.3,-.1     RSMH2=1.4,1.4,.85 EH2=-1,-1,-1"
%     char  basa "RSMH=0.80,0.85,0.85,0.85 EH=-0.7,-.1,-.1,-.1 RSMH2=0.80,0.85,0.85 EH2=-1.5,-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas
%     char  basc "RSMH=1.4,1.4,0.85,1.4 EH=-.1,-.1,-.3,-.1     RSMH2=1.4,1.4,.85 EH2=-1,-1,-1"
%     char  basa "RSMH=0.80,0.85,0.85,0.85 EH=-0.7,-.1,-.1,-.1 RSMH2=0.80,0.85,0 EH2=-1.5,-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.1,-.1,-.1,-.1"
%   else
%     char  basc "RSMH=1.4,1.4,0.85,1.4 EH=-.6,-.1,-.4,-.1"
%     char  basa "RSMH=0.80,0.85,0.85,0.85 EH=-1.0,-.1,-.1,-.1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.1,-.1,-.1,-.1"
%   endif
% elseifd cmpd=='TaO'
#   Lattice constant from Wykoff (Acta Chem Scand 8, 240 (1954)) 4.422-4.439A
%   const tpan=t metal=2 a=8.37 tpsc=3 tppc=3 gmax=10
#   Ta s,p state never high
%   char  strnc       "P={pval(tpsc,0,{{pqnsc(Zc)}+0.94},{{pqnsc(Zc)}+1.5})}"
%   char  strnc "{strnc},{pval(tppc,0,{{pqnsc(Zc)}+0.93},{{pqnsc(Zc)}+1.35})}"
%   char  strnc "{strnc},{pval(tpdc,{{pqnsc(Zc)}+.91},{{pqnsc(Zc)}+.91},4.4)}"
#%   char  strnc "{strnc},{Zc>70?5.15:4.15},5.12"
%   char  strnc "{strnc},{pval(tpfc,{{pqnf(Zc)}+.15},{{pqnf(Zc)}+.15},{{pqnf(Zc)}+.15})}"
%   char  strnc "{strnc},5.12 KMXA=4"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,{{pqnsc(Zc)}+.94},{{pqnsc(Zc)}+1.35})}"
%   char  strnc "{strnc},{ploc(tppc,0,{{pqnsc(Zc)}+.93},{{pqnsc(Zc)}+1.35})}"
%   char  strnc "{strnc},{ploc(tpdc,0,0,{{pqnd(Zc)}+1.5})}"
%   char  strnc "{strnc},{ploc(tpfc,0,4.93,6.2)} IDMOD=0,0,0,1,1 RS3=0.8"
%   char  strna "P={pval(tpsa,0,2.88,3.5)},{pval(tppa,0,2.70,3.5)},3.25,4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,2.88,3.5)},{ploc(tppa,0,2.70,3.5)},0 IDMOD=0,0,1,1,1"
%   char  strna "{strna} RSFA=3.2"
%   ifdef tpsc==2 | tpsc==3
%   char  strnc "{strnc} Q=0,0,5"
%   endif
%   ifdef f
%   elseifd bigbas==11 | bigbas==12 | bigbas==13
%     char  basc "RSMH=1.4,{tppc==1?.8:1.4},1.10,{lfc?1.4:0},{lgc?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef f
%     elseif bigbas==11
%     char  basc "{basc} RSMH2=1.4,0,1.10 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.4,1.4,1.10 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==13
%     char  basc "{basc} RSMH2=1.4,1.4,1.10,1.4 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     endif
%     char  basa "RSMH=0.88,0.88,0.88,{lfa?.88:0},{lga?.88:0}
%     char  basa "{basa} EH={tpsa==3?ehmax:-.7},{ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef bigbas==13
%     char  basa "{basa} RSMH2=0.88,0.88,0.88,.88 EH2={tpsa==3?ehmax-.8:-1.5},{ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.9"
%     else
%     char  basa "{basa} RSMH2=0.88,0.88,0.88 EH2={tpsa==3?ehmax-.8:-1.5},{ehmax-.8},{ehmax-.8} RS3=.9"
%     endif
%     char  base "RSMH=1.4,1.4,1.4,1.4,1.4 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas
%     char  basc "RSMH=1.4,1.4,1.10,1.4 EH=-.1,-.1,-.3,-.1     RSMH2=1.4,1.4,.85 EH2=-1,-1,-1"
%     char  basa "RSMH=0.88,0.88,0.88 EH=-.5,-.3,-.1,-.1  RSMH2=0.88,0.88,0 EH2=-1.5,-1,-1"
%     char  base "RSMH=1.4,1.4,1.4,1.4  EH=-.1,-.1,-.1,-.1"
%   else
%     char  basc "RSMH=2.0,{tppc==1?.8:1.4},1.10,2.0 EH=-.1,{tppc==1?-1.5:-.1},-.3,-.1"
%     char  basa "RSMH=0.88,0.88,0.88 EH=-.3,-.3,-.1,-.1"
%     char  base "RSMH=2.0,2.0,2.0     EH=-.1,-.1,-.1"
%  endif
% elseifd cmpd=='CdO'
%   const tpan=t metal=2 azb=8.92 tpsc=2 tppc=2 ngd=24 gmax=10
%   char  strnc "P={pval(tpsc,0,4.94,6.5)},{pval(tppc,0,4.94,5.3)},{pval(tpdc,4.91,4.91,5.4)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,4.94,6.5)},{ploc(tppc,0,4.94,6.5)},{ploc(tpdc,0,4.91,5.4)} IDMOD=0,1,0,1,1"
%   char  strnc "{strnc} RS3=.85"
%   char  strna "P={pval(tpsa,0,2.88,3.5)},{pval(tppa,0,2.70,3.5)},3.25,4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,2.88,3.5)},{ploc(tppa,0,2.70,3.5)},0 IDMOD=0,0,1,1,1"
# %   ifdef tpdc==4
# %     char  strnc "PZ=0,0,5.4 IDMOD=0,0,1"
# %     char  strna "P=0,0,3.20 PZ=3.5 IDMOD=0,0,1"
# %   endif
%   ifdef f
#   Patterned after bigbas11 in ZnO
%   elseifd bigbas==11 | bigbas==12 | bigbas==13
%     char  basc "RSMH=1.4,1.4,0.85,{lfc?1.4:0},{lgc?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef f
%     elseif bigbas==11
%     char  basc "{basc} RSMH2=1.4,0,0.85 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.4,1.4,0.85 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==13
%     char  basc "{basc} RSMH2=1.4,1.4,0.85,1.4 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     endif
%     char  basa "RSMH=0.88,0.88,0.88,{lfa?.88:0},{lga?.88:0}
%     char  basa "{basa} EH={tpsa==3?ehmax:-.7},{ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef bigbas==13
%     char  basa "{basa} RSMH2=0.88,0.88,0.88,.88 EH2={tpsa==3?ehmax-.8:-1.5},{ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.9"
%     else
%     char  basa "{basa} RSMH2=0.88,0.88,0.88 EH2={tpsa==3?ehmax-.8:-1.5},{ehmax-.8},{ehmax-.8} RS3=.9"
%     endif
%     char  base "RSMH=1.4,1.4,1.4,1.4,1.4 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd gwbas&bigbas
%     char  basc "RSMH=1.4,1.4,0.85,1.4 EH=-.3,-.3,-.3,-.3     RSMH2=1.4,1.4,.85 EH2=-1,-1,-1"
%     char  basa "RSMH=0.88,0.88,0.88,0.88 EH=-.5,-.3,-.3,-.3  RSMH2=0.88,0.88,0 EH2=-1.5,-1,-1"
%     char  base "RSMH=1.4,1.4,1.4,1.4 EH=-.3,-.3,-.3,-.3"
%   elseifd gwbas
%     stop 1 'semi.mater abort : CdO not set up for this gwbas'
%   elseifd bigbas
%     char  basc "RSMH=1.4,1.4,0.85,1.4 EH=-.1,-.1,-.3,-.1     RSMH2=1.4,1.4,.85 EH2=-1,-1,-1"
%     char  basa "RSMH=0.88,0.88,0.88,0.88 EH=-.5,-.3,-.1,-.1  RSMH2=0.88,0.88,0 EH2=-1.5,-1,-1"
%     char  base "RSMH=1.4,1.4,1.4,1.4  EH=-.1,-.1,-.1,-.1"
%   else
%     char  basc "RSMH=2.0,2.0,0.85,2.0 EH=-.1,-.1,-.3,-.1"
%     char  basa "RSMH=0.88,0.88,0.88,0.88 EH=-.3,-.3,-.1,-.1"
%     char  base "RSMH=2.0,2.0,2.0     EH=-.1,-.1,-.1"
%   endif
% elseifd cmpd=='BN'
%   const tpan=f metal=f azb=3.615/.5292
#   (basis adapted from BP,AlN)
%   char  strnc          "P={pval(tpsc,0,0,2.75)},{pval(tppc,0,0,2.60)},{pval(tpdc,3.3,0,3.3)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,0,3.50)},{ploc(tppc,0,0,3.50)},{ploc(tpdc,0,0,0)} IDMOD=0,0,1,1,1"
%   char  strna "         P={pval(tpsa,0,2.83,2.83)},{pval(tppa,0,2.70,2.70)},3.25,4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,2.83,3.50)},{ploc(tppa,0,2.70,3.50)},0 IDMOD=0,0,1,1,1"
%   char  strna "{strna} IDMOD=0,0,1,1,1"
%   const ngd=30
%   ifdef f
%   elseifd asa
%   elseifd lmf
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.3,1.1,1.2,{lfc?1.2:0},{lgc?1.2:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef f
%     elseif bigbas==11
%     char  basc "{basc} RSMH2=1.2,1.2,1.1 EH2={-1.3},{-1.3},{-1.3} RS3=.95"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.2,1.2,1.1 EH2={-1.1},{-1.1},{-1.1} RS3=.95"
%     elseif bigbas==13
%     char  basc "{basc} RSMH2=1.2,1.2,1.2,1.2 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.95"
%     endif
%     char  basa "RSMH=.8,.8,.8,{lfa?.8:0},{lga?.8:0} EH={tpsa==3?ehmax:-.6},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=.8,.8,.8 EH2={tpsa==3?ehmax-.8:-1.4},{ehmax-.8},{ehmax-.8} RS3=.9"
%     char  base "RSMH=1.1,1.1,1.1,1.1 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas
%     char  basc "RSMH=1.3,1.1,1.1,1.1 EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.2,0,0,0 EH2=-1.3"
%     char  basa "RSMH=.8,.8,.8,.8 EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=.8,.8 EH2=-1.3,-1.1"
%     char  base "RSMH=1.1,1.1,1.1,1.1 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     char  basc "RSMH=1.3,1.1,1.1 EH=-.7,{ehmax},{ehmax},{ehmax}"
%     char  basa "RSMH=.8,.8,.8,.8 EH=-1.0,{ehmax},{ehmax},{ehmax}"
%     char  base "RSMH=1.1,1.1,1.1 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   endif
%   endif
% elseifd cmpd=='AlN'
%   const azb=4.38/.529
%   const tpan=f metal=f tppc=2 awz=3.111/.529 q=1.601 xwz=.021 gmax=10
#%   char  linkc "0 0 0 -3 -3 -1.2"  linka "0 0 0 -1 -1.3 -1.2"
#%   char  strnc "P=0,0,3.25 IDMOD=0,0,1"
#%   char  strna "P=0,0,3.25 IDMOD=0,0,1"
%   char  strnc          "P={pval(tpsc,0,2.95,3.5)},{pval(tppc,0,2.95,3.5)},{pval(tpdc,3.3,3.3,3.3)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,2.95,4.5)},{ploc(tppc,0,2.95,4.5)},{ploc(tpdc,0.0,0.0,4.4)}"
%   char  strnc "{strnc} IDMOD=0,0,1,1,1"
%   char  strna "         P={pval(tpsa,0,2.83,2.83)},{pval(tppa,0,2.70,2.70)},3.25,4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,2.83,3.5)},{ploc(tppa,0,2.70,3.5)},0 IDMOD=0,0,1,1,1"
%   char  strna "{strna} IDMOD=0,0,1,1,1"
%   const ngd=30
# %   char  strnc "P=0,0,3.30 IDMOD=0,0,1"
# %   char  strna "P=0,2.7,3.25 IDMOD=0,1,1"
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.3,1.3,1.3,{lfc?1.3:0},{lgc?1.3:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.3,{bigbas==11?0:1.3},{bigbas==11?0:1.3} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.80"
%     char  basa "RSMH=1,1,1,{lfa?1:0},{lga?1:0} EH={tpsa==3?ehmax:-.6},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1,1,1 EH2={tpsa==3?ehmax-.8:-1.4},{ehmax-.8},{ehmax-.8} RS3=.9"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH={ehmax},{ehmax},{ehmax},{ehmax}"
#   bigbas=6 combines bigbas=3 with local orbitals of bigbas=5
%   elseifd bigbas==6
%     char  basc "RSMH=1.3,1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.3,1.3,1.3 EH2=-1.1,-1.1,-1.1"
%     char  basa "RSMH=1,1,1,1 EH=-.7,{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1,1,1 EH2=-1.4,-1.1,-1.1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  strnc "P=0,0,3.30 PZ=4.5,0,0 IDMOD=0,0,1"
%     char  strna "P=0,0,3.30 PZ=3.5,3.5,0 IDMOD=0,0,1"
%   elseifd bigbas==5
%     char  basc "RSMH=1.3,1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.3,1.3,1.3,1.3 EH2=-1.1,-1.1,-1.1,-1.1"
%     char  basa "RSMH=1,1,1,1 EH=-.7,{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1,1,1,1 EH2=-1.4,-1.1,-1.1,-1.1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  strnc "P=0,0,3.30 PZ=4.5,0,0 IDMOD=0,0,1"
%     char  strna "P=0,0,3.30 PZ=3.5,3.5,0 IDMOD=0,0,1"
%   elseifd bigbas==4
%     char  basc "RSMH=1.3,1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.3,1.3,1.3,1.3 EH2=-1.1,-1.1,-1.1,-1.1"
%     char  basa "RSMH=1,1,1,1 EH=-.7,{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1,1,1,1 EH2=-1.4,-1.1,-1.1,-1.1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH={ehmax},{ehmax},{ehmax},{ehmax} IDMOD=1,1,1"
%   elseifd bigbas==3
%     char  basc "RSMH=1.3,1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.3,1.3,1.3 EH2=-1.1,-1.1,-1.1"
%     char  basa "RSMH=1,1,1,1 EH=-.7,{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1,1,1 EH2=-1.4,-1.1,-1.1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==2
%     char  basc "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.3,1.3,1.3 EH2=-1,-1,-1"
%     char  basa "RSMH=1,1,1,1 EH=-.7,{ehmax},{ehmax},{ehmax} RSMH2=0,1 EH2=-1.4,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas
%     char  basc "RSMH=1.4,1.4,1.4,1.4 EH=-.3,{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.3,0,0,0 EH2=-1"
%     char  basa "RSMH=.9,.9,.9,.9 EH=-.7,{ehmax},{ehmax},{ehmax} RSMH2=0,.9 EH2=-1,-1"
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     char  basc "RSMH=1.4,1.4,1.4,1.4 EH=-.5,{ehmax},{ehmax},{ehmax}"
%     char  basa "RSMH=.9,.9,.9,.9 EH=-.7,{ehmax},{ehmax},{ehmax}"
%     char  base "RSMH=1.4,1.4,1.4,1.4 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   endif
#%   char  basb "RSMH=2.0,2.0,1.0,1.4 EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.6,1.6,1 EH2=-1.2,-1.2,-1.2 RS3=.95"
#%   char  strnb "MMOM=0,0,3 IDMOD=0,0,0,1,1"
% elseifd cmpd=='GaN'
%   const azb=4.52/.529
%   const metal=f awz=3.190/.529 q=1.627 xwz=.006 gmax=12 elind=-.5
#   Ga d:  P,PZ  : 'p0' = valence, 'plo' = valence, 'phi' = valence + 1
%   char i c
%   char strnc="P={pval({tps{i}},0,0*{{pqnsc(Z{i})}+1.8},0*{{pqnsc(Z{i})}+1.8})}
%   char strnc="{strnc},{pval({tpp{i}},0,0*{{pqnsc(Z{i})}+1.5},0*{{pqnsc(Z{i})}+1.5})}
%   char strnc="{strnc},{pval({tpd{i}},{{pqnd(Z{i})}+.92},{{pqnd(Z{i})}+.92},{{pqnd(Z{i})}+1.5})}
%   char strnc="{strnc} PZ={ploc({tps{i}},0,{{pqnsc(Z{i})}+.94},{{pqnsc(Z{i})}+2.5})}"
%   char strnc="{strnc},{ploc({tpp{i}},0,{{pqnsc(Z{i})}+.93},{{pqnsc(Z{i})}+2.5})}"
%   char strnc="{strnc},{ploc({tpd{i}},{{pqnd(Z{i})}+.92},{{pqnd(Z{i})}+.92},{{pqnd(Z{i})}+1.5})}
%   char strnc "{strnc} RS3=0.75 IDMOD=0,0,0,1,1"
%   char i a
%   char strna="P={pval({tps{i}},0,{{pqnsc(Z{i})}+1.88},{{pqnsc(Z{i})}+2.5})}
%   char strna="{strna},{pval({tpp{i}},0,{{pqnsc(Z{i})}+1.85},{{pqnsc(Z{i})}+2.5})}
%   char strna="{strna},{pval({tpd{i}},{{pqnd(Z{i})}+0.3},{{pqnd(Z{i})}+0.3},{{pqnd(Z{i})}+0.3})}
%   char strna="{strna} PZ={ploc({tps{i}},0,{{pqnsc(Z{i})}+1.88},{{pqnsc(Z{i})}+2.5})}"
%   char strna="{strna},{ploc({tpp{i}},0,{{pqnsc(Z{i})}+1.85},{{pqnsc(Z{i})}+2.5})}"
%   char strna="{strna},{ploc({tpd{i}},0,{{pqnd(Z{i})}-1+0.93},{{pqnd(Z{i})}+1.5})}
%   char strna "{strna} RS3=0.90 IDMOD=0,0,{tpda<=1|tpda==4?1:0},1,1"
%   udef i
%   ifdef strx=='WZ' | strx=='wzx'
%     const lmbec=1
%   endif
%   ifdef ofp
%     char  strnc "CLINK=0 0 0 -1.5 -1.5 -.8" strna "CLINK=0 0 0 -1 0 -1.2"
%     const tppc=2 tpsc=0 tpan=f
%   endif
#%   ifdef bigbas>10
# %     char  strnc "P={pval(tpsc,0,3.94,5.5)},{pval(tppc,0,3.91,5.5)},{pval(tpdc,4.3,3.91,4.4)},4.15,5.12"
# %     char  strnc "{strnc} PZ={ploc(tpsc,0,3.91,5.5)},{ploc(tppc,0,3.91,5.5)},{ploc(tpdc,4.3,3.91,4.4)}"
# %     char  strnc "{strnc} IDMOD=0,0,{tpdc==0?1:0},1,1"
# %     char  strna "P={pval(tpsa,0,2.83,3.5)},{pval(tppa,0,2.70,3.5)},3.25,4.15,5.12"
# %     char  strna "{strna} PZ={ploc(tpsa,0,2.83,3.5)},{ploc(tppa,0,2.70,3.5)},0 IDMOD=0,0,1,1,1"
# %   elseifd tpdc==1
# %     char  strnc "P=0,0,3.9"
# %   elseifd tpdc==2
# %     char  strnc "P=0,0,4.4 PZ=0,0,3.9"
# %     char  strna "P=0,0,3.20 PZ=3.5 IDMOD=0,0,1"
# %   elseifd tpdc==4
# %     char  strnc "PZ=0,0,4.4 P=0,0,3.9"
# %     char  strna "P=0,0,3.20 PZ=3.5 IDMOD=0,0,1"
# %   else
# %     char  strnc "P=0,0,4.25 IDMOD=0,0,1"
# %     stop 1 Ga 4d is perilous in GaN!.  Delete this line if you really want it.
# %   endif
# %   char0 strna "P=0,0,3.20 IDMOD=0,0,1"
%   ifdef tpdc>0
%     const ngd=40
%   else
%     const ngd=16
%   endif
%   ifdef bigbas==11 | bigbas==12 | bigbas==13
%     char  basc "RSMH=1.3,1.3,1.3,{lfc?1.3:0},{lgc?1.3:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef bigbas==11
%     char  basc "{basc} RSMH2=1.3,0,{tpdc==3?0:0.75} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.80"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.3,1.3,{tpdc==3?1.3:0.75} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.80"
%     elseif bigbas==13
%     char  basc "{basc} RSMH2=1.3,1.3,{tpdc==3?1.3:0.75},1.3 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.80"
%     endif
%     char  basa "RSMH=1,1,1,{lfa?1:0},{lga?1:0} EH={tpsa==3?ehmax:-.6},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef bigbas==13
%     char  basa "{basa} RSMH2=1,1,1,1 EH2={tpsa==3?ehmax-.8:-1.4},{ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.9"
%     else
%     char  basa "{basa} RSMH2=1,1,1 EH2={tpsa==3?ehmax-.8:-1.4},{ehmax-.8},{ehmax-.8} RS3=.9"
%     endif
%     char  base "RSMH=1.2,1.2,1.2,1.2,1.2 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd lmf & gwbas
%   ifdef f
#   bigbas=6 combines bigbas=3 with local orbitals of bigbas=5
%   elseifd bigbas==6
%     char  basc "RSMH=1.3,1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.3,1.3,0.7 EH2=-1,-1,-1"
%     char  basa "RSMH=1,1,1,1,1 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1,1,1 EH2=-1.2,-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef tpdc==1 | tpdc==4
%       char  strnc "P=0,0,3.9 PZ=5.5,0*5.5,4.5"
%     elseifd tpdc==2
%       char  strnc "P=0,0,4.5 PZ=5.5,0*5.5,3.9"
%     endif
%     char  strna "P=0,0,3.30 PZ=3.5,3.5,0 IDMOD=0,0,1"
%   elseifd bigbas==5
%     char  basc "RSMH=1.3,1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.3,1.3,0.7,1.3 EH2=-1,-1,-1,-1"
%     char  basa "RSMH=1,1,1,1,1 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1,1,1 EH2=-1.2,-1,-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef tpdc==1 | tpdc==4
%       char  strnc "P=0,0,3.9 PZ=5.5,0*5.5,4.5"
%     elseifd tpdc==2
%       char  strnc "P=0,0,4.5 PZ=5.5,0*5.5,3.9"
%     endif
%     char  strna "P=0,0,3.30 PZ=3.5,3.5,0 IDMOD=0,0,1"
%   elseifd bigbas==4 & tpdc==4
%     char  basc "RSMH=1.3,1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.3,1.3,0.7,1.3 EH2=-1,-1,-1,-1"
%     char  basa "RSMH=1,1,1,1,1 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1,1,1 EH2=-1.2,-1,-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==3 & tpdc==4
%     char  basc "RSMH=1.3,1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.3,1.3,0.7 EH2=-1,-1,-1"
%     char  basa "RSMH=1,1,1,1,1 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1,1,1 EH2=-1.2,-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==2 & tpdc==4
%     char  basc "RSMH=1.3,1.3,1.3,1.3 EH=-.3,-.3,-.2,-.3 RSMH2=1.3,1.3,0.7 EH2=-1,-1,-1"
%     char  basa "RSMH=1,1,1,1 EH=-.7,-.3,-.3,-.3 RSMH2=0,1 EH2=-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.3,-.3,-.3,-.3"
%   elseifd bigbas & tpdc==4
%     char  basc "RSMH=1.3,1.3,0.7,1.3 EH=-.3,-.3,-.5,-.3 RSMH2=1.3,1.3,0 EH2=-1,-1,-2"
%     char  basa "RSMH=1,1,1,1 EH=-.7,-.3,-.3,-.3 RSMH2=0,1 EH2=-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.3,-.3,-.3,-.3"
%   elseifd bigbas & tpdc==1
%     char  basc "RSMH=1.3,1.3,.70,1.3 EH=-.3,-.3,-.3,-.3 RSMH2=1.3,1.3,.70 EH2=-1,-1,-1"
%     char  basa "RSMH=1,1,1,1 EH=-.7,-.3,-.3,-.3 RSMH2=0,1 EH2=-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.3,-.3,-.3,-.3"
%   elseifd tpdc==1
%     char  basc "RSMH=1.3,1.3,.70,1.3 EH=-.3,-.3,-.7,-.3"
%     char  basa "RSMH=1,1,1,1 EH=-.7,-.3,-.3,-.3"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.3,-.3,-.3,-.3"
%   else
%     stop 1 'basis not built for this case'
%   endif
%   elseifd lmf
%   ifdef f
%   elseifd bigbas==4 & tpdc==4
%     char  basc "RSMH=1.3,1.3,1.3,1.3,1.3 EH=-.1,-.1,-.2,-.1,-.1 RSMH2=1.3,1.3,0.7,1.3 EH2=-1,-1,-1,-1"
%     char  basa "RSMH=1,1,1,1,1 EH=-.1,-.1,-.1,-.1,-.1 RSMH2=1,1,1,1 EH2=-1,-1,-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas==3 & tpdc==4
%     char  basc "RSMH=1.3,1.3,1.3,1.3,1.3 EH=-.01,-.01,-.01,-.01 RSMH2=1.3,1.3,0.7 EH2=-1,-1,-.5"
%     char  basa "RSMH=1,1,1,1,1 EH=-.7,-.01,-.01,-.01 RSMH2=1,1,1 EH2=-2,-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.01,-.01,-.01,-.01"
%   elseifd bigbas==2 & tpdc==4
%     char  basc "RSMH=1.3,1.3,1.3,1.3 EH=-.01,-.01,-.01,-.01 RSMH2=1.3,1.3,0.7 EH2=-1,-1,-.5"
%     char  basa "RSMH=1,1,1,1 EH=-.7,-.01,-.01,-.01 RSMH2=0,1 EH2=-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.01,-.01,-.01,-.01"
%   elseifd bigbas & tpdc==4
%     char  basc "RSMH=1.3,1.3,0.7,1.3 EH=-.01,-.01,-.5,-.01 RSMH2=1.3,1.3,0 EH2=-1,-1,-2"
%     char  basa "RSMH=1,1,1,1 EH=-.7,-.01,-.01,-.01 RSMH2=0,1 EH2=-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.01,-.01,-.01,-.01"
%   elseifd bigbas & tpdc==1
%     char  basc "RSMH=1.3,1.3,.70,1.3 EH=-.01,-.01,-.01,-.01 RSMH2=1.3,1.3,.70 EH2=-1,-1,-1"
%     char  basa "RSMH=1,1,1,1 EH=-.7,-.01,-.01,-.01 RSMH2=0,1 EH2=-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.01,-.01,-.01,-.01"
%   elseifd bigbas&tpdc>1
%     stop 1 basis not built for this case
%   elseifd bigbas
%     stop 1 'basis not built for this case'
%   elseifd tpdc>1
%     stop 1 'basis not built for this case'
%   elseifd tpdc==1
%     char  basc "RSMH=1.3,1.3,.70,1.3 EH=-.01,-.01,-.7,-.01"
%     char  basa "RSMH=1,1,1,1 EH=-.7,-.01,-.01,-.01"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.01,-.01,-.01,-.01"
%   else
%     stop 1 'basis not built for this case'
%   endif
%   endif
# Mn or Cr impurity
%   char  basb "RSMH=2.0,2.0,1.0,1.4 EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.6,1.6,1 EH2=-1.2,-1.2,-1.2 RS3=.95"
%   char  strnb "MMOM=0,0,3 IDMOD=0,0,0,1,1"
% elseifd cmpd=='InN'
%   const azb=4.98/.529
%   const metal=f awz=3.533/.529 q=1.611 xwz=.018
%   ifdef strx=='WZ' | strx=='wzx'
%     const lmbec=1
%   endif
%   ifdef ofp
%     char  strnc "CLINK=0 0 0 -1.5 -1.8 -.8"  strna "CLINK=0 0 0 -1 -3 -1.2"
%     const tppc=2 tpsc=0 tpan=f
%   else
%   ifdef bigbas>10
%     char  strnc "P={pval(tpsc,0,4.94,6.5)},{pval(tppc,0,4.93,6.5)},{pval(tpdc,4.93,4.93,5.4)},4.15,5.12"
%     char  strnc "{strnc} PZ={ploc(tpsc,0,4.94,6.5)},{ploc(tppc,0,4.93,6.5)},{ploc(tpdc,0,4.93,5.4)} IDMOD=0,0,0,1,1"
%     char  strna "P={pval(tpsa,0,2.83,3.5)},{pval(tppa,0,2.70,3.5)},3.25,4.15,5.12"
%     char  strna "{strna} PZ={ploc(tpsa,0,2.83,3.5)},{ploc(tppa,0,2.70,3.5)},0 IDMOD=0,0,1,1,1"
%   elseifd tpdc==1
%     const elind=-.5
%     char  strnc "P=0,0,4.9"
%   elseifd tpdc==2
%     char  strnc "P=0,0,5.25 PZ=0,0,4.9"
%     char  strna "P=0,0,3.20 PZ=3.5 IDMOD=0,0,1"
%   elseifd tpdc==4
%     char  strnc "PZ=0,0,5.4 P=0,0,4.9"
%     char  strna "P=0,0,3.20 PZ=3.5 IDMOD=0,0,1"
%   else
%     char  strnc "P=0,0,5.25 IDMOD=0,0,1"
%     stop 1 In 5d is perilous in InN!.  Delete this line if you really want it.
%   endif
%   char0 strna "P=0,0,3.20 IDMOD=0,0,1"
%   const gmax=10
%   ifdef tpdc>0
%     const ngd=40
%   else
%     const ngd=16
%   endif
%   ifdef f
#   Patterned after GaN bigbas11
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.7,1.7,1.7,{lfc?1.7:0},{lgc?1.7:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef bigbas==11
%     char  basc "{basc} RSMH2=1.3,0,{tpdc==3?0:.85} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.95"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.7,1.7,{tpdc==3?1.7:.85} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.80"
%     endif
%     char  basa "RSMH=1,1,1,{lfa?1:0},{lga?1:0} EH={tpsa==3?ehmax:-.6},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1,1,1 EH2={tpsa==3?ehmax-.8:-1.4},{ehmax-.8},{ehmax-.8} RS3=.9"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==4 & tpdc==4 & gwbas
%     char  basc "RSMH=1.7,1.7,1.7,1.7,1.7 EH=-.3,-.3,-.3,-.3,-.3 RSMH2=1.7,1.7,0.8,1.7 EH2=-1,-1,-1,-1"
%     char  basa "RSMH=1,1,1,1,1 EH=-.3,-.3,-.3,-.3,-.3 RSMH2=1,1,1,1 EH2=-1,-1,-1,-1"
%     char strnea "LMX=3"
%     char  base "RSMH=1.4,1.4,1.4,1.4 EH=-.3,-.3,-.3,-.3"
%   elseifd bigbas==3 & tpdc==4 & gwbas
%     char  basc "RSMH=1.7,1.7,1.7,1.7,1.7 EH=-.3,-.3,-.3,-.3,-.3 RSMH2=1.7,1.7,0.8 EH2=-1,-1,-1"
%     char  basa "RSMH=1,1,1,1,1 EH=-.3,-.3,-.3,-.3,-.3 RSMH2=1,1,1 EH2=-1,-1,-1"
%     char strnea "LMX=3"
%     char  base "RSMH=1.4,1.4,1.4,1.4 EH=-.3,-.3,-.3,-.3"
%   elseifd bigbas==2 & tpdc==4 & gwbas
%     char  basc "RSMH=1.7,1.7,1.7,1.7 EH=-.3,-.3,-.3,-.3 RSMH2=1.7,1.7,0.8 EH2=-1,-1,-1"
%     char  basa "RSMH=1,1,1,1 EH=-.3,-.3,-.3,-.3 RSMH2=1,1,1 EH2=-1,-1,-1"
%     char strnea "LMX=3"
%     char  base "RSMH=1.4,1.4,1.4,1.4 EH=-.3,-.3,-.3,-.3"
%   elseifd bigbas & tpdc==4 & gwbas
%     char  basc "RSMH=1.7,1.7,1.7,1.7 EH=-.3,-.3,-.3,-.3 RSMH2=1.7,1.7,0.8 EH2=-1,-1,-1"
%     char  basa "RSMH=1,1,1,1 EH=-.3,-.3,-.3,-.3 RSMH2=1,1 EH2=-1,-1"
%     char  base "RSMH=1.4,1.4,1.4 EH=-.3,-.3,-.3,-.3"
%   elseifd bigbas & tpdc==1 & gwbas
%     char  basc "RSMH=1.7,1.7,0.8,1.7 EH=-.3,-.3,-.3,-.3 RSMH2=1.7,1.7,0.8 EH2=-1,-1,-1"
%     char  basa "RSMH=1,1,1,1 EH=-.7,-.3,-.3,-.3 RSMH2=0,1 EH2=-1,-1"
%     char  base "RSMH=1.4,1.4,1.4,1.4 EH=-.3,-.3,-.3,-.3"
%   elseifd tpdc==1 & gwbas
%     char  basc "RSMH=1.7,1.7,.80,1.7 EH=-.3,-.3,-.7,-.3"
%     char  basa "RSMH=1,1,1,1 EH=-.7,-.3,-.3,-.3"
%     char  base "RSMH=1.4,1.4,1.4,1.4 EH=-.3,-.3,-.3,-.3"
%   elseifd bigbas==4 & tpdc==4
%     char  basc "RSMH=1.7,1.7,1.7,1.7,1.7 EH=-.1,-.1,-.3,-.1,-.1 RSMH2=1.7,1.7,0.8,1.7 EH2=-1,-1,-1,-1"
%     char  basa "RSMH=1,1,1,1,1 EH=-.3,-.1,-.1,-.1,-.1 RSMH2=1,1,1,1 EH2=-1,-1,-1,-1"
%     char strnea "LMX=3"
%     char  base "RSMH=1.4,1.4,1.4,1.4 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas==3 & tpdc==4
%     char  basc "RSMH=1.7,1.7,1.7,1.7,1.7 EH=-.1,-.1,-.3,-.1,-.1 RSMH2=1.7,1.7,0.8 EH2=-1,-1,-1"
%     char  basa "RSMH=1,1,1,1,1 EH=-.3,-.1,-.1,-.1,-.1 RSMH2=1,1,1 EH2=-1,-1,-1"
%     char strnea "LMX=3"
%     char  base "RSMH=1.4,1.4,1.4,1.4 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas==2 & tpdc==4
%     char  basc "RSMH=1.7,1.7,1.7,1.7 EH=-.1,-.1,-.3,-.1 RSMH2=1.7,1.7,0.8 EH2=-1,-1,-1"
%     char  basa "RSMH=1,1,1,1 EH=-.3,-.1,-.1,-.1 RSMH2=1,1,1 EH2=-1,-1,-1"
%     char strnea "LMX=3"
%     char  base "RSMH=1.4,1.4,1.4,1.4 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas & tpdc==4
%     char  basc "RSMH=1.7,1.7,1.7,1.7 EH=-.1,-.1,-.3,-.1 RSMH2=1.7,1.7,0.8 EH2=-1,-1,-1"
%     char  basa "RSMH=1,1,1,1 EH=-.3,-.1,-.1,-.1 RSMH2=1,1 EH2=-1,-1"
%     char  base "RSMH=1.4,1.4,1.4 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas & tpdc==1
%     char  basc "RSMH=1.7,1.7,0.8,1.7 EH=-.1,-.1,-.3,-.1 RSMH2=1.7,1.7,0.8 EH2=-1,-1,-1"
%     char  basa "RSMH=1,1,1,1 EH=-.7,-.3,-.1,-.1 RSMH2=0,1 EH2=-1,-1"
%     char  base "RSMH=1.4,1.4,1.4,1.4 EH=-.1,-.1,-.1,-.1"
%   elseifd tpdc==1
%     char  basc "RSMH=1.7,1.7,.80,1.7 EH=-.1,-.1,-.7,-.3"
%     char  basa "RSMH=1,1,1,1 EH=-.7,-.3,-.1,-.1"
%     char  base "RSMH=1.4,1.4,1.4,1.4 EH=-.1,-.1,-.1,-.1"
%   else
%     stop 1 'basis not built for this case'
%   endif
%   endif
% elseifd cmpd=='ScN'
%   const tpan=t metal=f a=4.44/.529 gmax=9
%     char  strnc "P={pval(tpsc,0,3.94,4.3)},{pval(tppc,0,3.93,4.3)},{pval(tpdc,3.3,3.3,4.4)},4.15,5.12"
%     char  strnc "{strnc} PZ={ploc(tpsc,0,3.94,5.5)},{ploc(tppc,0,3.93,5.5)},{ploc(tpdc,3.3,3.3,4.4)}"
%     char  strnc "{strnc} IDMOD=0,0,1,1,1"
%     ifdef tpsc==2|tpsc==3
%       char  strnc "{strnc} Q=0,0,3"
%     endif
%     char  strna "P={pval(tpsa,0,2.83,3.5)},{pval(tppa,0,2.70,3.5)},3.25,4.15,5.12"
%     char  strna "{strna} PZ={ploc(tpsa,0,2.83,3.5)},{ploc(tppa,0,2.70,3.5)},0 IDMOD=0,0,1,1,1"
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=0.9,0.8,1.1,{lfc?1.1:0},{lgc?1.1:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=0.9,{bigbas==11?0:0.8},1.1 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.80"
%     char  basa "RSMH=1,1,1,{lfa?1:0},{lga?1:0} EH={tpsa==3?ehmax:-.6},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1,1,1 EH2={tpsa==3?ehmax-.8:-1.4},{ehmax-.8},{ehmax-.8} RS3=.9"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH={ehmax},{ehmax},{ehmax},{ehmax}"
#   g orbitals to Sc, f on N, local orbitals
%   elseifd bigbas==6
%     char basc "RSMH=0.9,0.80,1.1,1.1,1.1 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char basc "{basc} RSMH2=0.9,0.80,1.1 EH2=-1.8,-1.8,{ehmax-.9}"
%     char strnc "P=4.5 4.3 3.3  PZ=3.9,3.9 IDMOD=0 1 1 1 1 Q=0 0 3"
%     char basa "RSMH=1.0,1.0,1.0,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char basa "{basa} RSMH2=1.0,1.0,1.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char strna "P=0,0,3.25 PZ=0,3.9 IDMOD=0 0 1"
%     char  base "RSMH=1.2,1.2,1.2,1.2*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
#   f orbitals on Sc, double spd on N
%   elseifd bigbas==2
%     char basc "RSMH=0.9,0.80,1.1,1 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char basc "{basc} RSMH2=0.9,0.80,1.1 EH2={ehmax-.9},-1.5,{ehmax-.9}"
%     char strnc "P=4.5 4.3 3.3  PZ=0,3.9 IDMOD=0 1 1 1 1"
%     char basa "RSMH=1.0,1.0,1.0 EH={ehmax},{ehmax},{ehmax}"
%     char basa "{basa} RSMH2=1.0,1.0,1.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char strna "P=0,0,3.25 IDMOD=0 0 1"
%     char  base "RSMH=1.2,1.2,1.2,1.2*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
#   Double spd on Sc, double sp on N
%   elseifd bigbas>1
%     stop 1 "basis not defined"
%   elseifd bigbas
%     char basc "RSMH=0.9,0.80,1.1 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char basc "{basc} RSMH2=0.9,0.80,1.1 EH2={ehmax-.9},-1.5,{ehmax-.9}"
%     char strnc "P=4.5 4.3 3.3  PZ=0,3.9 IDMOD=0 1 1 1 1"
%     char basa "RSMH=1.0,1.0,1.0 EH={ehmax},{ehmax},{ehmax}"
%     char basa "{basa} RSMH2=1.0,1.0,0.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char strna "P=0,0,3.25 IDMOD=0 0 1"
%     char  base "RSMH=1.2,1.2,1.2,1.2*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     char basc "RSMH=0.9,0.80,1.1 EH=-0.7,-1.5,{ehmax},{ehmax}"
%     char strnc "P=4.5 4.3 3.3  PZ=0,3.9 IDMOD=0 1 1 1 1"
%     char basa "RSMH=1.2,1.1,1.6 EH=-0.9,{ehmax},{ehmax}"
%     char strna "P=0,0,3.25 IDMOD=0 0 1"
%     char  base "RSMH=1.2,1.2,1.2*0,1.2*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   endif
% elseifd cmpd=='Si' | cmpd=='SiSi'
%   const tpan=f metal=f azb=10.26
#   ifdef ofp
%   char  linkc "0 0 0 -1.4 -2.0 -1.3" linka "0 0 0 -1.4 -2.0 -1.3"
#   endif
%   char  strnc          "P={pval(tpsc,3.75,2.95,3.5)},{pval(tppc,3.55,3.55,3.55)},{pval(tpdc,3.25,0,3.20)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,2.95,4.5)},{ploc(tppc,0,2.95,4.5)},{ploc(tpdc,0,0,4.2)} IDMOD=0,0,1,1,1"
%   ifdef tppc==2 | tppc==3
%     char  strnc "{strnc} Q=4,0,0 RS3=.90"
%   endif
%   ifdef tppc==2
%     const gmax=11
%   else
%     const gmax=8.2
%   endif
%   char  base "RSMH=1.4,1.4,1.4,1.4,1.4 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%   ifdef f
%   elseifd bigbas>10
%     char  basc "RSMH=1.4,1.4,1.4,{lfc?1.4:0},{lgc?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}
%     char  basc "{basc} RSMH2=1.4,{tppc==2?.75:1.4},{bigbas>11?1.4:0},{bigbas>12?1.4:0} EH2=-1.2,-1.2,-1.2,-1.2"
#   old basis for backward compatibility
%   elseifd bigbas==5&tppc==2&gwbas
%     char  basc "RSMH=1.4,1.4,1.4,1.4,1.4 EH=-.2,-.2,-.2,-.2,-.2 RSMH2=1.7,1.7,1.7,1.7 EH2=-1.2,-1.2,-1.2,-1.2"
%     char  strnc "P=0,3.55 PZ=0,2.95,4.4 IDMOD=0,1,1 Q=4,0"
%   elseifd bigbas==3&tppc==2&gwbas
%     char  basc "RSMH=1.4,1.4,1.4,1.4,1.4 EH=-.2,-.2,-.2,-.2,-.2 RSMH2=1.7,0.75,1.7 EH2=-1.2,-3,-1.2"
%     char  strnc "P=0,3.55 PZ=0,2.95 IDMOD=0,1 Q=4,0"
%     const gmax=11
%   elseifd bigbas==2&tppc==2&gwbas
%     char  basc "RSMH=1.4,1.4,1.4,1.4 EH=-.2,-.2,-.2,-.2 RSMH2=1.7,0.75,1.7 EH2=-1.2,-3,-1.2"
%     char  strnc "P=0,3.55 PZ=0,2.95 IDMOD=0,1 Q=4,0"
%     const gmax=11
%   elseifd bigbas==2&tppc==2
%     char  basc "RSMH=1.4,1.4,1.4,1.4 EH=-.1,-.1,-.1,-.1 RSMH2=1.7,0.75,1.7 EH2=-1.2,-3,-1.2"
%     char  strnc "P=0,3.55 PZ=0,2.95 IDMOD=0,1 Q=4,0"
%     const gmax=11
%   elseifd bigbas==5&gwbas
%     char  basc "RSMH=1.4,1.4,1.4,1.4,1.4 EH=-.2,-.2,-.2,-.2,-.2 RSMH2=1.7,1.7,1.7,1.7 EH2=-1.2,-1.2,-1.2,-1.2"
%     char  strnc "P=0,3.55 PZ=4.4,4.4,4.4 IDMOD=1,1,1"
%   elseifd bigbas==4&gwbas
%     char  basc "RSMH=1.4,1.4,1.4,1.4,1.4 EH=-.2,-.2,-.2,-.2,-.2 RSMH2=1.7,1.7,1.7,1.7 EH2=-1.2,-1.2,-1.2,-1.2"
%   elseifd bigbas==3&gwbas
%     char  basc "RSMH=1.4,1.4,1.4,1.4,1.4 EH=-.2,-.2,-.2,-.2,-.2 RSMH2=1.7,1.7,1.7 EH2=-1.2,-1.2,-1.2"
%   elseifd bigbas==2&gwbas
%     char  basc "RSMH=1.4,1.4,1.4,1.4 EH=-.2,-.2,-.2,-.2 RSMH2=1.7,1.7,1.7 EH2=-1.2,-1.2,-1.2"
%   elseifd bigbas&tppc==2
%     const gmax=11
%     char  basc "RSMH=1.4,1.4,1.4,1.4 EH=-.1,-.1,-.1,-.1 RSMH2=1.7,0.75 EH2=-1.2,-3"
%     char  strnc "P=0,3.55 PZ=0,2.95 IDMOD=0,1 Q=4,0"
%   elseifd bigbas==2
%     char  basc "RSMH=1.4,1.4,1.4,1.4 EH=-.1,-.1,-.1,-.1 RSMH2=1.7,1.7,1.7 EH2=-1.2,-1.2,-1.2"
%   elseifd bigbas&gwbas
%     char  basc "RSMH=1.4,1.4,1.4,1.4 EH=-.2,-.2,-.2,-.2 RSMH2=1.7,1.7 EH2=-1.2,-1.2"
%   else
%     char  basc "RSMH=1.4,1.4,1.4 EH=-.6,{ehmax},{ehmax},{ehmax}
%   endif
%   char  basa "{basc}"
% elseifd cmpd=='Ge' | cmpd=='GeGe'
%   const tpan=t metal=t azb=10.67
%   char  strnc          "P={pval(tpsc,0,3.95,5.5)},{pval(tppc,0,3.95,5.5)},{pval(tpdc,4.3,3.93,4.3)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,3.95,5.5)},{ploc(tppc,0,3.95,5.5)},{ploc(tpdc,4.3,3.93,4.3)}"
%   char  strnc "{strnc} IDMOD=0,0,{tpdc==0?1:0},1,1"
%   ifdef tppc==2 | tppc==3
%     char  strnc "{strnc} Q=4,0,0 RS3=.90"
%   endif
%   ifdef tpdc==3
%     char  strnc "{strnc} RS3=.90"
%   endif
%   ifdef tpdc>0 | tpcc==2
%     const ngd=24
%   elseif tpcc>0
%     const ngd=20
%   else
%     const ngd=15
%   endif
%   char strna "{strnc}"
%   ifdef f
%   elseifd bigbas>10
%     char  basc "RSMH=1.4,1.4,1.4,1.4,{lgc?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}
%     char  basc "{basc} RSMH2=1.4,{tppc==2?.75:1.4},{(tpdc==2|tpdc==4)?0.9:{bigbas>11?1.4:0}},{bigbas>12?1.4:0}"
%     char  basc "{basc} EH2={ehmax-.8},{ehmax-.8},{ehmax-((tpdc==2|tpdc==4)?1.5:.8)},{ehmax-.8}"
%     char  base "RSMH=1.4,1.4,1.4,1.4,1.4 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
#   old basis for backward compatibility
%   elseifd gwbas&bigbas&(tpdc==2|tpdc==4)
%     char  basc "RSMH=1.4,1.4,.9,1.4 EH=-.2,-.2,-.5,-.2 RSMH2=1.4,1.4,.9 EH2=-1,-1,-1.2"
%     char  basa "{basc}"
%     char  base "RSMH=1.4,1.4,1.4,-1  EH=-.2,-.2,-.2,-.2"
%   elseifd bigbas&(tpdc==2|tpdc==4)
%     char  basc "RSMH=1.4,1.4,.9,1.4 EH=-.1,-.1,-.5,-.1 RSMH2=1.4,1.4,.9 EH2=-1,-1,-1.2"
%     char  basa "{basc}"
%     char  base "RSMH=1.4,1.4,1.4,-1  EH=-.1,-.1,-.1,-.1"
%   elseifd (tpdc==2|tpdc==4)
%     char  basc "RSMH=1.4,1.4,.9,1.4 EH=-.1,-.1,-1.2,-.1
%     char  basa "{basc}"
%     char  base "RSMH=1.4,1.4,1.4,-1  EH=-.1,-.1,-.1,-.1"
%   elseifd tpdc>0
%     stop 1 basis not built for this case
%   elseifd bigbas
%     char  basc "RSMH=1.7,1.7,1.7,1.7 EH=-.1,-.1,-.1,-.1 RSMH2=1.7,1.7 EH2=-1,-1""
%     char  basa "{basc}"
%     char  base "RSMH=1.4,1.4,1.4,-1  EH=-.1,-.1,-.1,-.1"
%   else
%     char  basc "RSMH=1.4,1.4,1.4,1.4 EH=-.4,-.1,-.1,-.1"
%     char  basa "{basc}"
%     char  base "RSMH=1.4,1.4,1.4,-1  EH=-.1,-.1,-.1,-.1"
%   endif
% elseifd cmpd=='Sn' | cmpd=='SnSn'
%   const tpan=t metal=t azb=12.25
%   char  strnc "P={pval(tpsc,0,4.94,6.5)},{pval(tppc,0,4.93,6.5)},{pval(tpdc,4.93,4.93,5.4)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,4.94,6.5)},{ploc(tppc,0,4.93,6.5)},{ploc(tpdc,0,4.93,5.4)}"
%   char  strnc "{strnc} IDMOD=0,0,{tpdc==0?1:0},1,1"
%   const gmax=10
# %   ifdef ofp
# %   else
# %   ifdef tpdc>0
# %     const ngd=28
# %   else
# %     const ngd=16
# %   endif
# %   endif
%   ifdef f
#   Patterned after bigbas11 in InP, GaAs
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.7,1.7,1.7,{lfc?1.7:0},{lgc?1.7:0} EH={ehmax-.1},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef bigbas==11
%     char  basc "{basc} RSMH2=1.7,0,{tpdc==3?0:1.0} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.5,1.5,{tpdc==3?1.5:1.0} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     endif
# %     char  basa "RSMH=1.4,1.4,1.4,{lfa?1.4:0},{lga?1.4:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
# %     char  basa "{basa} RSMH2=1.4,1.4,1.4 EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.5,1.5,1.5,1.5*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas&(tpdc==2|tpdc==4)
%     char  basc "RSMH=1.4,1.7,.9,1.7 EH=-.3,-.1,-.5,-.1 RSMH2=1.4,1.4,.9 EH2=-1,-1,-1.5"
%     char  basa "{basc}"
%     char  base "RSMH=1.4,1.4,1.4,-1  EH=-.1,-.1,-.1,-.1"
%   elseifd (tpdc==2|tpdc==4)
%     char  basc "RSMH=1.4,1.7,.9,1.7 EH=-.3,-.1,-1,-.1"
%     char  basa "{basc}"
%     char  base "RSMH=1.7,1.7,1.7,-1  EH=-.1,-.1,-.1,-.1"
%   elseifd tpdc>0
%     stop 1 basis not built for this case
%   elseifd bigbas
%     char  basc "RSMH=1.4,1.7,1.7,1.7 EH=-.3,-.1,-.1,-.1 RSMH2=1.4,1.7 EH2=-1,-1"
%     char  basa "{basc}"
%     char  base "RSMH=1.4,1.4,1.4,-1  EH=-.1,-.1,-.1,-.1"
%   else
%     char  basc "RSMH=1.4,1.7,1.7,1.7 EH=-.3,-.1,-.1,-.1"
%     char  basa "{basc}"
%     char  base "RSMH=1.7,1.7,1.7,-1  EH=-.1,-.1,-.1,-.1"
%   endif
% elseifd cmpd=='SiC'
%   const tpan=f metal=f azb=8.24
%   const tpan=f metal=f awz=3.086/.529 q=sqrt(8/3)
%   const ngd=24
%   char  strnc          "P={pval(tpsc,3.75,2.95,3.5)},{pval(tppc,3.55,2.95,3.55)},{pval(tpdc,3.25,0,3.20)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,2.95,4.5)},{ploc(tppc,0,2.95,4.5)},{ploc(tpdc,0,0,4.2)} IDMOD=0,0,1,1,1"
%   char  strna          "P={pval(tpsa,2.75,2.75,2.75)},{pval(tppa,2.60,2.60,2.60)},{pval(tpda,3.25,3.25,3.25)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,2.75,2.75,3.50)},{ploc(tppa,2.60,2.60,3.50)},{ploc(tpda,0,0,0)} IDMOD=0,0,1,1,1"
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.4,1.4,1.4,1.4,{lgc?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}
%     char  basc "{basc} RSMH2=1.4,{tppc==2?.75:1.4},{bigbas>11?1.4:0},{bigbas>12?1.4:0} EH2=-1.2,-1.2,-1.2,-1.2"
%     char  basa "RSMH=1.0,0.8,0.8,{lfa?0.8:0},{lga?0.8:0} EH={-0.5},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.0,{bigbas==11?0:0.8},{bigbas==11?0:0.8} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.80"
%     char  base "RSMH=1.4,1.4,1.4 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     char  basc "RSMH=1.4,1.4,1.4,1.4 EH=-.1,-.1,-.1,-.1
%     char  basa "RSMH=0.9,0.9,0.9,0.9 EH=-.7,-.1,-.1,-.1"
%     char  base "RSMH=1.6,1.6,1.6 EH=-.1,-.1,-.1"
%     ifdef gwbas & bigbas
%       char  basc "RSMH=1.4,1.4,1.4,1.4 EH=-.2,-.2,-.2,-.2 RSMH2=1.8,1.8 EH2=-1.2,-1.2"
%       char  basa "RSMH=0.9,0.9,0.9,0.9 EH=-.2,-.2,-.2,-.2 RSMH2=1.1,1.1 EH2=-1.2,-1.2"
%       char  base "RSMH=1.6,1.6,1.6 EH=-.2,-.2,-.2"
%     elseifd bigbas
%       char  basc "RSMH=1.4,1.4,1.4,1.4 EH=-.1,-.1,-.1,-.1 RSMH2=1.8,1.8 EH2=-1.2,-1.2"
%       char  basa "RSMH=0.9,0.9,0.9,0.9 EH=-.1,-.1,-.1,-.1 RSMH2=1.1,1.1 EH2=-1.2,-1.2"
%     elseifd gwbas
%       stop 1 "no gwbas without bigbas"
%   endif
%   endif
% elseifd cmpd=='GeC'
%   const tpan=t metal=f azb=8.6
% elseifd cmpd=='SiGe'
%   const tpan=t metal=f azb=10.44 gmax=9
%   char  strnc          "P={pval(tpsc,3.75,2.95,3.5)},{pval(tppc,3.55,3.55,3.55)},{pval(tpdc,3.25,0,3.20)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,2.95,4.5)},{ploc(tppc,0,2.95,4.5)},{ploc(tpdc,0,0,4.2)} IDMOD=0,0,1,1,1"
%   char  strna          "P={pval(tpsa,0,3.95,5.5)},{pval(tppa,0,3.95,5.5)},{pval(tpda,4.3,3.93,4.3)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,3.95,5.5)},{ploc(tppa,0,3.95,5.5)},{ploc(tpda,4.3,3.93,4.3)}"
%   char  strna "{strna} IDMOD=0,0,{tpda==0?1:0},1,1 RS3=.9"
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.4,1.4,1.4,{lfc?1.4:0},{lgc?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}
%     char  basc "{basc} RSMH2=1.4,{tppc==2?.75:1.4},{bigbas>11?1.4:0},{bigbas>12?1.4:0} EH2=-1.2,-1.2,-1.2,-1.2"
%     char  basa "RSMH=1.4,1.4,1.4,{lfa?1.4:0},{lgc?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}
%     char  basa "{basa} RSMH2=1.4,{tppc==2?.75:1.4},{(tpdc==2|tpdc==4)?0.9:{bigbas>11?1.4:0}},{bigbas>12?1.4:0}"
%     char  basa "{basa} EH2={ehmax-.8},{ehmax-.8},{ehmax-((tpdc==2|tpdc==4)?1.5:.8)},{ehmax-.8}"
%     char  base "RSMH=1.4,1.4,1.4,1.4 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseif bigbas
%     char  basc "RSMH=1.4,1.4,1.4,{lfc?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.8,1.8 EH2=-1.2,-1.2"
%     char  basa "RSMH=1.4,1.4,1.4,{lfa?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.8,1.8 EH2=-1.2,-1.2"
%     char  base "RSMH=1.4,1.4,1.4,1.4 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     char  basc "RSMH=1.4,1.4,1.4,{lfc?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax}
%     char  basa "RSMH=1.4,1.4,1.4,{lfa?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax}
%     char  base "RSMH=1.4,1.4,1.4,1.4 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}
%   endif
% elseifd cmpd=='Si2GeC'
%   const tpan=t metal=f azb=9.28 Zb=32
% elseifd cmpd=='BP'
%   const tpan=f metal=f azb=4.538/.529
#   (basis was adapted from AlP,GaP)
%   char  strnc          "P={pval(tpsc,0,0,2.5)},{pval(tppc,0,0,2.55)},{pval(tpdc,3.3,0,3.3)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,0,3.5)},{ploc(tppc,0,0,3.5)},{ploc(tpdc,0,0,0)} IDMOD=0,0,1,1,1"
%   char  strna "P={pval(tpsa,0,3.85,4.5)},{pval(tppa,0,3.7,4.5)},{pval(tpda,3.3,3.3,4.4)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,3.85,4.5)},{ploc(tppa,0,3.7,4.5)},{ploc(tpda,3.3,3.3,4.4)} IDMOD=0,0,1,1,1"
%   ifdef f
%   elseifd asa
%   elseifd lmf
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.2,1.2,1.2,{lfc?1.2:0},{lgc?1.2:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef f
%     elseif bigbas==11
%     char  basc "{basc} RSMH2=1.2,0,1.2 EH2={-1.3},{-1.3},{-1.3} RS3=.95"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.2,1.2,1.2 EH2={-1.1},{-1.1},{-1.1} RS3=.95"
%     elseif bigbas==13
%     char  basc "{basc} RSMH2=1.2,1.2,1.2,1.2 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.95"
%     endif
%     char  basa "RSMH=1.3,1.3,1.3,{lfa?1.3:0},{lga?1.3:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     ifdef bigbas==13
%     char  basa "{basa} RSMH2=1.3,1.3,{tpda==2?1:1.3},1.4 EH2=-1.3,{ehmax-.8},{ehmax-.8},{ehmax-.8}"
%     else
%     char  basa "{basa} RSMH2=1.3,1.3,{tpda==2?1:1.3} EH2=-1.3,-1.1,-1.1"
%     endif
%     char  base "RSMH=1.3,1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas
%     char  basc "RSMH=1.2,1.2,1.2,1.2 EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.2,0,0,0 EH2=-1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.3,1.3 EH2=-1.1,-1.1"
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     char  basc "RSMH=1.2,1.2,1.2 EH=-.7,{ehmax},{ehmax},{ehmax}"
%     char  basa "RSMH=1.3,1.3,1.3 EH=-.7,{ehmax},{ehmax},{ehmax}"
%     char  base "RSMH=1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   endif
%   endif
% elseifd cmpd=='AlP'
#   (basis was chosen by taking cation data from AlAs, anion from GaP)
%   const tpan=f metal=f azb=10.33
%   ifdef f
%   elseifd asa
%   elseifd lmf
%   char0 strnc "P=0,0,3.30 IDMOD=0,0,1"
%   char0 strna "P=0,0,3.30 IDMOD=0,0,1"
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.6,1.6,1.6,{lfc?1.6:0},{lgc?1.6:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef f
%     elseif bigbas==11
%     char  basc "{basc} RSMH2=1.3,0,1.3 EH2={-1.3},{-1.3},{-1.3} RS3=.95"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.3,1.3,1.3 EH2={-1.1},{-1.1},{-1.1} RS3=.95"
%     elseif bigbas==13
%     char  basc "{basc} RSMH2=1.3,1.3,1.3,1.3 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.95"
%     endif
%     char  basa "RSMH=1.3,1.3,1.3,{lfa?1.3:0},{lga?1.3:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     ifdef bigbas==13
%     char  basa "{basa} RSMH2=1.3,1.3,{tpda==2?1:1.3},1.4 EH2=-1.3,{ehmax-.8},{ehmax-.8},{ehmax-.8}"
%     else
%     char  basa "{basa} RSMH2=1.3,1.3,{tpda==2?1:1.3} EH2=-1.3,-1.1,-1.1"
%     endif
%     char  base "RSMH=1.3,1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  strnc "P=0,0,3.30 PZ=4.5,0,0 IDMOD=0,0,1"
%     char  strna "P=0,0,3.30 PZ=4.4,4.5*0 IDMOD=0,0,1"
#   bigbas=6 combines bigbas=3 with local orbitals of bigbas=5
%   elseifd bigbas==6
%     char  basc "RSMH=1.6,1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.6,1.6,1.6 EH2=-1.1,-1.1,-1.1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.3,1.3,1.3 EH2=-1.3,-1.1,-1.1"
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  strnc "P=0,0,3.30 PZ=4.5,0,0 IDMOD=0,0,1"
%     char  strna "P=0,0,3.30 PZ=4.4,4.5*0 IDMOD=0,0,1"
%   elseifd bigbas==5
%     char  basc "RSMH=1.6,1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.6,1.6,1.6,1.6 EH2=-1.1,-1.1,-1.1,-1.1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.3,1.3,1.3,1.3 EH2=-1.3,-1.1,-1.1,-1.1"
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  strnc "P=0,0,3.30 PZ=4.5,0,0 IDMOD=0,0,1"
%     char  strna "P=0,0,3.50 PZ=4.5,4.5,4.4 IDMOD=0,0,1"
%   elseifd bigbas==4
%     char  basc "RSMH=1.6,1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.6,1.6,1.6,1.6 EH2=-1.1,-1.1,-1.1,-1.1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.3,1.3,1.3,1.3 EH2=-1.3,-1.1,-1.1,-1.1"
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==3
%     char  basc "RSMH=1.6,1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.6,1.6,1.6 EH2=-1.1,-1.1,-1.1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.3,1.3,1.3 EH2=-1.3,-1.1,-1.1"
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==2
%     char  basc "RSMH=1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.6,1.6,1.6,0 EH2=-1,-1,-1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.3,1.3,1.3 EH2=-1.1,-1.1,-1.1"
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas
%     char  basc "RSMH=1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.6,0,0,0 EH2=-1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.3,1.3 EH2=-1.1,-1.1"
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     char  basc "RSMH=1.6,1.6,1.6 EH=-.3,{ehmax},{ehmax},{ehmax}"
%     char  basa "RSMH=1.3,1.3,1.3 EH=-.7,{ehmax},{ehmax},{ehmax}"
%     char  base "RSMH=1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   endif
%   endif
% elseifd cmpd=='GaP'
%   const tpan=f metal=f azb=10.29 gmax=10
%   char  strnc "P={pval(tpsc,0,3.94,5.5)},{pval(tppc,0,3.93,5.5)},{pval(tpdc,4.3,3.93,4.3)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,3.93,5.5)},{ploc(tppc,0,3.93,5.5)},{ploc(tpdc,4.3,3.93,4.3)}"
%   char  strna "P={pval(tpsa,0,3.85,4.5)},{pval(tppa,0,3.7,4.5)},{pval(tpda,3.3,3.3,4.4)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,3.85,4.5)},{ploc(tppa,0,3.7,4.5)},{ploc(tpda,3.3,3.3,4.4)} IDMOD=0,0,1,1,1"
%   ifdef f
#   Patterned after GaAs bigbas11
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.4,1.4,1.4,{lfc?1.4:0},{lgc?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef bigbas==11
%     char  basc "{basc} RSMH2=1.4,0,{tpdc==3?0:0.9} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.90"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.4,1.4,{tpdc==3?1.4:0.9} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.90"
%     endif
%     char  basa "RSMH=1.3,1.3,1.3,{lfa?1.3:0},{lga?1.3:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     char  basa "{basa} RSMH2=1.3,1.3,1.5 EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.3,1.3,1.3,1.3*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
#   bigbas=6 combines bigbas=3 with local orbitals of bigbas=5
%   elseifd bigbas==6&(tpdc==1|tpdc==2|tpdc==4)
%     char  basc "RSMH=1.4,1.4,1.4,1.4,1.4 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.4,1.4,0.9,0 EH2=-1,-1,-1,-1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.3,1.3,1.3,0 EH2=-1,-1,-1,-1"
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef tpdc==1 | tpdc==4
%       char  strnc "PZ=0,0,4.30 IDMOD=0,0,1 P=0,0,3.9"
%     elseifd tpdc==2
%       char  strnc "P=0,0,4.30 IDMOD=0,0,1 PZ=0,0,3.9"
%     endif
%     char  strna "P=0,0,3.30 IDMOD=0,0,1 PZ=4.5,4.5,4.4"
# %   elseifd bigbas==5&(tpdc==1|tpdc==2|tpdc==4)
# %     char  basc  "RSMH=1.4,1.4,1.4,1.4,1.4 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
# %     char  basc  "{basc} RSMH2=1.4,1.4,0.9,1.4 EH2=-1,-1,-1,-1"
# %     char  basa  "RSMH=1.3,1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
# %     char  basa  "{basa} RSMH2=1.3,1.3,1.3,1.3 EH2=-1,-1,-1,-1"
# %     char  base  "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
# %     char  strnc "P=0,0,4.30 IDMOD=0,0,1 PZ=5.5,5.5*0,3.9"
# %     char  strna "P=0,0,3.50 IDMOD=0,0,1 PZ=4.5,4.5,4.4"
%   elseifd gwbas&bigbas==5&(tpdc==1|tpdc==2|tpdc==4)
%     char  basc "RSMH=1.4,1.4,0.9,1.4,1.4 EH=-.3,-.3,-.3,-.3,-.3 RSMH2=1.4,1.4,0.9,1.4 EH2=-1,-1,-1,-1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3,1.3 EH=-.3,-.3,-.3,-.3,-.3 RSMH2=1.3,1.3,1.3,1.3 EH2=-1,-1,-1,-1"
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH=-.3,-.3,-.3,-.3"
%     char  strnc "P=0,0,4.30 IDMOD=0,0,1 PZ=5.5,5.5*0,3.9"
%     char  strna "P=0,0,3.50 IDMOD=0,0,1 PZ=4.5,4.5,4.4"
%   elseifd gwbas&bigbas==4&(tpdc==1|tpdc==2|tpdc==4)
%     char  basc "RSMH=1.4,1.4,0.9,1.4,1.4 EH=-.3,-.3,-.3,-.3,-.3 RSMH2=1.4,1.4,0.9,1.4 EH2=-1,-1,-1,-1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3,1.3 EH=-.3,-.3,-.3,-.3,-.3 RSMH2=1.3,1.3,1.3,1.3 EH2=-1,-1,-1,-1"
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH=-.3,-.3,-.3,-.3"
%   elseifd bigbas==3&(tpdc==1|tpdc==2|tpdc==4)
%     char  basc "RSMH=1.4,1.4,1.4,1.4,1.4 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.4,1.4,0.9,0 EH2=-1,-1,-1,-1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.3,1.3,1.3,0 EH2=-1,-1,-1,-1"
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd gwbas&bigbas==2&(tpdc==1|tpdc==2|tpdc==4)
%     char  basc "RSMH=1.4,1.4,0.9,1.4 EH=-.3,-.3,-.3,-.3,-.3 RSMH2=1.4,1.4,0.9 EH2=-1,-1,-1,-1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3 EH=-.3,-.3,-.3,-.3,-.3 RSMH2=1.3,1.3,1.3 EH2=-1,-1,-1,-1"
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH=-.3,-.3,-.3,-.3"
%   elseifd gwbas&bigbas&(tpdc==1|tpdc==2|tpdc==4)
%     char  basc "RSMH=1.4,1.4,0.9,1.4 EH=-.3,-.3,-.3,-.3 RSMH2=1.4,1.4,.9 EH2=-1,-1,-1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3 EH=-.3,-.3,-.3,-.3 RSMH2=1.3,1.3,0,0 EH2=-1,-1"
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH=-.3,-.3,-.3,-.3"
%   elseifd gwbas
%     stop 1 'basis not built for this case'
%   elseifd bigbas==2&(tpdc==1|tpdc==2|tpdc==4)
%     char  basc "RSMH=1.4,1.4,0.9,1.4 EH=-.1,-.1,-.3,-.1 RSMH2=1.4,1.4,.9 EH2=-1,-1,-1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3 EH=-.1,-.1,-.1,-.1 RSMH2=1.3,1.3,1.3,0 EH2=-1,-1,-1"
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH=-.2,-.2,-.2,-.2 RSMH2=1.3,1.3,0 EH2=-1.2,-1.2,-1"
%   elseifd bigbas&(tpdc==1|tpdc==2|tpdc==4)
%     const ngd=24
%     char  basc "RSMH=1.4,1.4,0.9,1.4 EH=-.1,-.1,-.3,-.1 RSMH2=1.4,1.4,.9 EH2=-1,-1,-1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3 EH=-.1,-.1,-.1,-.1 RSMH2=1.3,1.3,0,0 EH2=-1,-1"
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH=-.2,-.2,-.2,-.2"
%   elseifd bigbas
%     char  basc "RSMH=1.4,1.4,1.4,1.4 EH=-.1,-.1,-.1,-.1 RSMH2=1.2,1.2,0,0 EH2=-1,-1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3 EH=-.1,-.1,-.1,-.1 RSMH2=1.2,1.2,0,0 EH2=-1,-1"
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH=-.1,-.1,-.1,-.1"
%   elseifd tpdc>1
%     stop 1 'basis not built for this case'
%   elseifd tpdc==1
%     char  basc "RSMH=1.4,1.4,0.8,1.4 EH=-.7,-.1,-.8,-.1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3 EH=-.7,-.1,-.1,-.1"
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH=-.2,-.2,-.2,-.2"
%   else
%     char  basc "RSMH=1.4,1.4,1.4,1.4 EH=-.7,-.1,-.1,-.1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3 EH=-.7,-.1,-.1,-.1"
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH=-.2,-.2,-.2,-.2"
%   endif
# Mn impurity
#%     char  basb "RSMH=2.1,2.1,1.0,2.1 EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=2.1,2.1,1.0 EH2=-1.0,-1.0,-1.0"
#%     char  strnb "MMOM=0,0,3"
% elseifd cmpd=='InP'
%   const tpan=f metal=f azb=11.09 elind=-.7
%   char  strnc "P={pval(tpsc,0,4.94,6.5)},{pval(tppc,0,4.93,6.5)},{pval(tpdc,4.93,4.93,5.4)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,4.94,6.5)},{ploc(tppc,0,4.93,6.5)},{ploc(tpdc,0,4.93,5.4)} IDMOD=0,0,0,1,1"
%   char  strna "P={pval(tpsa,0,3.85,4.5)},{pval(tppa,0,3.7,4.5)},{pval(tpda,3.3,3.3,4.4)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,3.85,4.5)},{ploc(tppa,0,3.7,4.5)},{ploc(tpda,3.3,3.3,4.4)} IDMOD=0,0,1,1,1"
%   const ngd=24
%   ifdef lmf
%   ifdef f
#   Patterned after GaAs bigbas11
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.6,1.6,1.6,{lfc?1.6:0},{lgc?1.6:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef bigbas==11
%     char  basc "{basc} RSMH2=1.6,0,{tpdc==3?0:1.0} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.95"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.6,1.6,{tpdc==3?1.6:1.0} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.95"
%     endif
%     char  basa "RSMH=1.3,1.3,1.3,{lfa?1.3:0},{lga?1.3:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     char  basa "{basa} RSMH2=1.3,1.3,1.3 EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.5,1.5,1.5,1.5*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
#   bigbas=6 combines bigbas=3 with local orbitals of bigbas=5
%   elseifd bigbas==6&(tpdc==1|tpdc==2|tpdc==4)
%     char  basc  "RSMH=1.6,1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc  "{basc} RSMH2=1.6,1.6,1 EH2=-1,-1,-1,-2"
%     char  basa  "RSMH=1.3,1.3,1.3,1.3,1.3 EH=-.6,{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa  "{basa} RSMH2=1.3,1.3,1.3 EH2=-1.3,-1.1,-1.1,-1.1"
%     char  base  "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef tpdc==1 | tpdc==4
%       char  strnc "PZ=6.5,0*6.5,5.5"
%     elseifd tpdc==2
%       char  strnc "P=0,0,5.3 PZ=6.5,0*6.5,4.9"
%     endif
%     char  strna "P=0,0,3.30 PZ=4.5,4.5,4.5*0 IDMOD=0,0,1,1,1"
%   elseifd bigbas==5&(tpdc==1|tpdc==2|tpdc==4)
%     char  basc  "RSMH=1.6,1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc  "{basc} RSMH2=1.6,1.6,1,1.6 EH2=-1,-1,-1,-2"
%     char  basa  "RSMH=1.3,1.3,1.3,1.3,1.3 EH=-.6,{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa  "{basa} RSMH2=1.3,1.3,1.3,1.3*0 EH2=-1.3,-1.1,-1.1,-1.1"
%     char  base  "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef tpdc==1 | tpdc==4
%       char  strnc "PZ=6.5,0*6.5,5.5"
%     elseifd tpdc==2
%       char  strnc "P=0,0,5.3 PZ=6.5,0*6.5,4.9"
%     endif
%     char  strna "P=0,0,3.30 PZ=4.5,4.5,4.5*0 IDMOD=0,0,1,1,1"
%   elseifd bigbas==4&(tpdc==1|tpdc==2|tpdc==4)
%     char  basc  "RSMH=1.6,1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc  "{basc} RSMH2=1.6,1.6,1,1.6 EH2=-1,-1,-1,-2"
%     char  basa  "RSMH=1.3,1.3,1.3,1.3,1.3 EH=-.6,{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa  "{basa} RSMH2=1.3,1.3,1.3,1.3*0 EH2=-1.3,-1.1,-1.1,-1.1"
%     char  base  "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==3&(tpdc==1|tpdc==2|tpdc==4)
%     char  basc  "RSMH=1.6,1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc  "{basc} RSMH2=1.6,1.6,1 EH2=-1,-1,-1,-2"
%     char  basa  "RSMH=1.3,1.3,1.3,1.3,1.3 EH=-.6,{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa  "{basa} RSMH2=1.3,1.3,1.3 EH2=-1.3,-1.1,-1.1,-1.1"
%     char  base  "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==2&(tpdc==1|tpdc==2|tpdc==4)
%     char  basc  "RSMH=1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc  "{basc} RSMH2=1.6,1.6,1 EH2=-1,-1,-1,-2"
%     char  basa  "RSMH=1.3,1.3,1.3,1.3 EH=-.6,{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa  "{basa} RSMH2=1.3,1.3,1.3 EH2=-1.3,-1.1,-1.1,-1.1"
%     char  base  "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas&(tpdc==1|tpdc==2|tpdc==4)
%     char  basc  "RSMH=1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc  "{basc} RSMH2=1.6,0,1 EH2=-1,-1,-1,-2"
%     char  basa  "RSMH=1.3,1.3,1.3,1.3 EH=-.6,{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa  "{basa} RSMH2=1.3,1.3 EH2=-1.3,-1.1,-1.1,-1.1"
%     char  base  "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd tpdc==4
%     char  basc "RSMH=1.6,1.6,1.0,1.6 EH=-.1,-.1,-.6,-.1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3 EH=-.6,-.1,-.1,-.1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   elseifd tpdc==1
%     char  basc "RSMH=1.6,1.6,0.9,1.6 EH=-.7,-.1,-.8,-.1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3 EH=-.7,-.1,-.1,-.1"
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH=-.1,-.1,-.1,-.1"
%   elseifd tpdc>0
%     stop 1 basis not built for this case
%   elseifd bigbas
%     char  basc "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1 RSMH2=1.6,1.6 EH2=-1,-1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3 EH=-.1,-.1,-.1,-.1 RSMH2=1.3,1.3 EH2=-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   else
%     char  basc "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3 EH=-.6,-.1,-.1,-.1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   endif
%   endif
% elseifd cmpd=='TlP'
%   const tpan=f metal=t azb=11.09
%   char  linkc "0 0 0 -1.6 -1.6 -.9"  linka "0 0 0 -1.3 -2 -1.3"
% elseifd cmpd=='BAs'
%   const tpan=f metal=f azb=4.777/.5292
#   (basis was adapted from AlAs)
%   char  strnc          "P={pval(tpsc,0,0,2.5)},{pval(tppc,0,0,2.55)},{pval(tpdc,3.3,0,3.3)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,0,3.5)},{ploc(tppc,0,0,3.5)},{ploc(tpdc,0,0,0)} IDMOD=0,0,1,1,1"
%   char  strna "P={pval(tpsa,4.88,4.88,4.88)},{pval(tppa,4.7,4.7,4.7)},{pval(tpda,4.3,3.93,4.3)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,3.95,5.5)},{ploc(tppa,0,3.95,5.5)},{ploc(tpda,0,3.93,4.3)}
%   char  strna "{strna} IDMOD=0,0,{tpda==0?1:0},1,1"
%   ifdef tppc==2 | tpda==2 | tpda==3
%   const ngd=20
%   endif
%   const ngd=16
%   ifdef f
%   elseifd asa
%   elseifd lmf
%     ifdef f
#     Patterned after bigbas11 in InAs, GaAs
%     elseifd bigbas==11 | bigbas==12
%       char  basc "RSMH=1.2,1.2,1.2,{lfc?1.2:0},{lgc?1.2:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%       ifdef bigbas==11&tpdc<>2
%       char  basc "{basc} RSMH2=1.2,0,0 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3==.9"
%       elseif bigbas==11
%       char  basc "{basc} RSMH2=1.2,0,0 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%       elseif bigbas==12
%       char  basc "{basc} RSMH2=1.2,1.2,1.2 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%       endif
%       char  basa "RSMH=1.4,1.4,1.4,{lfa?1.4:0},{lga?1.4:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax}"
%       char  basa "{basa} RSMH2=1.4,1.4,1.4 EH2=-1.4,{ehmax-.8},{ehmax-.8} RS3=.9"
%       char  base "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     elseifd bigbas
%       char  basc "RSMH=1.2,1.2,1.2,1.2 EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.2,0,0,0 EH2=-1"
%       char  basa "RSMH=1.4,1.4,1.4,1.4 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.4,1.4 EH2=-1.1,-1.1"
%       char  base "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     else
%       char  basc "RSMH=1.2,1.2,1.2 EH=-1.2,{ehmax},{ehmax},{ehmax}"
%       char  basa "RSMH=1.4,1.4,1.4 EH=-.7,{ehmax},{ehmax},{ehmax}  RS3=.9"
%       char  base "RSMH=1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     endif
%   endif
% elseifd cmpd=='AlAs'
%   const tpan=f metal=f azb=10.69
%   char  strnc          "P={pval(tpsc,0,2.95,3.5)},{pval(tppc,0,2.95,3.55)},{pval(tpdc,3.3,0,3.3)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,2.95,4.5)},{ploc(tppc,0,2.95,4.5)},{ploc(tpdc,0,0,4.2)} IDMOD=0,0,1,1,1"
%   char  strna "P={pval(tpsa,4.88,4.88,4.88)},{pval(tppa,4.7,4.7,4.7)},{pval(tpda,4.3,3.94,4.3)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,3.95,5.5)},{ploc(tppa,0,3.95,5.5)},{ploc(tpda,0,3.94,4.3)}
%   char  strna "{strna} IDMOD=0,0,{tpda==0?1:0},1,1"
%   ifdef tppc==2 | tpda==2 | tpda==3
%   const ngd=20
%   endif
%   const ngd=16
%   ifdef f
%   elseifd asa
%   elseifd lmf
%     ifdef f
#     Patterned after bigbas11 in InAs, GaAs
%     elseifd bigbas==11 | bigbas==12
%       char  basc "RSMH=1.6,1.6,1.6,{lfc?1.6:0},{lgc?1.6:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%       ifdef bigbas==11&tpdc<>2
%       char  basc "{basc} RSMH2=1.6,0,0 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3==1"
%       elseif bigbas==11
%       char  basc "{basc} RSMH2=1.5,0,0 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%       elseif bigbas==12
%       char  basc "{basc} RSMH2=1.5,1.5,1.5 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%       endif
%       char  basa "RSMH=1.3,1.3,1.3,{lfa?1.3:0},{lga?1.3:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax}"
%       char  basa "{basa} RSMH2=1.3,1.3,1.3 EH2=-1.3,{ehmax-.8},{ehmax-.8} RS3=.95"
%       char  base "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
#     bigbas=6 combines bigbas=3 with local orbitals of bigbas=5
%     elseifd bigbas==6
%       char  basc "RSMH=1.6,1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%       char  basc "{basc} RSMH2=1.6,1.6,1.6 EH2=-1.1,-1.1,-1.1"
%       char  basa "RSMH=1.3,1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%       char  basa "{basa} RSMH2=1.3,1.3,1.3 EH2=-1.1,-1.1,-1.1"
%       char  base "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%       char  strnc "P=0,0,3.30 PZ=4.5,0,0 IDMOD=0,0,1"
%       char  strna "P=0,0,4.30 PZ=5.5,5.5,0 IDMOD=0,0,1"
%     elseifd bigbas==5
%       char  basc "RSMH=1.6,1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%       char  basc "{basc} RSMH2=1.6,1.6,1.6,1.6 EH2=-1.1,-1.1,-1.1,-1.1"
%       char  basa "RSMH=1.3,1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%       char  basa "{basa} RSMH2=1.3,1.3,1.3,1.3 EH2=-1.1,-1.1,-1.1,-1.1"
%       char  base "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%       char  strnc "P=0,0,3.30 PZ=4.5,0,0 IDMOD=0,0,1"
%       char  strna "P=0,0,4.30 PZ=5.5,5.5,0 IDMOD=0,0,1"
%     elseifd bigbas==4
%       char  basc "RSMH=1.6,1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%       char  basc "{basc} RSMH2=1.6,1.6,1.6,1.6 EH2=-1.1,-1.1,-1.1,-1.1"
%       char  basa "RSMH=1.3,1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%       char  basa "{basa} RSMH2=1.3,1.3,1.3,1.3 EH2=-1.1,-1.1,-1.1,-1.1"
%       char  base "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     elseifd bigbas==3
%       char  basc "RSMH=1.6,1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%       char  basc "{basc} RSMH2=1.6,1.6,1.6 EH2=-1.1,-1.1,-1.1"
%       char  basa "RSMH=1.3,1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%       char  basa "{basa} RSMH2=1.3,1.3,1.3 EH2=-1.1,-1.1,-1.1"
%       char  base "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     elseifd bigbas==2
%       char  basc "RSMH=1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.6,1.6,1.6,0 EH2=-1,-1,-1"
%       char  basa "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.3,1.3,1.3 EH2=-1.1,-1.1,-1.1"
%       char  base "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     elseifd bigbas
%       char  basc "RSMH=1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.6,0,0,0 EH2=-1"
%       char  basa "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.3,1.3 EH2=-1.1,-1.1"
%       char  base "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     else
%       char  basc "RSMH=1.6,1.6,1.6 EH=-.3,{ehmax},{ehmax},{ehmax}"
%       char  basa "RSMH=1.3,1.3,1.3 EH=-.7,{ehmax},{ehmax},{ehmax}"
%       char  base "RSMH=1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     endif
%   endif
% elseifd cmpd=='CrN' | cmpd=='MnN'
# for ZB phase, assume lattice constant of AlN
%   const tpan=t metal=t azb=4.38/.529 gmax=8.5
%   char  strnc "P={pval(tpsc,0,3.94,5.5)},{pval(tppc,0,3.93,4.6)},3.85,4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,3.93,5.5)},{ploc(tppc,0,3.93,5.5)},{ploc(tpdc,0,3.85,4.5)}"
%   char  strnc "{strnc} IDMOD=0,0,{tpdc==0?1:0},1,1"
%   char  strnc "{strnc} MMOM=0,0,3"
%   char  strna "P={pval(tpsa,0,2.83,3.5)},{pval(tppa,0,2.70,3.5)},3.25,4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,2.83,3.5)},{ploc(tppa,0,2.70,3.5)},0 IDMOD=0,0,1,1,1"
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=2.0,2.0,1.0,{lfc?1.4:0},{lgc?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef bigbas==11
%     char  basc "{basc} RSMH2=1.6,0,{tpdc==3?0:1.0} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.95"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.6,1.6,{tpdc==3?1.6:1.0} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.95"
%     endif
%     char  basa "RSMH=1,1,1,{lfa?1:0},{lga?1:0} EH={tpsa==3?ehmax:-.6},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1,1,1 EH2={tpsa==3?ehmax-.8:-1.4},{ehmax-.8},{ehmax-.8} RS3=.9"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     stop 1 Basis not defined for CrN
%   endif
% elseifd cmpd=='MnP' | cmpd=='CrP'
# for ZB phase, assume lattice constant of GaP
%   const tpan=f metal=t azb=10.29 gmax=8
%   char  strnc "P={pval(tpsc,0,3.94,5.5)},{pval(tppc,0,3.93,4.6)},3.85,4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,3.93,5.5)},{ploc(tppc,0,3.93,5.5)},{ploc(tpdc,0,3.85,4.5)}"
%   char  strnc "{strnc} IDMOD=0,0,{tpdc==0?1:0},1,1"
%   char  strnc "{strnc} MMOM=0,0,3 RS3=0.9"
%   char  strna "P={pval(tpsa,0,3.85,4.5)},{pval(tppa,0,3.7,4.5)},{pval(tpda,3.3,3.3,4.4)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,3.85,4.5)},{ploc(tppa,0,3.7,4.5)},{ploc(tpda,3.3,3.3,4.4)} IDMOD=0,0,1,1,1"
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=2.0,2.0,1.0,{lfc?1.4:0},{lgc?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef bigbas==11
%     char  basc "{basc} RSMH2=1.6,0,{tpdc==3?0:1.0} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.6,1.6,{tpdc==3?1.6:1.0} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     endif
%     char  basa "RSMH=1.3,1.3,1.3,{lfa?1.3:0},{lga?1.3:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     char  basa "{basa} RSMH2=1.3,1.3,1.5 EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.3,1.3,1.3,1.3*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     stop 1 Basis not defined for {cmpd}
%   endif
% elseifd cmpd=='MnAs' | cmpd=='CrAs'
# for NiAs phase : Willis B T M and Rooksby H P 1954 Proc. Phys. Soc. Lond. Ser. B 67 290
# Sanvito and Hill (prb62,15553) quote a=3.7 c=5.7 -> q=1.54
# see also J. Appl. Phys. 79 1435 (1996)  a=3.71 c=5.69
%   const tpan=t metal=t azb=sqrt(2)*3.70/.52918 q=5.70/3.70 gmax=8.5
# for ZB phase, assume lattice constant of GaAs
#%   const tpan=t metal=t azb=10.66 gmax=8.5
%   char  strnc "P={pval(tpsc,0,3.94,5.5)},{pval(tppc,0,3.93,4.6)},3.85,4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,3.93,5.5)},{ploc(tppc,0,3.93,5.5)},{ploc(tpdc,0,3.85,4.5)}"
%   char  strnc "{strnc} IDMOD=0,0,{tpdc==0?1:0},1,1"
%   char  strnc "{strnc} MMOM=0,0,3"
%   char  strna "P={pval(tpsa,4.88,4.88,4.88)},{pval(tppa,4.7,4.7,4.7)},{pval(tpda,4.3,3.94,4.3)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,3.95,5.5)},{ploc(tppa,0,3.95,5.5)},{ploc(tpda,0,3.94,4.3)}
%   char  strna "{strna} IDMOD=0,0,{tpda==0?1:0},1,1"
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=2.0,2.0,1.0,{lfc?1.4:0},{lgc?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef bigbas==11
%     char  basc "{basc} RSMH2=1.6,0,{tpdc==3?0:1.0} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.6,1.6,{tpdc==3?1.6:1.0} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     endif
%     char  basa "RSMH=1.4,1.4,1.4,{lfa?1.4:0},{lga?1.4:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     char  basa "{basa} RSMH2=1.4,1.4,1.4 EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.5,1.5,1.5,1.5*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==3
%     char  basc "RSMH=2.1,2.1,1.0,1.4,1.4 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=2.1,2.1,1.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char  basa "RSMH=1.4,1.4,1.4,1.4 EH=-.7,{ehmax},{ehmax},{ehmax} RSMH2=1.4,1.4,1.4 EH2=-1,-1,-1"
%     char  basa "{basa} RSMH2=1.4,1.4,1.4 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char  base "RSMH=1.8,1.8,1.8,1.8 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==2
%     char  basc "RSMH=2.1,2.1,1.0,2.1 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=2.1,2.1,1.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char  basa "RSMH=1.4,1.4,1.4,1.4 EH=-.7,{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.4,1.4,1.4 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char  base "RSMH=1.8,1.8,1.8,1.8 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas
%     char  basc "RSMH=2.1,2.1,1.0,2.1 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=2.1,2.1,1.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char  basa "RSMH=1.4,1.4,1.4,1.4 EH=-.7,{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.4*0,1.4 EH2={ehmax-.9},{ehmax-.9}"
%     char  base "RSMH=1.8,1.8,1.8,1.8 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     char  basc "RSMH=2.1,2.1,1.1,2.1 EH={ehmax},{ehmax},{ehmax},{ehmax} MMOM=0,0,3"
%     char  basa "RSMH=1.4,1.4,1.4,1.4 EH=-.7,{ehmax},{ehmax},{ehmax}"
%     char  base "RSMH=1.8,1.8,1.8,1.8 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   endif
% elseifd cmpd=='NiAs'
%   const tpan=t metal=t azb=sqrt(2)*3.619/.52918 q=5.034/3.619
%   const gmax=9
%   ifdef tpdc==4
%     char0 strnc "PZ=0,0,4.5 MMOM=0,0,3"
%     char0 strna "P=0,0,4.25 IDMOD=0,0,1 PZ=5.5"
%   endif
%   char0 strnc "MMOM=0,0,3"
%   char0 strna "P=0,0,4.25 IDMOD=0,0,1"
%   ifdef f
%   elseifd bigbas==2
%     char  basc "RSMH=2.1,2.1,1.0,2.1 EH=-.1,-.1,-.1,-.1 RSMH2=2.1,2.1,1.0 EH2=-1.0,-1.0,-1.0"
%     char  basa "RSMH=1.4,1.4,1.4,1.4 EH=-.7,-.1,-.1,-.1 RSMH2=1.4,1.4,1.4 EH2=-1,-1,-1"
%     char  base "RSMH=1.8,1.8,1.8,1.8 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas
%     char  basc "RSMH=2.1,2.1,1.0,2.1 EH=-.1,-.1,-.1,-.1 RSMH2=2.1,2.1,1.0 EH2=-1.0,-1.0,-1.0"
%     char  basa "RSMH=1.4,1.4,1.4,1.4 EH=-.7,-.1,-.1,-.1 RSMH2=1.4*0,1.4 EH2=-1,-1"
%     char  base "RSMH=1.4,1.4   EH=-.1,-.1,-.1,-.1"
%   else
%     char  basc "RSMH=2.1,2.1,0.9 EH={ehmax},{ehmax},{ehmax},{ehmax} MMOM=0,0,3"
%     char  basa "RSMH=1.4,1.4,1.4 EH=-.7,{ehmax},{ehmax},{ehmax}"
%     char  base "RSMH=1.4,1.4     EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   endif
% elseifd cmpd=='FeAl'
%   const tpan=t metal=t a=5.496 azb=a*4^(1/3) gmax=9
%   char  strnc "P={pval(tpsc,0,3.94,5.5)},{pval(tppc,0,3.94,4.6)},3.85,4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,3.94,5.5)},{ploc(tppc,0,3.94,5.5)},{ploc(tpdc,0,3.85,4.5)}"
%   char  strnc "{strnc} IDMOD=0,0,{tpdc==0?1:0},1,1"
%   char  strnc "{strnc} MMOM=0,0,.7"
%   char  strna          "P={pval(tpsa,0,2.95,3.5)},{pval(tppa,0,2.95,3.55)},{pval(tpda,3.3,0,3.3)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,2.95,4.5)},{ploc(tppa,0,2.95,4.5)},{ploc(tpda,0,0,4.2)} IDMOD=0,0,1,1,1"
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=2.0,2.0,1.0,{lfc?1.4:0},{lgc?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.6,1.6,{tpdc==3?1.6:1.0} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     char  basa "RSMH=1.6,1.6,1.6,{lfc?1.6:0},{lgc?1.6:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.5,1.5,1.5 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     char  base "RSMH=1.5,1.5,1.5,1.5*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==3
%     char  basc "RSMH=2.1,2.1,1.0,1.4,1.4 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=2.1,2.1,1.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char  basa "RSMH=1.6,1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basc} RSMH2=1.6,1.6,1.6 EH2=-1.1,-1.1,-1.1"
%   elseifd bigbas==2
%     char  basc "RSMH=2.1,2.1,1.0,2.1 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=2.1,2.1,1.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char  basa "RSMH=1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.6,1.6,1.6,0 EH2=-1,-1,-1"
%   elseifd bigbas
%     char  basc "RSMH=2.1,2.1,1.0,{lfc?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=2.1,2.1,1.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char  basa "RSMH=1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.6,0,0,0 EH2=-1"
%   else
%     char  basc "RSMH=2.1,2.1,1.1 EH={ehmax},{ehmax},{ehmax},{ehmax} MMOM=0,0,3"
%     char  basa "RSMH=1.6,1.6,1.6 EH=-.3,{ehmax},{ehmax},{ehmax}"
%     char  base "RSMH=1.8,1.8,1.8,1.8 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   endif
% elseifd cmpd=='LaFeAsO'
%   char  strnc "P={pval(tpsc,6.5,5.95,6.5)},{pval(tppc,6.3,5.93,6.5)},{pval(tpdc,5.3,4.93,5.4)}"
%   char  strnc "{strnc},{pval(tpfc,4.2,4.9,5.5)},5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,6.5,5.95,0.0)},{ploc(tppc,0,5.93,7.5)},0,{ploc(tpfc,4.9,4.9,5.5)}"
%   char  strnc "{strnc} IDMOD=0,{tppc<2|tppc==3?1:0},1,1,1 KMXA=4"
%   char  strnb       "P={pval(tpsb,0,{{pqnsc(Zb)}+1.5},0)}"
%   char  strnb "{strnb},{pval(tppb,0,{{pqnsc(Zb)}+1.3},{{pqnsc(Zb)}+1.35})}"
%   char  strnb "{strnb},{pval(tpdc,{{pqnsc(Zb)}+.7},{{pqnsc(Zb)}+.7},4.4)},4.15,5.12"
%   char  strnb "{strnb} PZ={ploc(tpsb,0,{{pqnsc(Zb)}+.94},{{pqnsc(Zb)}+2.5})}"
%   char  strnb "{strnb},{ploc(tppb,0,{{pqnsc(Zb)}+.94},{{pqnsc(Zb)}+2.5})}"
%   char  strnb "{strnb},{ploc(tpdb,0,0,{{pqnd(Zb)}+1.5})} IDMOD=0,0,0,1,1 RS3=0.8"
%   char  strna "P={pval(tpsa,4.88,4.88,4.88)},{pval(tppa,4.7,4.7,4.7)},{pval(tpda,4.25,4.25,4.25)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,3.95,5.5)},{ploc(tppa,0,3.95,5.5)},{ploc(tpda,0,3.94,5.5)}
%   char  strna "{strna} IDMOD=0,0,1,1,1"
%   char  strnd "P={pval(tpsd,0,2.88,3.5)},{pval(tppd,0,2.70,3.5)},3.25,4.15,5.12"
%   char  strnd "{strnd} PZ={ploc(tpsd,0,2.88,3.5)},{ploc(tppd,0,2.70,3.5)},0 IDMOD=0,0,1,1,1"
%   cchar strne  les>=10 "R=0" 1 " "
%   ifdef f
%   elseifd bigbas==11 | bigbas==12 | bigbas==13
%     char  basc "RSMH=1.8,{tppc==2?1.0:1.7},1.7,1.10,1.4 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.2,{bigbas==11?0:1.2},1.2,1.2 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8},{ehmax-.8}"
%     char  basb "RSMH=2.1,2.1,1.0,{lfb?1.4:0},{lgb?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basb "{basb} RSMH2=1.6,1.6,{tpdb==3?1.6:1.0} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     char  basd "RSMH=1,1,1.6,{lfd?1.6:0} EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basd "{basd} RSMH2=1,1,1 EH2={tpsd==3?ehmax-.8:-1.4},{ehmax-.8},{ehmax-.8} RS3=.9"
%     char  basa "RSMH=1.4,1.4,1.4,{lfa?1.4:0},{lga?1.4:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     ifdef bigbas==13
%     char  basa "{basa} RSMH2=1.3,1.3,{tpda==2?1:1.3},1.3 EH2=-1.3,{ehmax-.8},{ehmax-.8},{ehmax-.8}"
%     else
%     char  basa "{basa} RSMH2=1.3,1.3,{tpda==2?1:1.3} EH2=-1.3,-1.1,-1.1"
%     endif
%     char  base "RSMH=1.2,1.2,1.2,1.2*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==3
%     char  basb "RSMH=2.1,2.1,1.0,1.4,1.4 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basb "{basb} RSMH2=2.1,2.1,1.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char  basa "RSMH=1.4,1.4,1.4,{lfa?1.4:0},{lga?1.4:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     char  basa "{basa} RSMH2=1.3,1.3,{tpda==2?1:1.3} EH2=-1.3,-1.1,-1.1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==2
%     char  basc "RSMH=1.8,{tppc==2?1.0:1.7},1.7,1.10 EH= {ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.2,1.1,1.2,1.2 EH2=-1,{tppc==2?-1.5:ehmax-.9},-1,-1"
%     char  basb "RSMH=2.1,2.1,1.0,2.1 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basb "{basb} RSMH2=2.1,2.1,1.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char  basa "RSMH=1.4,1.4,1.4,1.4 EH=-.6,{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.3,1.3,1.3 EH2=-1.3,-1.1,-1.1,-1.1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basd "RSMH=1.0,1.0,1.6 EH={ehmax},{ehmax},{ehmax}"
%     char  basd "{basd} RSMH2=1.0,1.0,1.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char  base "RSMH=1.2,1.2,1.2,1.2*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas
%     char  basc "RSMH=1.8,{tppc==2?1.0:1.7},1.7,1.10 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.2,0,1.2,1.2 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8},{ehmax-.8}"
%     char  basb "RSMH=2.1,2.1,1.0,{lfb?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basb "{basb} RSMH2=2.1,2.1,1.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char  basa "RSMH=1.4,1.4,1.4,1.4 EH=-.6,{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.3,1.3 EH2=-1.3,-1.1,-1.1,-1.1"
%     char  basd "RSMH=1.0,1.0,1.6 EH={ehmax},{ehmax},{ehmax}"
%     char  basd "{basd} RSMH2=1.0,1.0,0.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char  base "RSMH=1.2,1.2,1.2,1.2*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     char  basc "RSMH=1.8,{tppc==2?1.0:1.7},1.7,1.10 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basb "RSMH=1.8,2.1,1.1 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "RSMH=1.4,1.4,1.4,1.4 EH=-.6,-.1,-.1,-.1"
%     char  basd "RSMH=0.9,1.1,1.6 EH=-0.6,{ehmax},{ehmax}"
%     char  base "RSMH=1.2,1.2,1.2*0,1.2*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   endif
% elseifd cmpd=='GaAs' | cmpd=='GeGaAs'
%   const tpan=t metal=f azb=10.66
%   char  strnc "P={pval(tpsc,0,3.94,5.5)},{pval(tppc,0,3.93,5.5)},{pval(tpdc,4.3,3.93,4.3)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,3.93,5.5)},{ploc(tppc,0,3.93,5.5)},{ploc(tpdc,4.3,3.93,4.3)}"
%   char  strnc "{strnc} IDMOD=0,0,{tpdc==0?1:0},1,1"
%   char  strna "P={pval(tpsa,4.88,4.88,4.88)},{pval(tppa,4.7,4.7,4.7)},{pval(tpda,4.25,4.25,4.25)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,3.95,5.5)},{ploc(tppa,0,3.95,5.5)},{ploc(tpda,0,3.94,5.5)}
%   char  strna "{strna} IDMOD=0,0,{tpda<>3?1:0},1,1"
%   ifdef cmpd=='GeGaAs'
%     char  strnb          "P={pval(tpsc,0,3.95,5.5)},{pval(tppc,0,3.95,5.5)},{pval(tpdc,4.3,3.93,4.3)},4.15,5.12"
%     char  strnb "{strnb} PZ={ploc(tpsc,0,3.95,5.5)},{ploc(tppc,0,3.95,5.5)},{ploc(tpdc,4.3,3.93,4.3)}"
%     char  strnb "{strnb} IDMOD=0,0,{tpdc==0?1:0},1,1"
%     ifdef tppc==2 | tppc==3
%       char  strnb "{strnb} Q=4,0,0 RS3=.90"
%     endif
%     ifdef tpdc==3
%       char  strnb "{strnb} RS3=.90"
%     endif
%   endif
%
# %   ifdef asa
# %     char  strnc "{strnc} IDXDN=1,1,2"
# %     char  strna "{strna} IDXDN=1,1,2"
# %     char  strnec "IDXDN=1,1,2"
# %     char  strnea "IDXDN=1,1,2"
# %   endif
%   ifdef tpdc>0
%     const ngd=24
%   elseifd nelt==3&tpdb>0
%     const ngd=24
%   else
%     const ngd=16
%   endif
%   ifdef gwbas
%     const ehmax=-.3
%   else
%     const ehmax=-.1
%   endif
%   ifdef f
%   elseifd bigbas==11 | bigbas==12 | bigbas==13
%     char  basc "RSMH=1.6,1.6,1.6,{lfc?1.6:0},{lgc?1.6:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef f
%     elseif bigbas==11
%     char  basc "{basc} RSMH2=1.3,0,{tpdc==3?0:0.9} EH2={-1.3},{-1.3},{-1.3} RS3=.95"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.3,1.3,{tpdc==3?1.3:0.9} EH2={-1.1},{-1.1},{-1.1} RS3=.95"
%     elseif bigbas==13
%     char  basc "{basc} RSMH2=1.3,1.3,{tpdc==3?1.3:0.9},1.3 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.95"
%     endif
%     ifdef cmpd=='GeGaAs'
%     char  basb "RSMH=1.4,1.4,1.4,{lfc?1.4:0},{lgc?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     const lfc=0 lgb=0
%     ifdef f
%     elseifd bigbas>10
%       char  basb "RSMH=1.4,1.4,1.4,1.4,{lgb?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}
%       char  basb "{basb} RSMH2=1.4,1.4,{(tpdb==2|tpdb==4)?0.9:{bigbas>11?1.4:0}},{bigbas>12?1.4:0}"
%       char  basb "{basb} EH2={ehmax-.8},{ehmax-.8},{ehmax-((tpdb==2|tpdb==4)?1.5:.8)},{ehmax-.8}"
%     endif
%     endif
%     char  basa "RSMH=1.3,1.3,1.3,{lfa?1.3:0},{lga?1.3:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     ifdef bigbas==13
%     char  basa "{basa} RSMH2=1.3,1.3,{tpda==2?1:1.3},1.4 EH2=-1.3,{ehmax-.8},{ehmax-.8},{ehmax-.8}"
%     else
%     char  basa "{basa} RSMH2=1.3,1.3,{tpda==2?1:1.3} EH2=-1.3,-1.1,-1.1"
%     endif
%     char  base "RSMH=1.5,1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
# %     char  strnc "P=0,0,4.30,4.15,5.12 IDMOD=0 0 0 1 1 PZ={tpsc==4?5.5:0},{tppc==4?5.5:0},{tpdc==3?13.93:0}"
# %     char  strna "P=0,0,4.30,4.15,5.12 IDMOD=0 0 0 1 1
# %     char  strna "{strna} PZ={tpsa==4?5.5:0},{tppa==4?5.5:0},{tpda==2?3.94:{tpda==3?13.94:0}}"
%     ifdef tppc==2
%     char  basc "RSMH=1.6,1.6,1.6,{lfc?1.6:0},{lgc?1.6:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.3,1.3,1.3*0 EH2=-1.1,-1.1,-1.1 RS3=.90 FOCA=0"
%     char  basa "RSMH=1.3,1.3,1.3,{lfa?1.3:0},{lga?1.3:0} EH={-.6},{ehmax},{ehmax},{ehmax} RS3=1"
%     char  basa "{basa} RSMH2=1.3,1.3,1.3 EH2=-1.3,-1.1,-1.1"
#%     char  strnc "P=0,0,4.30,4.15,5.12 IDMOD=0 0 0 1 1 PZ={tpsc==4?5.5:0},13.95,{tpdc==3?13.93:0} Q=3,0"
%     char  strnc "{strnc} Q=3,0"
%     endif
%     ifdef tpsa|tppa|tpda
%     char  strna "{strna} RS3=0.95"
%     endif
#   bigbas=6 combines bigbas=3 with local orbitals of bigbas=5
%   elseifd bigbas==6&(tpdc==1|tpdc==2|tpdc==4)
%     char  basc  "RSMH=1.6,1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc  "{basc} RSMH2=1.6,1.6,.9 EH2=-1,-1,-1,-2"
%     char  basa  "RSMH=1.3,1.3,1.3,1.3,1.3 EH=-.6,{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa  "{basa} RSMH2=1.3,1.3,1.3 EH2=-1.3,-1.1,-1.1,-1.1"
%     char  base  "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef tpdc==1 | tpdc==4
%       char  strnc "PZ=5.5,0*5.5,4.5"
%     elseifd tpdc==2
%       char  strnc "P=0,0,4.5 PZ=5.5,0*5.5,3.9"
%     endif
%     char  strna "P=0,0,4.30 PZ=5.5,5.5,5.5*0 IDMOD=0,0,1,1,1"
%   elseifd bigbas==5&(tpdc==1|tpdc==2|tpdc==4)
%     char  basc  "RSMH=1.6,1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc  "{basc} RSMH2=1.6,1.6,.9,1.6 EH2=-1,-1,-1,-2"
%     char  basa  "RSMH=1.3,1.3,1.3,1.3,1.3 EH=-.6,{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa  "{basa} RSMH2=1.3,1.3,1.3,1.3*0 EH2=-1.3,-1.1,-1.1,-1.1"
%     char  base  "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef tpdc==1 | tpdc==4
%       char  strnc "PZ=5.5,0*5.5,4.5"
%     elseifd tpdc==2
%       char  strnc "P=0,0,4.5 PZ=5.5,0*5.5,3.9"
%     endif
%     char  strna "P=0,0,4.30 PZ=5.5,5.5,5.5 IDMOD=0,0,1,1,1"
%   elseifd bigbas==4&(tpdc==1|tpdc==2|tpdc==4)
%     char  basc  "RSMH=1.6,1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc  "{basc} RSMH2=1.6,1.6,.9,1.6 EH2=-1,-1,-1,-2"
%     char  basa  "RSMH=1.3,1.3,1.3,1.3,1.3 EH=-.6,{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa  "{basa} RSMH2=1.3,1.3,1.3,1.3*0 EH2=-1.3,-1.1,-1.1,-1.1"
%     char  base  "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==3&(tpdc==1|tpdc==2|tpdc==4)
%     char  basc  "RSMH=1.6,1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc  "{basc} RSMH2=1.6,1.6,.9 EH2=-1,-1,-1,-2"
%     char  basa  "RSMH=1.3,1.3,1.3,1.3,1.3 EH=-.6,{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa  "{basa} RSMH2=1.3,1.3,1.3 EH2=-1.3,-1.1,-1.1,-1.1"
%     char  base  "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==2&(tpdc==1|tpdc==2|tpdc==4)
%     char  basc  "RSMH=1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc  "{basc} RSMH2=1.6,1.6,.9 EH2=-1,-1,-1,-2"
%     char  basa  "RSMH=1.3,1.3,1.3,1.3 EH=-.6,{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa  "{basa} RSMH2=1.3,1.3,1.3 EH2=-1.3,-1.1,-1.1,-1.1"
%     char  base  "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas&(tpdc==1|tpdc==2|tpdc==4)
%     char  basc  "RSMH=1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc  "{basc} RSMH2=1.6,0,.9 EH2=-1,-1,-1,-2"
%     char  basa  "RSMH=1.3,1.3,1.3,1.3 EH=-.6,{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa  "{basa} RSMH2=1.3,1.3 EH2=-1.3,-1.1,-1.1,-1.1"
%     char  base  "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==2&tpdc==0
%     char  basc "RSMH=1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.6,1.6,1.6 EH2=-1,-1,-1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3 EH=-.3,{ehmax},{ehmax},{ehmax} RSMH2=1.3,1.3,1.3 EH2=-1,-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas&tpdc==0
%     char  basc "RSMH=1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.6,1.6 EH2=-1,-1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3 EH=-.3,{ehmax},{ehmax},{ehmax} RSMH2=1.3,1.3 EH2=-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},-.1"
%   elseifd tpdc==1|tpdc==4
%     char  basc "RSMH=1.6,1.6,.9,1.6 EH=-.1,-.1,-.8,-.1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3 EH=-.6,-.1,-.1,-.1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   else
%     char  basc "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3 EH=-.6,-.1,-.1,-.1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   endif
# Mn impurity
# %     char strnb MMOM=0,0,3
# %     char  basb "RSMH=2.1,2.1,1.0,2.1 EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=2.1,2.1,1.0 EH2=-1.0,-1.0,-1.0"
# %     char  basb "RSMH=2.1,2.1,1.0,2.1 EH={ehmax},{ehmax},{ehmax},{ehmax}"
# -------- OLD ---------
# %   ifdef f
# %   elseifd bigbas==5&(tpdc==1|tpdc==2|tpdc==4)&gwbas
# %     char  basc "RSMH=1.6,1.6,1.6,1.6,1.6 EH=-.2,-.2,-.2,-.2,-.2 RSMH2=1.6,1.6,.9,1.6 EH2=-1,-1,-1,-1"
# %     char  basa "RSMH=1.3,1.3,1.3,1.3,1.6 EH=-.6,-.2,-.2,-.2,-.2 RSMH2=1.3,1.3,1.3,1.3 EH2=-1.3,-1,-1,-1"
# %     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.2,-.2,-.2,-.2 RSMH2=1.5,1.5,0 EH2=-1,-1,-1"
# %     ifdef tpdc==1 | tpdc==4
# %       char  strnc "PZ=5.5,0*5.5,4.5"
# %     elseifd tpdc==2
# %       char  strnc "P=0,0,4.5 PZ=5.5,0*5.8,3.9"
# %     endif
# %     char  strna "P=0,0,4.30 PZ=5.5,5.5,5.5 IDMOD=0,0,1"
# %   elseifd bigbas==4&(tpdc==1|tpdc==2|tpdc==4)&gwbas
# %     char  basc "RSMH=1.6,1.6,1.6,1.6,1.6 EH=-.2,-.2,-.2,-.2,-.2 RSMH2=1.6,1.6,.9,1.6 EH2=-1,-1,-1,-1"
# %     char  basa "RSMH=1.3,1.3,1.3,1.3,1.6 EH=-.6,-.2,-.2,-.2,-.2 RSMH2=1.3,1.3,1.3,1.3 EH2=-1.3,-1,-1,-1"
# %     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.2,-.2,-.2,-.2 RSMH2=1.5,1.5,0 EH2=-1,-1,-1"
# %   elseifd bigbas==3&(tpdc==1|tpdc==2|tpdc==4)&gwbas
# %     char  basc "RSMH=1.6,1.6,1.6,1.6,1.6 EH=-.2,-.2,-.2,-.2,-.2 RSMH2=1.6,1.6,.9 EH2=-1,-1,-1"
# %     char  basa "RSMH=1.3,1.3,1.3,1.3,1.6 EH=-.6,-.2,-.2,-.2,-.2 RSMH2=1.3,1.3,1.3 EH2=-1.3,-1,-1"
# %     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.2,-.2,-.2,-.2 RSMH2=1.5,1.5,0 EH2=-1,-1,-1"
# %   elseifd bigbas==2&(tpdc==1|tpdc==2|tpdc==4)&gwbas
# %     char  basc "RSMH=1.6,1.6,1.6,1.6 EH=-.2,-.2,-.2,-.2 RSMH2=1.6,1.6,.9 EH2=-1,-1,-1"
# %     char  basa "RSMH=1.3,1.3,1.3,1.3 EH=-.6,-.2,-.2,-.2 RSMH2=1.3,1.3,1.3 EH2=-1.3,-1,-1"
# %     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.2,-.2,-.2,-.2"
# %   elseifd bigbas==4&(tpdc==1|tpdc==2|tpdc==4)
# %     char  basc "RSMH=1.6,1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1,-.1 RSMH2=1.6,1.6,.9,1.6 EH2=-1,-1,-1,-1"
# %     char  basa "RSMH=1.3,1.3,1.3,1.3,1.3 EH=-.6,-.1,-.1,-.1,-.1 RSMH2=1.3,1.3,1.3,1.3 EH2=-1.3,-1,-1,-1"
# %     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1 RSMH2=1.5,1.5,0 EH2=-1,-1,-1"
# %   elseifd bigbas==3&(tpdc==1|tpdc==2|tpdc==4)
# %     char  basc "RSMH=1.6,1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1,-.1 RSMH2=1.6,1.6,.9 EH2=-1,-1,-1"
# %     char  basa "RSMH=1.3,1.3,1.3,1.3,1.3 EH=-.6,-.1,-.1,-.1,-.1 RSMH2=1.3,1.3,1.3 EH2=-1.3,-1,-1"
# %     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1 RSMH2=1.5,1.5,0 EH2=-1,-1,-1"
# %   elseifd bigbas==2&(tpdc==1|tpdc==2|tpdc==4)
# %     char  basc "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1 RSMH2=1.6,1.6,.9 EH2=-1,-1,-1"
# %     char  basa "RSMH=1.3,1.3,1.3,1.3 EH=-.6,-.1,-.1,-.1 RSMH2=1.3,1.3,1.3 EH2=-1.3,-1,-1"
# %     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
# %   elseifd bigbas==2&tpdc==0
# %     char  basc "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1 RSMH2=1.6,1.6,1.6 EH2=-1,-1,-1"
# %     char  basa "RSMH=1.3,1.3,1.3,1.3 EH=-.3,-.1,-.1,-.1 RSMH2=1.3,1.3,1.3 EH2=-1,-1,-1"
# %     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
# %   elseifd bigbas&(tpdc==1|tpdc==2|tpdc==4)
# %     char  basc "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1 RSMH2=1.6,0,.9 EH2=-1,-1,-1"
# %     char  basa "RSMH=1.3,1.3,1.3,1.3 EH=-.6,-.1,-.1,-.1 RSMH2=1.3*0,1.3 EH2=-1.3,-1"
# %     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
# %   elseifd bigbas&tpdc==0
# %     char  basc "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1 RSMH2=1.6,1.6 EH2=-1,-1"
# %     char  basa "RSMH=1.3,1.3,1.3,1.3 EH=-.3,-.1,-.1,-.1 RSMH2=1.3,1.3 EH2=-1,-1"
# %     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
# %   elseifd tpdc==1|tpdc==4
# %     char  basc "RSMH=1.6,1.6,.9,1.6 EH=-.1,-.1,-.8,-.1"
# %     char  basa "RSMH=1.3,1.3,1.3,1.3 EH=-.6,-.1,-.1,-.1"
# %     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
# %   elseifd tpdc==0
# %     char  basc "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1"
# %     char  basa "RSMH=1.3,1.3,1.3,1.3 EH=-.6,-.1,-.1,-.1"
# %     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
# %   endif
% elseifd cmpd=='InAs'
%   const tpan=t metal=t azb=11.43
%   char  strnc "P={pval(tpsc,0,4.94,6.5)},{pval(tppc,0,4.93,6.5)},{pval(tpdc,4.93,4.93,5.4)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,4.94,6.5)},{ploc(tppc,0,4.93,6.5)},{ploc(tpdc,0,4.93,5.4)}"
%   char  strnc "{strnc} IDMOD=0,0,{tpdc==0?1:0},1,1"
%   char  strna "P={pval(tpsa,4.88,4.88,4.88)},{pval(tppa,4.7,4.7,4.7)},{pval(tpda,4.3,3.94,4.3)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,3.95,5.5)},{ploc(tppa,0,3.95,5.5)},{ploc(tpda,0,3.94,4.3)}
%   char  strna "{strna} IDMOD=0,0,{tpda==0?1:0},1,1"
%   ifdef tpdc>0
%     const ngd=24
%   else
%     const ngd=16
%   endif
%   ifdef f
#   Patterned after bigbas11 in InP, GaAs
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.7,1.7,1.7,{lfc?1.7:0},{lgc?1.7:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef bigbas==11
%     char  basc "{basc} RSMH2=1.7,0,{tpdc==3?0:1.0} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.5,1.5,{tpdc==3?1.5:1.0} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     endif
%     char  basa "RSMH=1.4,1.4,1.4,{lfa?1.4:0},{lga?1.4:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     char  basa "{basa} RSMH2=1.4,1.4,1.4 EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==4&(tpdc==2|tpdc==4)&gwbas
%     char  basc "RSMH=1.7,1.7,1.7,1.7,1.7 EH=-.25,-.25,-.25,-.25,-.25 RSMH2=1.7,1.7,1.0,1.7 EH2=-1,-1,-1,-1"
%     char  basa "RSMH=1.4,1.4,1.4,1.4,1.4 EH=-.25,-.25,-.25,-.25,-.25 RSMH2=1.4,1.4,1.4,1.4 EH2=-1,-1,-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.25,-.25,-.25,-.25"
%     char strna "P=0,0,4.30 IDMOD=0,0,1 PZ=5.5"
%   elseifd bigbas==2&(tpdc==2|tpdc==4)&gwbas
%     char  basc "RSMH=1.7,1.7,1.7,1.7 EH=-.25,-.25,-.25,-.25 RSMH2=1.7,1.7,1 EH2=-1,-1,-1"
%     char  basa "RSMH=1.4,1.4,1.4,1.4 EH=-.25,-.25,-.25,-.25 RSMH2=1.4,1.4,1.4 EH2=-1,-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.25,-.25,-.25,-.25"
%   elseifd bigbas==2&(tpdc==2|tpdc==4)
%     char  basc "RSMH=1.7,1.7,1.7,1.7 EH=-.1,-.1,-.1,-.1 RSMH2=1.7,1.7,1 EH2=-1,-1,-1"
%     char  basa "RSMH=1.4,1.4,1.4,1.4 EH=-.1,-.1,-.1,-.1 RSMH2=1.4,1.4,1.4 EH2=-1,-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas==2&tpdc==1
%     char  basc "RSMH=1.7,1.7,0.9,1.7 EH=-.1,-.1,-.3,-.1 RSMH2=1.7,1.7,0.9 EH2=-1,-1,-1"
%     char  basa "RSMH=1.4,1.4,1.4,1.4 EH=-.1,-.1,-.1,-.1 RSMH2=1.4,1.4,1.4 EH2=-1,-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas==2
%     char  basc "RSMH=1.7,1.7,1.7,1.7 EH=-.1,-.1,-.1,-.1 RSMH2=1.7,1.7,1.7 EH2=-1,-1,-1"
%     char  basa "RSMH=1.4,1.4,1.4,1.4 EH=-.1,-.1,-.1,-.1 RSMH2=1.4,1.4,1.4 EH2=-1,-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas&(tpdc==2|tpdc==4)&gwbas
%     char  basc "RSMH=1.7,1.7,1.7,1.7 EH=-.25,-.25,-.25,-.25 RSMH2=1.7,0,1 EH2=-1,-1,-1"
%     char  basa "RSMH=1.4,1.4,1.4,1.4 EH=-.25,-.25,-.25,-.25 RSMH2=1.4,1.4 EH2=-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.25,-.25,-.25,-.25"
%   elseifd bigbas&(tpdc==2|tpdc==4)
%     char  basc "RSMH=1.7,1.7,1.7,1.7 EH=-.1,-.1,-.1,-.1 RSMH2=1.7,0,1 EH2=-1,-1,-1"
%     char  basa "RSMH=1.4,1.4,1.4,1.4 EH=-.1,-.1,-.1,-.1 RSMH2=1.4,1.4 EH2=-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   elseifd (tpdc==2|tpdc==4)
%     char  basc "RSMH=1.7,1.7,1.0,1.7 EH=-.1,-.1,-.6,-.1"
%     char  basa "RSMH=1.4,1.4,1.4,1.4 EH=-.6,-.1,-.1,-.1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas&tpdc==1
%     char  basc "RSMH=1.7,1.7,0.9,1.7 EH=-.1,-.1,-.3,-.1 RSMH2=1.7,0,0.9 EH2=-1,-1,-1"
%     char  basa "RSMH=1.4,1.4,1.4,1.4 EH=-.1,-.1,-.1,-.1 RSMH2=1.4,1.4 EH2=-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   elseifd tpdc>0
%     stop 1 basis not built for this case
%   elseifd bigbas
%     char  basc "RSMH=1.7,1.7,1.7,1.7 EH=-.1,-.1,-.1,-.1 RSMH2=1.7,1.7 EH2=-1,-1"
%     char  basa "RSMH=1.4,1.4,1.4,1.4 EH=-.1,-.1,-.1,-.1 RSMH2=1.4,1.4 EH2=-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   else
%     char  basc "RSMH=1.7,1.7,1.7,1.7 EH=-.1,-.1,-.1,-.1"
%     char  basa "RSMH=1.4,1.4,1.4,1.4 EH=-.6,-.1,-.1,-.1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   endif
% elseifd cmpd=='TlAs'
%   char  linkc "0 0 0 -1.6 -2.1 -.9"  linka "0 0 0 -1.4 -1.7 5"
%   const tpan=t metal=t azb=11.43
% elseifd cmpd=='SrO' | cmpd=='BaO'
%   ifdef cmpd=='SrO'
%   const tpan=t metal=f a=9.75 gmax=8
%   char  strnc "P={pval(tpsc,5.5,4.94,5.5)},{pval(tppc,5.3,4.93,5.3)},{pval(tpdc,4.3,4.3,4.3)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,5.5,4.94,6.5)},{ploc(tppc,5.3,4.93,6.5)},{ploc(tpdc,0,0,5.4)}"
%   char  strnc "{strnc} IDMOD=0,0,1,1,1"
%   elseifd cmpd=='BaO'
#   Lattice constant from Wykoff: a=5.523A
%   const tpan=t metal=f a=10.44 gmax=8 rwc=1.2 rwa=0.80
%   char  strnc "P={pval(tpsc,6.5,5.94,6.5)},{pval(tppc,6.3,5.93,6.5)},{pval(tpdc,5.3,5.3,5.3)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,5.94,6.5)},{ploc(tppc,0,5.93,6.5)},{ploc(tpdc,0,4.93,6.3)} IDMOD=0,0,1,1,1"
%   char  strnc "{strnc} KMXA=4"
%   endif
%   ifdef tpsc==2 | tpsc==3
%   char  strnc "{strnc} Q=0,0,2"
%   endif
%   char  strna "P={pval(tpsa,0,2.83,3.5)},{pval(tppa,0,2.70,3.5)},3.25,4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,2.83,3.5)},{ploc(tppa,0,2.70,3.5)},0 IDMOD=0,0,1,1,1"
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.0,1.0,1.6,{lfc?1.1:0},{lgc?1.1:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.0,{bigbas==11?0:1.0},1.0 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.80"
%     char  basa "RSMH=1,1,1,{lfa?1:0},{lga?1:0} EH={tpsa==3?ehmax:-.6},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1,1,1 EH2={tpsa==3?ehmax-.8:-1.4},{ehmax-.8},{ehmax-.8} RS3=.9"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH={ehmax},{ehmax},{ehmax},{ehmax}"
#   g orbitals to Sr, f on O, local orbitals
%   elseifd bigbas==6
%     char basc "RSMH=1.0,1.0,1.6,1,1 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char basc "{basc} RSMH2=1.0,1.0,1.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char strnc "P=5.5 5.3 4.3  PZ=4.9,4.9 IDMOD=0 1 1 1 1 Q=0 0 2"
%     char basa "RSMH=1,1.1,1,1 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char basa "{basa} RSMH2=1.8,1.0,1.0 EH2=-1.2,-1.2,-1.2"
%     char basa "{basa} RSMH2=1,1.0,1.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char strna "P=0,0,3.25 PZ=0,3.9,4.5 IDMOD=0 0 1"
#   f orbitals on Sr, double spd on O
%   elseifd bigbas==2
%     char basc "RSMH=1.0,1.0,1.6,1 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char basc "{basc} RSMH2=1.0,1.0,1.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char strnc "P=5.5 5.3 4.3  PZ=0,4.9 IDMOD=0 1 1 1 1"
%     char basa "RSMH=1,1.1,1 EH={ehmax},{ehmax},{ehmax}"
%     char basa "{basa} RSMH2=1,1.0,1.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char strna "P=0,0,3.25 IDMOD=0 0 1"
#   Double spd on Sr, double sp on O
%   elseifd bigbas>1
%     stop 1 "basis not defined"
%   elseifd bigbas
%     char basc "RSMH=1.0,1.0,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char basc "{basc} RSMH2=1.0,1.0,1.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char strnc "P=5.5 5.3 4.3  PZ=0,4.9 IDMOD=0 1 1 1 1"
%     char basa "RSMH=1,1.1,1 EH={ehmax},{ehmax},{ehmax}"
%     char basa "{basa} RSMH2=1,1.0,0.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char strna "P=0,0,3.25 IDMOD=0 0 1"
%   else
%     char basc "RSMH=1,1,1.6 EH={ehmax},-.8,{ehmax},{ehmax}"
%     char strnc "P=5.5 5.3 4.3  PZ=0,4.9 IDMOD=0 1 1 1 1"
%     char basa "RSMH=1,1.1,1 EH=-0.9,{ehmax},{ehmax}"
%     char strna "P=0,0,3.25 IDMOD=0 0 1"
%   endif
% elseifd cmpd=='LaN' | cmpd=='CeN' | cmpd=='EuN' | cmpd=='GdN' | cmpd=='YbN' | cmpd=='EuO'
%   ifdef f
%   elseifd cmpd=='LaN'
%   const tpan=t metal=f a=5.30/.5292 gmax=9 tppc=2 rwc=1.2 rwa=0.83
%   elseifd cmpd=='CeN'
%   const tpan=t metal=f a=4.87/.5292 gmax=9 tppc=2 rwc=1.2 rwa=0.83
%   elseifd cmpd=='EuN'
%   const tpan=t metal=f a=5.00/.5292 gmax=9 tppc=2 rwc=1.2 rwa=0.83
%   elseifd cmpd=='GdN'
%   const tpan=t metal=f a=4.999/.5292 gmax=9 tppc=2 rwc=1.2 rwa=0.83
%   elseifd cmpd=='YbN'
%   const tpan=t metal=f a=4.78/.5292 gmax=9 tppc=2 rwc=1.2 rwa=0.83
#   Lattice constant from  Larson & Lambrecht, JPCM 2006.
%   elseifd cmpd=='EuO'
%   const tpan=t metal=f a=5.141/.5292 gmax=9 tppc=2 rwc=1.2 rwa=0.83
%   endif
%   char  strnc "P={pval(tpsc,6.5,5.95,6.5)},{pval(tppc,0,5.93,6.5)},{pval(tpdc,5.3,4.93,5.4)},{pval(tpfc,4.9,4.9,5.5)}"
%   char  strnc "{strnc},5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,6.5,5.95,0.0)},{ploc(tppc,0,5.93,7.5)},0,{ploc(tpfc,4.9,4.9,5.5)}"
%   ifdef f
%   elseifd cmpd=='LaN' | cmpd=='CeN'
%   char  strnc "{strnc} IDMOD=0,{tppc<2|tppc==3?1:0},1,0,1 KMXA=4"
%   elseifd cmpd=='EuN'
%   char  strnc "{strnc} IDMOD=0,{tppc<2|tppc==3?1:0},1,0,1 MMOM=0,0,0,6 KMXA=4"
%   elseifd cmpd=='GdN' | cmpd=='EuO'
%   char  strnc "{strnc} IDMOD=0,{tppc<2|tppc==3?1:0},1,0,1 MMOM=0,0,0,7 KMXA=4"
%   elseifd cmpd=='YbN'
%   char  strnc "{strnc} IDMOD=0,{tppc<2|tppc==3?1:0},1,0,1 MMOM=0,0,0,1 KMXA=4"
%   endif
%   char  strna          "P={pval(tpsa,0,2.83,3.5)},{pval(tppa,0,2.74,3.5)},3.25,4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,2.83,3.5)},{ploc(tppa,0,2.74,3.5)},0 IDMOD=0,0,1,1,1"
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.0,{tppc==2?1.0:1.7},1.2,1.10,1.4 EH={ehmax},{ehmax},{ehmax},-0.30,{ehmax}"
%     char  basc "{basc} RSMH2=1.2,{bigbas==11?0:1.2},1.2,1.2 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8},{ehmax-.8}"
%     char  basa "RSMH=1,1,1.6,{lfa?1.6:0} EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1,1,1 EH2={tpsa==3?ehmax-.8:-1.4},{ehmax-.8},{ehmax-.8} RS3=.9"
%     char  base "RSMH=1.2,1.2,1.2,1.2*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
#   bigbas=6 combines bigbas=3 with local orbitals of bigbas=5
#   g orbitals to Gd, f on N, local orbitals
%   elseifd bigbas==3&tppc==2 | bigbas==6&tppc==2
%     char  basc "RSMH=1.0 {tppc==2?1.0:1.7} 1.2 1.10 1.4 EH= {ehmax} {ehmax} {ehmax} -0.30 {ehmax}"
%     char  basc "{basc} RSMH2=1.2,1.1,1.2,1.2 EH2=-1,-1.5,-1,-1"
%     char  basa "RSMH=1.0,1.0,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.0,1.0,1.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char  base "RSMH=1.2,1.2,1.2,1.2*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==2
%     char  basc "RSMH=1.0 {tppc==2?1.0:1.7} 1.2 1.10 EH= {ehmax} {ehmax} {ehmax} -0.30"
%     char  basc "{basc} RSMH2=1.2,1.1,1.2,1.2 EH2=-1,{tppc==2?-1.5:ehmax-.9},-1,-1"
%     char  basa "RSMH=1.0,1.0,1.6 EH={ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.0,1.0,1.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char  base "RSMH=1.2,1.2,1.2,1.2*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
#   Double spd on Sc, double sp on N
%   elseifd bigbas>1
%     stop 1 "basis not defined"
%   elseifd bigbas
%     char  basc "RSMH=1.0 {tppc==2?1.0:1.7} 1.2 1.10 EH= {ehmax} {ehmax} {ehmax} -0.30"
%     char  basc "{basc} RSMH2=1.2,1.2,1.2,1.2 EH2=-1,-1,-1,-1"
%     char  basa "RSMH=1.0,1.0,1.6 EH={ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.0,1.0,0.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char  base "RSMH=1.2,1.2,1.2,1.2*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     char  basc "RSMH=1.0 {tppc==2?1.0:1.7} 1.5 1.10 EH= -1 -1 {ehmax} -0.50"
%     char  basa "RSMH=1.0,1.1,1.6 EH=-0.6,{ehmax},{ehmax}"
%     char  base "RSMH=1.2,1.2,1.2*0,1.2*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   endif
% elseifd cmpd=='GdP'
%   const tpan=t metal=f a=5.704/.5292 gmax=8 tppc=2 rwc=1.2 rwa=0.83
%   char  strnc "P={pval(tpsc,6.5,5.95,6.5)},{pval(tppc,0,5.94,6.5)},{pval(tpdc,5.3,4.93,5.4)},{pval(tpfc,4.9,4.9,5.5)}"
%   char  strnc "{strnc},5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,6.5,5.95,0.0)},{ploc(tppc,0,5.94,7.5)},0,{ploc(tpfc,4.9,4.9,5.5)}"
%   char  strnc "{strnc} IDMOD=0,{tppc<2?1:0},1,0,1 MMOM=0,0,0,7 KMXA=4"
%   char  strna          "P={pval(tpsa,0,3.85,4.5)},{pval(tppa,0,3.7,4.5)},{pval(tpda,3.3,3.3,4.4)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,2.95,4.5)},{ploc(tppa,0,2.94,4.5)},{ploc(tpda,0,0,4.4)} IDMOD=0,0,1,1,1"
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.7,1.7,1.7,1.1,{lgc?1.7:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef bigbas==11
%     char  basc "{basc} RSMH2=1.7,0,{tpdc==3?0:1.0},1.1 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.5,1.5,{tpdc==3?0:1.0},1.1 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     endif
%     char  basa "RSMH=1.5,1.5,1.5,{lfa?1.5:0},{lga?1.5:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     char  basa "{basa} RSMH2=1.5,1.5,1.5 EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
#   bigbas=6 combines bigbas=3 with local orbitals of bigbas=5
#   g orbitals to Gd, f on P, local orbitals
%   elseifd bigbas==3&tppc==2 | bigbas==6&tppc==2
%     char  basc "RSMH=1.0 {tppc==2?1.0:1.7} 1.2 1.10 1.4 EH= {ehmax} {ehmax} {ehmax} -0.30 {ehmax}"
%     char  basc "{basc} RSMH2=1.2,1.1,1.2,1.2 EH2=-1,-1.5,-1,-1"
%     char  basa "RSMH=1.5,1.5,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.5,1.5,1.5 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==2
%     char  basc "RSMH=1.0 {tppc==2?1.0:1.7} 1.2 1.10 EH= {ehmax} {ehmax} {ehmax} -0.30"
%     char  basc "{basc} RSMH2=1.2,1.1,1.2,1.2 EH2=-1,{tppc==2?-1.5:ehmax-.9},-1,-1"
%     char  basa "RSMH=1.5,1.5,1.6 EH={ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.5,1.5,1.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
#   Double spd on Gd, double sp on P
%   elseifd bigbas>1
%     stop 1 "basis not defined"
%   elseifd bigbas
%     char  basc "RSMH=1.1 {tppc==2?1.1:1.7} 1.2 1.10 EH= {ehmax} {ehmax} {ehmax} -0.30"
%     char  basc "{basc} RSMH2=1.2,1.2,1.2,1.2 EH2=-1,-1,-1,-1"
%     char  basa "RSMH=1.5,1.5,1.8 EH={ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.5,1.5,0.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     char  basc "RSMH=1.1 {tppc==2?1.1:1.7} 1.5 1.10 EH= -1 -1 {ehmax} -0.50"
%     char  basa "RSMH=1.5,1.5,1.8 EH=-0.6,{ehmax},{ehmax}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   endif
% elseifd cmpd=='GdAs'
%   const tpan=t metal=f a=5.803/.5292 gmax=9 tppc=2 rwc=1.2 rwa=0.83
%   char  strnc "P={pval(tpsc,6.5,5.95,6.5)},{pval(tppc,0,5.93,6.5)},{pval(tpdc,5.3,4.93,5.4)},{pval(tpfc,4.9,4.9,5.5)}"
%   char  strnc "{strnc},5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,6.5,5.95,0.0)},{ploc(tppc,0,5.93,7.5)},0,{ploc(tpfc,4.9,4.9,5.5)}"
%   char  strnc "{strnc} IDMOD=0,{tppc<2|tppc==3?1:0},1,0,1 MMOM=0,0,0,7 KMXA=4"
%   char  strna          "P={pval(tpsa,0,0,5.5)},{pval(tppa,0,0,5.5)},{pval(tpda,4.3,3.94,4.3)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,3.95,5.5)},{ploc(tppa,0,3.94,5.5)},{ploc(tpda,0,3.94,4.3)} IDMOD=0,0,1,1,1"
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.7,1.7,1.2,1.1,{lgc?1.7:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef bigbas==11
%     char  basc "{basc} RSMH2=1.7,0,1.2,1.1 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.7,1.7,1.2,1.1 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     endif
%     char  basa "RSMH=1.5,1.5,1.5,{lfa?1.5:0},{lga?1.5:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     char  basa "{basa} RSMH2=1.5,1.5,1.5 EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
#   bigbas=6 combines bigbas=3 with local orbitals of bigbas=5
#   g orbitals to Gd, f on As, local orbitals
%   elseifd bigbas==3&tppc==2 | bigbas==6&tppc==2
%     char  basc "RSMH=1.0 {tppc==2?1.0:1.7} 1.2 1.10 1.4 EH= {ehmax} {ehmax} {ehmax} -0.30 {ehmax}"
%     char  basc "{basc} RSMH2=1.2,1.1,1.2,1.2 EH2=-1,-1.5,-1,-1"
%     char  basa "RSMH=1.5,1.5,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.5,1.5,1.5 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==2
%     char  basc "RSMH=1.0 {tppc==2?1.0:1.7} 1.2 1.10 EH= {ehmax} {ehmax} {ehmax} -0.30"
%     char  basc "{basc} RSMH2=1.2,1.1,1.2,1.2 EH2=-1,{tppc==2?-1.5:ehmax-.9},-1,-1"
%     char  basa "RSMH=1.5,1.5,1.6 EH={ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.5,1.5,1.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
#   Double spd on Gd, double sp on As
%   elseifd bigbas>1
%     stop 1 "basis not defined"
%   elseifd bigbas
%     char  basc "RSMH=1.1 {tppc==2?1.1:1.7} 1.2 1.10 EH= {ehmax} {ehmax} {ehmax} -0.30"
%     char  basc "{basc} RSMH2=1.2,1.2,1.2,1.2 EH2=-1,-1,-1,-1"
%     char  basa "RSMH=1.5,1.6,2.0 EH={ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.5,1.6,0.0 EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     char  basc "RSMH=1.1 {tppc==2?1.1:1.7} 1.5 1.10 EH= -1 -1 {ehmax} -0.50"
%     char  basa "RSMH=1.5,1.6,2.0 EH=-0.6,{ehmax},{ehmax}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   endif
% elseifd cmpd=='ErAs'
%   const tpan=t metal=f a=10.83 rwc=1.12 rwa=0.92 ngd=24
%   char  strnc "P={pval(tpsc,6.5,5.95,6.5)},{pval(tppc,6.3,5.93,{tppc==2?6.5:6.3})},{pval(tpdc,5.3,4.93,6.3)}"
%   char  strnc "{strnc},{pval(tpfc,4.9,4.9,5.5)},5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,6.5,5.95,0.0)},{ploc(tppc,0,5.93,7.5)},0,{ploc(tpfc,4.9,4.9,5.5)}"
%   char  strnc "{strnc} IDMOD=0,{tppc<2|tppc==3?1:0},1,0,1 MMOM=0,0,0,3"
# %   char  strnc "MMOM=0,0,0,3 P=0,{tppc==2?6.4:6.3},5.3,0,5.12 IDMOD=0,1,1,0,1,1,1"
%   char  strna          "P={pval(tpsa,0,0,5.5)},{pval(tppa,0,0,5.5)},{pval(tpda,4.3,3.94,4.3)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,3.95,5.5)},{ploc(tppa,0,3.94,5.5)},{ploc(tpda,0,3.94,4.3)} IDMOD=0,0,1,1,1"
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=2.5,{tppc==2?1:2.5},1.6,1.0,{lgc?2:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef bigbas==11
%     char  basc "{basc} RSMH2=2,0,1.6,1.0 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=2,2,1.6,1.0 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     endif
%     char  basa "RSMH=1.5,1.5,1.5,{lfa?1.5:0},{lga?1.5:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     char  basa "{basa} RSMH2=1.5,1.5,1.5 EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
#   bigbas=6 combines bigbas=3 with local orbitals of bigbas=5
%   elseifd bigbas==3&tppc==2 | bigbas==6&tppc==2
%     char  basc "RSMH= 2.5 {tppc==2?1:2.5} 1.6 1.0 1.4 EH= {ehmax} {ehmax} {ehmax} -0.25 {ehmax}"
%     char  basc "{basc} RSMH2=1.2,{tppc==2?1:2.5},1.2,1.2 EH2=-1,{tppc==2?-1.5:-1},-1,-1"
%     char  basa "RSMH= 1.5 1.6 2 1.5 1.4 EH=-0.3 {ehmax} {ehmax} {ehmax} {ehmax}"
%     char  basa "{basa} RSMH2=1.3,1.3,1.3 EH2=-1,-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==2&tppc==2
%     char  basc "RSMH= 2.0 1.1 1.4 1.2 EH= {ehmax} {ehmax} {ehmax} -0.25 RSMH2=1.2,1.1,1.2,1.2 EH2=-1,-1.5,-1,-1"
%     char  basa "RSMH= 1.5 1.6 2 1.5 EH=-0.3 {ehmax} {ehmax} {ehmax} RSMH2=1.3,1.3,1.3 EH2=-1,-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==2
%     char  basc "RSMH= 2.0 1.2 1.4 1.2 EH= {ehmax} {ehmax} {ehmax} -0.25 RSMH2=1.2,1.2,1.2,1.2 EH2=-1,-1,-1,-1"
%     char  basa "RSMH= 1.5 1.6 2 1.5 EH=-0.3 {ehmax} {ehmax} {ehmax} RSMH2=1.3,1.3,1.3 EH2=-1,-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas&tppc==2
%     char  basc "RSMH= 2.0 1.1 1.4 1.2 EH= {ehmax} {ehmax} {ehmax} -0.25 RSMH2=1.2,1.1,1.2,1.2 EH2=-1,-1.5,-1,-1"
%     char  basa "RSMH= 1.5 1.6 2 EH=-0.3 {ehmax} {ehmax} RSMH2=1.3,1.3 EH2=-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas
%     char  basc "RSMH= 2.0 1.2 1.4 1.2 EH= {ehmax} {ehmax} {ehmax} -0.25 RSMH2=1.2,1.2,1.2,1.2 EH2=-1,-1,-1,-1"
%     char  basa "RSMH= 1.5 1.6 2 EH=-0.3 {ehmax} {ehmax} RSMH2=1.3,1.3 EH2=-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     char  basc "RSMH= 2.0 1.2 1.4 1.2 EH= {ehmax} {ehmax} {ehmax} -0.25"
%     char  basa "RSMH= 1.5 1.6 2 EH=-0.65 {ehmax} {ehmax}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   endif
%   char  strnb "MMOM=0,0,0,-3 {strnc}"
%   char  basb  "{basc}"
% elseifd cmpd=='AlSb'
%   const tpan=t metal=t azb=11.59
%   char  strnc "P={pval(tpsc,0,2.94,4.5)},{pval(tppc,0,2.93,4.5)},3.3,4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,2.94,4.5)},{ploc(tppc,0,2.93,4.5)},0
%   char  strnc "{strnc} IDMOD=0,0,1,1,1"
%   char  strna "P={pval(tpsa,0,5.88,6.5)},0,{pval(tpda,5.3,4.95,5.4)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,5.88,6.5)},0,{ploc(tpda,5.3,4.95,5.4)} IDMOD=0,0,{tpda==0?1:0},1,1"
%   ifdef f
%   elseifd asa
# %     ifdef sx
# %       char  strnc "IDMOD=0,0,0,2"
# %       char  strna "IDMOD=0,0,0,2"
# %       char  strnec "IDMOD=0,0,0,2"
# %       char  strnea "IDMOD=0,0,0,2"
# %     endif
%   elseifd lmf
%   ifdef f
#   Patterned after bigbas11 in GaSb
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.6,1.6,1.6,{lfc?1.6:0},{lgc?1.6:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef bigbas==11&tpdc<>2
%     char  basc "{basc} RSMH2=1.6,0,0 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.90"
%     elseif bigbas==11
%     char  basc "{basc} RSMH2=1.6,0,0 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.90"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.6,1.6,1.6 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.95"
%     endif
%     char  basa "RSMH=1.6,1.6,1.6,{lfa?1.6:0},{lga?1.6:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     char  basa "{basa} RSMH2=1.6,1.6,1.6 EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.6,1.6,1.6,1.6*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
#   bigbas=6 combines bigbas=3 with local orbitals of bigbas=5
%   elseifd bigbas==6 & tpda==2
%     const gmax=10.5
%     char  basc "RSMH=1.6,1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.6,1.6,1.6 EH2=-1.1,-1.1,-1.1"
%     char  basa "RSMH=1.6,1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.6,1.6,0.8 EH2=-1,-1,-1.3"
%     char  base "RSMH=1.7,1.7,1.7,1.7 EH={ehmax},{ehmax},{ehmax},{ehmax}"
#     ... Putting local orbitals on p sites caused ehf to diverged from ehk
%     char  strnc "PZ=4.5,0,0"
%     char  strna "P=0,0,5.40 IDMOD=0,0,1 PZ=6.5,6.5*0,4.9"
%   elseifd bigbas==5 & tpda==2 & gwbas
%     const gmax=10.5
%     char  basc "RSMH=1.6,1.6,1.6,1.6,1.6 EH=-.2,-.2,-.2,-.2,-.2 RSMH2=1.6,1.6,1.6,1.6 EH2=-1,-1,-1,-1"
%     char  basa "RSMH=1.6,1.6,1.6,1.6,1.6 EH=-.3,-.2,-.2,-.2,-.2 RSMH2=1.6,1.6,0.8,1.6 EH2=-1,-1,-1.3,-1"
%     char  base "RSMH=1.7,1.7,1.7,1.7 EH=-.2,-.2,-.2,-.2"
#     ... Putting local orbitals on p sites caused ehf to diverged from ehk
%     char  strnc "PZ=4.5,0,0"
%     char  strna "P=0,0,5.40 IDMOD=0,0,1 PZ=6.5,6.5*0,4.9"
%   elseifd bigbas==4 & tpda==2 & gwbas
%     const gmax=10.5
%     char  basc "RSMH=1.6,1.6,1.6,1.6,1.6 EH=-.2,-.2,-.2,-.2,-.2 RSMH2=1.6,1.6,1.6,1.6 EH2=-1,-1,-1,-1"
%     char  basa "RSMH=1.6,1.6,1.6,1.6,1.6 EH=-.3,-.2,-.2,-.2,-.2 RSMH2=1.6,1.6,0.8,1.6 EH2=-1,-1,-1.3,-1"
%     char  base "RSMH=1.7,1.7,1.7,1.7 EH=-.2,-.2,-.2,-.2"
%     char  strna "P=0,0,5.4 PZ=0,0,4.9 IDMOD=0,0,1"
%   elseifd bigbas==3 & tpda==2 & gwbas
%     const gmax=10.5
%     char  basc "RSMH=1.6,1.6,1.6,1.6,1.6 EH=-.2,-.2,-.2,-.2,-.2 RSMH2=1.6,1.6,1.6,0 EH2=-1,-1,-1"
%     char  basa "RSMH=1.6,1.6,1.6,1.6,1.6 EH=-.3,-.2,-.2,-.2,-.2 RSMH2=1.6,1.6,0.8 EH2=-1,-1,-1.3"
%     char  base "RSMH=1.7,1.7,1.7,1.7 EH=-.2,-.2,-.2,-.2"
%     char  strna "P=0,0,5.4 PZ=0,0,4.9 IDMOD=0,0,1"
%   elseifd bigbas==2 & tpda==2 & gwbas
%     const gmax=10.5
%     char  basc "RSMH=1.6,1.6,1.6,1.6 EH=-.2,-.2,-.2,-.2 RSMH2=1.6,1.6,1.6,0 EH2=-1,-1,-1"
%     char  basa "RSMH=1.5,1.7,1.7,1.7 EH=-.3,-.2,-.2,-.2 RSMH2=1.6,1.6,0.8 EH2=-1,-1,-1.3"
%     char  base "RSMH=1.7,1.7,1.7,1.7 EH=-.2,-.2,-.2,-.2"
%     char  strna "P=0,0,5.4 PZ=0,0,4.9 IDMOD=0,0,1"
%   elseifd bigbas==2 & tpda==2
%     const gmax=10.5
%     char  basc "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1 RSMH2=1.6,1.6,1.6,0 EH2=-1,-1,-1"
%     char  basa "RSMH=1.5,1.7,1.7,1.7 EH=-.3,-.1,-.1,-.1 RSMH2=1.6,1.6,0.8 EH2=-1,-1,-1.3"
%     char  base "RSMH=1.7,1.7,1.7,1.7 EH=-.1,-.1,-.1,-.1"
%     char  strna "P=0,0,5.4 PZ=0,0,4.9 IDMOD=0,0,1"
%   elseifd bigbas & tpda==2 & gwbas
%     const gmax=10.5
%     char  basc "RSMH=1.6,1.6,1.6,1.6 EH=-.2,-.2,-.2,-.2 RSMH2=1.6,0,0,0 EH2=-1"
%     char  basa "RSMH=1.5,1.7,1.7,1.7 EH=-.3,-.2,-.2,-.2 RSMH2=1.6,1.6,0.8 EH2=-1,-1,-1.3"
%     char  base "RSMH=1.7,1.7,1.7,1.7 EH=-.2,-.2,-.2,-.2"
%     char  strna "P=0,0,5.4 PZ=0,0,4.9 IDMOD=0,0,1"
%   elseifd bigbas & tpda==2
%     const gmax=10.5
%     char  basc "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1 RSMH2=1.6,0,0,0 EH2=-1"
%     char  basa "RSMH=1.5,1.7,1.7,1.7 EH=-.3,-.1,-.1,-.1 RSMH2=1.6,1.6,0.8 EH2=-1,-1,-1.3"
%     char  base "RSMH=1.7,1.7,1.7,1.7 EH=-.1,-.1,-.1,-.1"
%     char  strna "P=0,0,5.4 PZ=0,0,4.9 IDMOD=0,0,1"
%   elseifd bigbas
%     const ngd=16
%     char  basc "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1 RSMH2=1.6,0,0,0 EH2=-1"
%     char  basa "RSMH=1.5,1.7,1.7,1.7 EH=-.3,-.1,-.1,-.1 RSMH2=1.6,1.6 EH2=-1,-1"
%     char  base "RSMH=1.7,1.7,1.7,1.7 EH=-.1,-.1,-.1,-.1"
%   else
%     const ngd=16
%     char  basc "RSMH=1.6,1.6,1.6,1.6 EH=-.3,-.1,-.1,-.1"
%     char  basa "RSMH=1.5,1.7,1.7,1.7 EH=-.6,-.2,-.2,-.2"
%     char  base "RSMH=1.7,1.7,1.7,1.7 EH=-.2,-.2,-.2,-.2"
%   endif
%   endif
% elseifd cmpd=='GaSb'
%   const tpan=t metal=f azb=11.50 elind=-.5
#   New basis patterned after GaAs, Ge
%   char  strnc "P={pval(tpsc,0,3.94,5.5)},{pval(tppc,0,3.93,5.5)},{pval(tpdc,4.3,3.93,4.3)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,3.93,5.5)},{ploc(tppc,0,3.93,5.5)},{ploc(tpdc,4.3,3.93,4.3)}"
%   char  strnc "{strnc} IDMOD=0,0,{tpdc==0?1:0},1,1"
%   char  strna "P={pval(tpsa,0,5.88,6.5)},0,{pval(tpda,5.3,4.95,5.4)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,5.88,6.5)},0,{ploc(tpda,5.3,4.95,5.4)} IDMOD=0,0,{tpda==0?1:0},1,1"
%   ifdef tpdc>0
%     const gmax=10.5
%     const ngd=25
%   else
%     const gmax=6
%     const ngd=16
%   endif
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.6,1.6,1.6,{lfc?1.6:0},{lgc?1.6:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef bigbas==11
%     char  basc "{basc} RSMH2=1.6,0,{tpdc==3?0:1.0} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.90"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.6,1.6,{tpdc==3?1.6:1.0} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.90"
%     endif
%     char  basa "RSMH=1.5,1.5,1.5,{lfa?1.5:0},{lga?1.5:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     char  basa "{basa} RSMH2=1.5,1.5,1.5 EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==5&(tpdc==2|tpdc==4) & tpda==2 & gwbas
%     char  basc "RSMH=1.6,1.6,1.6,1.6,1.6 EH=-.2,-.2,-.2,-.2,-.2 RSMH2=1.4,1.4,1.0,1.4 EH2=-1,-1,-1,-1"
%     char  basa "RSMH=1.5,1.5,1.5,1.5,1.5 EH=-.4,-.2,-.2,-.2,-.2 RSMH2=1.2,1.2,0.8,1.2 EH2=-1.1,-1,-1.3,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.2,-.2,-.2,-.2"
%     char  strnc "P=0,0,4.30 IDMOD=0,0,1 PZ=5.5,0*5.5,3.9"
%     char  strna "P=0,0,5.40 IDMOD=0,0,1 PZ=6.5,6.5,4.9"
%   elseifd bigbas==4&(tpdc==2|tpdc==4) & tpda==2 & gwbas
%     char  basc "RSMH=1.6,1.6,1.6,1.6,1.6 EH=-.2,-.2,-.2,-.2,-.2 RSMH2=1.4,1.4,1.0,1.4 EH2=-1,-1,-1,-1"
%     char  basa "RSMH=1.5,1.5,1.5,1.5,1.5 EH=-.4,-.2,-.2,-.2,-.2 RSMH2=1.2,1.2,0.8,1.2 EH2=-1.1,-1,-1.3,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.2,-.2,-.2,-.2"
%   elseifd bigbas==3&(tpdc==2|tpdc==4) & tpda==2 & gwbas
%     char  basc "RSMH=1.6,1.6,1.6,1.6,1.6 EH=-.2,-.2,-.2,-.2,-.2 RSMH2=1.4,1.4,1 EH2=-1,-1,-1"
%     char  basa "RSMH=1.5,1.5,1.5,1.5,1.5 EH=-.4,-.2,-.2,-.2,-.2 RSMH2=1.2,1.2,0.8 EH2=-1.1,-1,-1.3"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.2,-.2,-.2,-.2"
%   elseifd bigbas==3&(tpdc==2|tpdc==4) & tpda==2
%     char  basc "RSMH=1.6,1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1,-.1 RSMH2=1.4,1.4,1 EH2=-1,-1,-1"
%     char  basa "RSMH=1.5,1.5,1.5,1.5,1.5 EH=-.4,-.1,-.1,-.1,-.1 RSMH2=1.2,1.2,0.8 EH2=-1.1,-1,-1.3"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas==2&(tpdc==2|tpdc==4) & tpda==2 & gwbas
%     char  basc "RSMH=1.6,1.6,1.6,1.6 EH=-.2,-.2,-.2,-.2 RSMH2=1.4,1.4,1 EH2=-1,-1,-1"
%     char  basa "RSMH=1.5,1.5,1.5,1.5 EH=-.4,-.2,-.2,-.2 RSMH2=1.2,1.2,0.8 EH2=-1.1,-1,-1.3"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.2,-.2,-.2,-.2"
%   elseifd bigbas==2&(tpdc==2|tpdc==4) & tpda==2
%     char  basc "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1 RSMH2=1.4,1.4,1 EH2=-1,-1,-1"
%     char  basa "RSMH=1.5,1.5,1.5,1.5 EH=-.4,-.1,-.1,-.1 RSMH2=1.2,1.2,0.8 EH2=-1.1,-1,-1.3"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas==2&(tpdc==2|tpdc==4)
%     char  basc "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1 RSMH2=1.4,1.4,1 EH2=-1,-1,-1"
%     char  basa "RSMH=1.5,1.5,1.5,1.5 EH=-.6,-.1,-.1,-.1 RSMH2=1.2,1.2,1.2,0 EH2=-1,-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas==2&(tpdc==1)
%     char  basc "RSMH=1.6,1.6,0.9,1.6 EH=-.1,-.1,-.5,-.1 RSMH2=1.5,0,.9 EH2=-1,-1,-1.5"
%     char  basa "RSMH=1.5,1.5,1.5,1.5 EH=-.6,-.1,-.1,-.1 RSMH2=1.5,1.5,1.5,0 EH2=-1,-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas==2&tpdc==0
%     char  basc "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1 RSMH2=1.5,1.5,1.5 EH2=-1,-1,-1"
%     char  basa "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1 RSMH2=1.5,1.5,1.5 EH2=-1,-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas&(tpdc==2|tpdc==4)
%     char  basc "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1 RSMH2=1.4,0,1 EH2=-1,-1,-1"
%     char  basa "RSMH=1.5,1.5,1.5,1.5 EH=-.6,-.1,-.1,-.1 RSMH2=1.2,1.2,0,0 EH2=-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   elseifd (tpdc==2|tpdc==4)
%     char  basc "RSMH=1.6,1.6,0.9,1.6 EH=-.1,-.1,-.7,-.1"
%     char  basa "RSMH=1.5,1.5,1.5,1.5 EH=-.6,-.1,-.1,-.1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas&(tpdc==1)
%     char  basc "RSMH=1.6,1.6,0.9,1.6 EH=-.1,-.1,-.5,-.1 RSMH2=1.5,0,.9 EH2=-1,-1,-2"
%     char  basa "RSMH=1.5,1.5,1.5,1.5 EH=-.6,-.1,-.1,-.1 RSMH2=1.5,1.5,0,0 EH2=-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   elseifd (tpdc==1)
%     char  basc "RSMH=1.6,1.6,0.9,1.6 EH=-.1,-.1,-.7,-.1"
%     char  basa "RSMH=1.5,1.5,1.5,1.5 EH=-.6,-.1,-.1,-.1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   elseifd tpdc>0
%     stop 1 basis not built for this case
%   elseifd bigbas
%     char  basc "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1 RSMH2=1.5,1.5 EH2=-1,-1"
%     char  basa "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1 RSMH2=1.5,1.5 EH2=-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   else
%     char  basc "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1"
%     char  basa "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   endif
% elseifd cmpd=='InSb'
%   const tpan=t metal=t azb=12.23
%   ifdef tpdc==1
%     char  strnc "P=0,0,4.9"
%   elseifd tpdc==2
%     char  strnc "P=0,0,5.30 PZ=0,0,4.9"
%     ifdef tpda==2
%     char  strna "P=0,0,5.40 IDMOD=0,0,1 PZ=6.5,0,4.9"
%     else
%     char  strna "P=0,0,5.30 IDMOD=0,0,1 PZ=6.5"
%     endif
%   elseifd tpdc==4
%     char  strnc "PZ=0,0,5.30 P=0,0,4.9"
%     ifdef tpda==2
%     char  strna "P=0,0,5.40 IDMOD=0,0,1 PZ=6.5,0,4.9"
%     else
%     char  strna "P=0,0,5.30 IDMOD=0,0,1 PZ=6.5"
%     endif
%   elseif bigbas<=10
%     char  strnc "P=0,0,5.25 IDMOD=0,0,1"
%    stop 1 In 5d is perilous in InSb!.  Delete this line if you really want it.
%   endif
%   char0 strna "P=0,0,5.30 IDMOD=0,0,1"
%   ifdef ofp
%   char  strnc "CLINK=0 0 0 -1.75 -2.3 -.65" strna "CLINK=0 0 0 -1.6 -1.9 1.5"
%   elseifd asa
%   else
%   ifdef tppc==3|tpdc==3|tpda==3
%     const ngd=20
%   elseifd tpdc>0
%     const ngd=27
%   else
%     const ngd=16
%   endif
%   ifdef f
%   elseifd bigbas==12
%     char  basc "RSMH=1.9,1.9,1.9,{lfc?1.9:0},{lgc?1.9:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.1,1.1,1.1 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8}"
%     char  basa "RSMH=1.6,1.6,1.6,{lfa?1.6:0},{lga?1.6:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     char  basa "{basa} RSMH2=1.6,1.6,1.6 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  strnc "P=0,0,5.30,4.15,5.12 IDMOD=0 0 0 1 1 PZ={tpsc==4?6.5:0},{tppc==4?6.5:0},{tpdc==3?14.93:0}"
%     char  strna "P=0,0,5.40,4.15,5.12 IDMOD=0 0 0 1 1 PZ={tpsa==4?6.5:0},{tppa==4?6.5:0},{tpda==3?14.94:0}"
%   elseifd bigbas==11
%     char  basc "RSMH=1.9,1.9,1.9,{lfc?1.9:0},{lgc?1.9:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.1,0,1.1 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8}"
%     char  basa "RSMH=1.6,1.6,1.6,{lfa?1.6:0},{lga?1.6:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     char  basa "{basa} RSMH2=1.6,1.6,1.6 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.6,1.6,1.6,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  strnc "P=0,0,5.30,4.15,5.12 IDMOD=0 0 0 1 1 PZ={tpsc==4?6.5:0},{tppc==4?6.5:0},{tpdc==3?14.93:0}"
%     char  strna "P=0,0,5.40,4.15,5.12 IDMOD=0 0 0 1 1 PZ={tpsa==4?6.5:0},{tppa==4?6.5:0},{tpda==3?14.94:0}"
%   elseifd bigbas==5&(tpdc==2|tpdc==4) & tpda==2 & gwbas
%     char  basc "RSMH=1.7,1.7,1.8,1.7,1.7 EH=-.2,-.2,-.2,-.2,-.2 RSMH2=1.7,1.7,0.9,1.7 EH2=-1,-1,-.8,-1"
%     char  basa "RSMH=1.6,1.6,1.6,1.6,1.7 EH=-.3,-.2,-.2,-.2,-.2 RSMH2=1.6,1.6,0.8,1.6 EH2=-1,-1,-1.3,-1"
%     char  base "RSMH=1.6,1.6,1.6,1.6 EH=-.2,-.2,-.2,-.2"
%     char  strnc "P=0,0,5.30 PZ=6.5,6.5,4.9"
%     char  strna "P=0,0,5.40 IDMOD=0,0,1 PZ=6.5,6.5,4.9"
%   elseifd bigbas==4&(tpdc==2|tpdc==4) & tpda==2 & gwbas
%     char  basc "RSMH=1.7,1.7,1.8,1.7,1.7 EH=-.2,-.2,-.2,-.2,-.2 RSMH2=1.7,1.7,0.9,1.7 EH2=-1,-1,-.8,-1"
%     char  basa "RSMH=1.6,1.6,1.6,1.6,1.7 EH=-.3,-.2,-.2,-.2,-.2 RSMH2=1.6,1.6,0.8,1.6 EH2=-1,-1,-1.3,-1"
%     char  base "RSMH=1.6,1.6,1.6,1.6 EH=-.2,-.2,-.2,-.2"
%   elseifd bigbas==5&(tpdc==2|tpdc==4) & tpda==2
%     char  basc "RSMH=1.7,1.7,1.8,1.7,1.7 EH=-.1,-.1,-.1,-.1,-.1 RSMH2=1.7,1.7,0.9,1.7 EH2=-1,-1,-.8,-1"
%     char  basa "RSMH=1.6,1.6,1.6,1.6,1.7 EH=-.3,-.1,-.1,-.1,-.1 RSMH2=1.6,1.6,0.8,1.6 EH2=-1,-1,-1.3,-1"
%     char  base "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1"
%     char  strnc "P=0,0,5.30 PZ=6.5,6.5,4.9"
%     char  strna "P=0,0,5.40 IDMOD=0,0,1 PZ=6.5,6.5,4.9"
%   elseifd bigbas==4&(tpdc==2|tpdc==4) & tpda==2
%     char  basc "RSMH=1.7,1.7,1.8,1.7,1.7 EH=-.1,-.1,-.1,-.1,-.1 RSMH2=1.7,1.7,0.9,1.7 EH2=-1,-1,-.8,-1"
%     char  basa "RSMH=1.6,1.6,1.6,1.6,1.7 EH=-.3,-.1,-.1,-.1,-.1 RSMH2=1.6,1.6,0.8,1.6 EH2=-1,-1,-1.3,-1"
%     char  base "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas==3&(tpdc==2|tpdc==4) & tpda==2 & gwbas
%     char  basc "RSMH=1.7,1.7,1.8,1.7,1.7 EH=-.2,-.2,-.2,-.2,-.2 RSMH2=1.7,1.7,0.9 EH2=-1,-1,-.8"
%     char  basa "RSMH=1.6,1.6,1.6,1.6,1.7 EH=-.3,-.2,-.2,-.2,-.2 RSMH2=1.6,1.6,0.8 EH2=-1,-1,-1.3"
%     char  base "RSMH=1.6,1.6,1.6,1.6 EH=-.2,-.2,-.2,-.2"
%   elseifd bigbas==3&(tpdc==2|tpdc==4) & tpda==2
%     char  basc "RSMH=1.7,1.7,1.8,1.7,1.7 EH=-.1,-.1,-.1,-.1,-.1 RSMH2=1.7,1.7,0.9 EH2=-1,-1,-.8"
%     char  basa "RSMH=1.6,1.6,1.6,1.6,1.7 EH=-.3,-.1,-.1,-.1,-.1 RSMH2=1.6,1.6,0.8 EH2=-1,-1,-1.3"
%     char  base "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas==2&(tpdc==2|tpdc==4) & tpda==2 & gwbas
%     char  basc "RSMH=1.7,1.7,1.8,1.7 EH=-.2,-.2,-.2,-.2 RSMH2=1.7,1.7,0.9 EH2=-1,-1,-.8"
%     char  basa "RSMH=1.6,1.6,1.6,1.6 EH=-.3,-.2,-.2,-.2 RSMH2=1.6,1.6,0.8 EH2=-1,-1,-1.3"
%     char  base "RSMH=1.6,1.6,1.6,1.6 EH=-.2,-.2,-.2,-.2"
%   elseifd bigbas==2&(tpdc==2|tpdc==4) & tpda==2
%     char  basc "RSMH=1.7,1.7,1.8,1.7 EH=-.1,-.1,-.1,-.1 RSMH2=1.7,1.7,0.9 EH2=-1,-1,-.8"
%     char  basa "RSMH=1.6,1.6,1.6,1.6 EH=-.3,-.1,-.1,-.1 RSMH2=1.6,1.6,0.8 EH2=-1,-1,-1.3"
%     char  base "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1"
%   elseifd tpda==2
%     stop 1 basis not built for this case
%   elseifd bigbas==2&(tpdc==2|tpdc==4)
%     char  basc "RSMH=1.7,1.7,1.8,1.7 EH=-.1,-.1,-.1,-.1 RSMH2=1.7,1.7,0.9 EH2=-1,-1,-.8"
%     char  basa "RSMH=1.7,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1 RSMH2=1.6,1.6,1.6 EH2=-1,-1,-1"
%     char  base "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas==2
%     char  basc "RSMH=1.7,1.7,1.7,1.7 EH=-.2,-.1,-.1,-.1 RSMH2=1.7,1.7,1.7 EH2=-1,-1,-1"
%     char  basa "RSMH=1.7,1.6,1.6,1.6 EH=-.2,-.1,-.1,-.1 RSMH2=1.6,1.6,1.6 EH2=-1,-1,-1"
%     char  base "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas&(tpdc==2|tpdc==4)
%     char  basc "RSMH=1.7,1.7,1.8,1.7 EH=-.1,-.1,-.1,-.1 RSMH2=1.7,1.7,0.9 EH2=-1,-1,-.8"
%     char  basa "RSMH=1.7,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1 RSMH2=1.6,1.6 EH2=-1,-1"
%     char  base "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1"
%   elseifd (tpdc==2|tpdc==4)
%     char  basc "RSMH=1.7,1.7,0.9,1.7 EH=-.6,-.1,-.1,-.1"
%     char  basa "RSMH=1.7,1.6,1.6,1.6 EH=-.6,-.1,-.1,-.1"
%     char  base "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas&tpdc==1
%     char  basc "RSMH=1.7,1.7,0.9,1.7 EH=-.2,-.1,-.5,-.1 RSMH2=1.7,1.7,0.9 EH2=-1,-1,-1.5"
%     char  basa "RSMH=1.7,1.6,1.6,1.3*1 EH=-.1,-.1,-.1,-.1 RSMH2=1.6,1.6 EH2=-1,-1"
%     char  base "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1"
%   elseifd tpdc>0
%     stop 1 basis not built for this case
%   elseifd bigbas
%     char  basc "RSMH=1.7,1.7,1.7,1.7 EH=-.2,-.1,-.1,-.1 RSMH2=1.7,1.7 EH2=-1,-1"
%     char  basa "RSMH=1.7,1.6,1.6,1.6 EH=-.2,-.1,-.1,-.1 RSMH2=1.6,1.6 EH2=-1,-1"
%     char  base "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1"
%   else
%     char  basc "RSMH=1.7,1.7,1.7,1.7 EH=-.6,-.1,-.1,-.1"
%     char  basa "RSMH=1.7,1.6,1.6,1.6 EH=-.6,-.1,-.1,-.1"
%     char  base "RSMH=1.6,1.6,1.6,1.6 EH=-.1,-.1,-.1,-.1"
%   endif
%   endif
% elseifd cmpd=='TlSb'
%   const tpan=t metal=t azb=12.23
%   char  linkc "0 0 0 -1.7 -2.3 -.9"  linka "0 0 0 -1.6 -1.9 1.5"
% elseifd cmpd=='InTlSb'
%   const tpan=t metal=t azb=12.23 Zb=81
% elseifd cmpd=='ZnS'
#   RT lattice constant from Adachi
#   a=3.8226/.5292 q=6.2605/3.8226=1.638 azb=5.410/.5292 = 10.223
%   const tpan=f metal=f azb=10.23 gmax=9
%   ifdef strx=='WZ' | strx=='wzx'
%     const lmbec=-1
%   endif
%   char  strnc "P={pval(tpsc,0,3.94,5.5)},{pval(tppc,0,3.93,5.5)},{pval(tpdc,3.91,3.91,4.4)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,3.94,5.5)},{ploc(tppc,0,3.93,5.5)},{ploc(tpdc,0,3.91,4.4)} IDMOD=0,0,0,1,1"
%   char  strna "P={pval(tpsa,0,3.88,4.5)},0,{pval(tpda,3.3,2.95,3.4)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,3.88,4.5)},0,{ploc(tpda,3.3,2.95,3.4)} IDMOD=0,0,{tpda==0?1:0},1,1"
%   ifdef tpdc==4&bigbas<10
%     char strnc "PZ=0,0,4.3"
%     ifdef bigbas>=3
%       char strna "PZ=4.5"
%     endif
%   endif
%   ifdef f
#   Patterned after bigbas11 in CdTe
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.5,1.5,0.90,{lfc?1.5:0},{lgc?1.5:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef f
%     elseif bigbas==11
%     char  basc "{basc} RSMH2=1.5,0,0.90 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.5,1.5,0.90 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     endif
%     char  basa "RSMH=1.2,1.2,1.2,{lfa?1.2:0},{lga?1.2:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     char  basa "{basa} RSMH2=1.2,1.2,1.2 EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.2,1.2,1.2,1.2*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==4&gwbas
%     char  basc "RSMH=1.5,1.5,0.9,1.5,1.5 EH=-.2,-.2,-.3,-.2,-.2 RSMH2=1.2,1.2,0.9,1.2 EH2=-1,-1,-1,-1"
%     char  basa "RSMH=1.2,1.2,1.2,1.2,1.2 EH=-.5,-.2,-.2,-.2,-.2 RSMH2=1.2,1.2,1.2,1.2 EH2=-1.2,-1,-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.2,-.2,-.2,-.2"
%   elseifd bigbas==3&gwbas
%     char  basc "RSMH=1.5,1.5,0.9,1.5,1.5 EH=-.2,-.2,-.3,-.2,-.2 RSMH2=1.2,1.2,0.9 EH2=-1,-1,-1"
%     char  basa "RSMH=1.2,1.2,1.2,1.2,1.2 EH=-.5,-.2,-.2,-.2,-.2 RSMH2=1.2,1.2,1.2 EH2=-1.2,-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.2,-.2,-.2,-.2"
%   elseifd bigbas==2&gwbas
%     char  basc "RSMH=1.5,1.5,0.9,1.5 EH=-.2,-.2,-.3,-.2 RSMH2=1.2,1.2,0.9 EH2=-1,-1,-1"
%     char  basa "RSMH=1.2,1.2,1.2,1.2 EH=-.5,-.2,-.2,-.2 RSMH2=1.2,1.2,1.2 EH2=-1.2,-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.2,-.2,-.2,-.2"
%   elseifd bigbas==2
%     char  basc "RSMH=1.5,1.5,0.9,1.5 EH=-.1,-.1,-.3,-.1 RSMH2=1.2,1.2,0.9 EH2=-1,-1,-1"
%     char  basa "RSMH=1.2,1.2,1.2,1.2 EH=-.5,-.1,-.1,-.1 RSMH2=1.2,1.2,1.2 EH2=-1.2,-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas&gwbas
%     char  basc "RSMH=1.5,1.5,0.9,1.5 EH=-.2,-.2,-.3,-.2 RSMH2=1.2,1.2,0.9 EH2=-1,-1,-1"
%     char  basa "RSMH=1.2,1.2,1.2,1.2 EH=-.5,-.2,-.2,-.2 RSMH2=1.2,1.2,0 EH2=-1.2,-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.2,-.2,-.2,-.2"
%   elseifd bigbas
%     char  basc "RSMH=1.5,1.5,0.9,1.5 EH=-.1,-.1,-.3,-.1 RSMH2=1.2,1.2,0.9 EH2=-1,-1,-1"
%     char  basa "RSMH=1.2,1.2,1.2,1.2 EH=-.5,-.1,-.1,-.1 RSMH2=1.2,1.2,0 EH2=-1.2,-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.1,-.1,-.1,-.1"
%   else
%     char  basc "RSMH=1.5,1.5,0.9,1.5 EH=-.5,-.1,-.4,-.1"
%     char  basa "RSMH=1.2,1.2,1.2,1.2 EH=-.7,-.1,-.1,-.1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.1,-.1,-.1,-.1"
%   endif
% elseifd cmpd=='CdS' | cmpd=='HgS'
#   RT lattice constant from Adachi: awz=4.1367/.5292 q=6.7161/4.1367 azb=5.825/.5292 = 11.007
%   ifdef cmpd=='CdS'
%   const tpan=f metal=f azb=11.01 awz=4.1369/.529 q=6.7161/4.1369 xwz=0 gmax=9
%   else
%   const tpan=f metal=t azb=11.06
%   endif
%   ifdef cmpd=='CdS'
%   char  strnc "P={pval(tpsc,0,4.94,6.5)},{pval(tppc,0,4.93,6.5)},{pval(tpdc,4.91,4.91,5.4)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,4.94,6.5)},{ploc(tppc,0,4.93,6.5)},{ploc(tpdc,0,4.91,5.4)} IDMOD=0,0,0,1,1"
%   else
%   char  strnc "P={pval(tpsc,0,5.94,7.5)},{pval(tppc,0,5.93,7.5)},{pval(tpdc,5.91,5.91,6.4)},5.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,5.94,7.5)},{ploc(tppc,0,5.93,7.5)},{ploc(tpdc,0,5.91,6.4)} IDMOD=0,0,0,1,1"
%   endif
%   char  strna "P={pval(tpsa,0,3.88,4.5)},0,{pval(tpda,3.3,2.95,3.4)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,3.88,4.5)},0,{ploc(tpda,3.3,2.95,3.4)} IDMOD=0,0,{tpda==0?1:0},1,1"
%   ifdef strx=='WZ' | strx=='wzx'
%     const lmbec=-1
%   endif
%   ifdef f
#   Patterned after bigbas11 in CdTe
%   elseifd bigbas==11 | bigbas==12 | bigbas==13
%     char  basc "RSMH=1.6,1.6,0.90,{lfc?1.6:0},{lgc?1.6:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef f
%     elseif bigbas==11
%     char  basc "{basc} RSMH2=1.5,0,0.90 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.5,1.5,0.90 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==13
%     char  basc "{basc} RSMH2=1.5,1.5,0.90,1.5 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     endif
%     char  basa "RSMH=1.3,1.3,1.3,{lfa?1.3:0},{lga?1.3:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     char  basa "{basa} RSMH2=1.3,1.3,1.3 EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==4&gwbas
%     char  basc "RSMH=1.6,1.6,0.9,1.6,1.6 EH=-.2,-.2,-.5,-.2,-.2 RSMH2=1.2,1.2,0.9,0.9 EH2=-1.2,-1.2,-1.2,-1.2"
%     char  basa "RSMH=1.2,1.3,1.3,1.3,1.3 EH=-.5,-.2,-.2,-.2,-.2 RSMH2=1.2,1.3,1.3,1.3 EH2=-1.2,-1,-1,-1"
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH=-.2,-.2,-.2,-.2"
%   elseifd bigbas==3&gwbas
%     char  basc "RSMH=1.6,1.6,0.9,1.6,1.6 EH=-.2,-.2,-.5,-.2,-.2 RSMH2=1.2,1.2,0.9 EH2=-1.2,-1.2,-1.2"
%     char  basa "RSMH=1.2,1.3,1.3,1.3,1.3 EH=-.5,-.2,-.2,-.2,-.2 RSMH2=1.2,1.3,1.3 EH2=-1.2,-1.,-1."
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH=-.2,-.2,-.2,-.2"
%   elseifd bigbas==2&gwbas
%     char  basc "RSMH=1.6,1.6,0.9,1.6 EH=-.2,-.2,-.5,-.2 RSMH2=1.2,1.2,0.9 EH2=-1.2,-1.2,-1.2"
%     char  basa "RSMH=1.2,1.3,1.3,1.3 EH=-.5,-.2,-.2,-.2 RSMH2=1.2,1.3,1.3 EH2=-1.2,-1.,-1."
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH=-.2,-.2,-.2,-.2"
%   elseifd bigbas==3
%     char  basc "RSMH=1.6,1.6,0.9,1.6,1.6 EH=-.1,-.1,-.5,-.1,-.1 RSMH2=1.2,1.2,0.9 EH2=-1.2,-1.2,-1.2"
%     char  basa "RSMH=1.2,1.3,1.3,1.3,1.3 EH=-.5,-.1,-.1,-.1,-.1 RSMH2=1.2,1.3,1.3 EH2=-1.2,-1.,-1."
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas==2
%     char  basc "RSMH=1.6,1.6,0.9,1.6 EH=-.1,-.1,-.5,-.1 RSMH2=1.2,1.2,0.9 EH2=-1.2,-1.2,-1.2"
%     char  basa "RSMH=1.2,1.3,1.3,1.3 EH=-.5,-.1,-.1,-.1 RSMH2=1.2,1.3,1.3 EH2=-1.2,-1.,-1."
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas&gwbas
%     char  basc "RSMH=1.6,1.6,0.9,1.6 EH=-.2,-.2,-.5,-.2 RSMH2=1.2,1.2,0.9 EH2=-1.2,-1.2,-1.2"
%     char  basa "RSMH=1.2,1.3,1.3,1.3 EH=-.5,-.2,-.2,-.2 RSMH2=0.0,1.3,0 EH2=-1.,-1.,-1."
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH=-.2,-.2,-.2,-.2"
%   elseifd bigbas
%     char  basc "RSMH=1.6,1.6,0.9,1.6 EH=-.1,-.1,-.5,-.1 RSMH2=1.2,1.2,0.9 EH2=-1.2,-1.2,-1.2"
%     char  basa "RSMH=1.2,1.3,1.3,1.3 EH=-.5,-.1,-.1,-.1 RSMH2=0.0,1.3,0 EH2=-1.,-1.,-1."
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH=-.1,-.1,-.1,-.1"
%   else
%     char  basc "RSMH=1.6,1.6,0.9,1.6 EH=-.5,-.1,-.5,-.1"
%     char  basa "RSMH=1.2,1.3,1.3,1.3 EH=-.8,-.1,-.1,-.1"
%     char  base "RSMH=1.3,1.3,1.3,1.3 EH=-.1,-.1,-.1,-.1"
%   endif
% elseifd cmpd=='MgS' | cmpd=='MgSe'
%   ifdef cmpd=='MgS'
#   RT lattice constant from Adachi: a=5.62/.5292
%   const tpan=0 metal=f azb=5.62/.5292
%   else
#   RT lattice constant from Adachi
%   const tpan=0 metal=f azb=5.91/.5292
%   endif
%   char  strnc "P={pval(tpsc,0,2.94,3.5)},{pval(tppc,0,2.94,3.5)},3.3,4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,2.94,3.5)},{ploc(tppc,0,2.94,3.5)},{ploc(tpdc,0,0,4.15)} IDMOD=0,0,1,1,1"
%   ifdef cmpd=='MgS'
%   char  strna "P={pval(tpsa,0,3.88,4.5)},0,{pval(tpda,3.3,2.95,3.4)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,3.88,4.5)},0,{ploc(tpda,3.3,2.95,3.4)} IDMOD=0,0,{tpda==0?1:0},1,1"
%   else
%   char  strna "P={pval(tpsa,0,4.88,5.5)},0,{pval(tpda,4.3,3.95,4.4)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,4.88,5.5)},0,{ploc(tpda,4.3,3.95,4.4)} IDMOD=0,0,{tpda==0?1:0},1,1"
%   endif
%   ifdef tpsc==2 | tpsc==3
%   char  strnc "{strnc} Q=0,0,0"
%   endif
%   ifdef tpsc+tppc>0
%     const ngd=24
%     char  strnc "{strnc} RS3=.80"
%   else
%     const ngd=20
%   endif
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.6,1.6,1.6,{lfc?1.6:0},{lgc?1.6:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.6,{tppc==2?.8:{bigbas==11?0:1.6}},1.6 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.80"
%     char  basa "RSMH=1.5,1.5,1.5,{lfa?1.5:0},{lga?1.5:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=0.95"
%     char  basa "{basa} RSMH2=1.5,1.5,1.5 EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   endif
% elseifd cmpd=='ZnSe'
#   RT lattice constant from Adachi: a=5.669/.5292 = 10.712
%   const tpan=t metal=f azb=10.71 gmax=9
%   ifdef strx=='WZ' | strx=='wzx'
%     const lmbec=-1
%     const ngd=40
%   endif
%   char  strnc "P={pval(tpsc,0,3.94,5.5)},{pval(tppc,0,3.93,5.5)},{pval(tpdc,3.91,3.91,4.4)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,3.94,5.5)},{ploc(tppc,0,3.93,5.5)},{ploc(tpdc,0,3.91,4.4)} IDMOD=0,0,0,1,1"
%   char  strna "P={pval(tpsa,0,4.88,5.5)},0,{pval(tpda,4.3,3.95,4.4)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,4.88,5.5)},0,{ploc(tpda,4.3,3.95,4.4)} IDMOD=0,0,{tpda==0?1:0},1,1"
%   const ngd=25
%   ifdef f
#   Patterned after bigbas11 in CdTe
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.5,1.5,0.90,{lfc?1.5:0},{lgc?1.5:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef f
%     elseif bigbas==11
%     char  basc "{basc} RSMH2=1.5,0,0.90 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.5,1.5,0.90 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     endif
%     char  basa "RSMH=1.5,1.9,1.9,{lfa?1.9:0},{lga?1.9:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=.9"
%     char  basa "{basa} RSMH2=1.2,1.2,1.2 EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==4&gwbas
%     char  basc "RSMH=1.5,1.5,0.9,1.5,1.5 EH=-.2,-.2,-.3,-.2,-.2 RSMH2=1.2,1.2,0.9,1.2 EH2=-1,-1,-1,-1"
%     char  basa "RSMH=1.2,1.2,1.2,1.2,1.2 EH=-.5,-.2,-.2,-.2,-.2 RSMH2=1.2,1.2,1.2,1.2 EH2=-1.2,-1,-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.2,-.2,-.2,-.2"
%   elseifd bigbas==3&gwbas
%     char  basc "RSMH=1.5,1.5,0.9,1.5,1.5 EH=-.2,-.2,-.3,-.2,-.2 RSMH2=1.2,1.2,0.9 EH2=-1,-1,-1"
%     char  basa "RSMH=1.2,1.2,1.2,1.2,1.2 EH=-.5,-.2,-.2,-.2,-.2 RSMH2=1.2,1.2,1.2 EH2=-1.2,-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.2,-.2,-.2,-.2"
%   elseifd bigbas==2&gwbas
%     char  basc "RSMH=1.5,1.5,0.9,1.5 EH=-.2,-.2,-.3,-.2 RSMH2=1.2,1.2,0.9 EH2=-1,-1,-1"
%     char  basa "RSMH=1.2,1.2,1.2,1.2 EH=-.5,-.2,-.2,-.2 RSMH2=1.2,1.2,1.2 EH2=-1.2,-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.2,-.2,-.2,-.2"
%   elseifd bigbas==3
%     char  basc "RSMH=1.5,1.5,0.9,1.5,1.5 EH=-.1,-.1,-.3,-.1,-.1 RSMH2=1.2,1.2,0.9 EH2=-1,-1,-1"
%     char  basa "RSMH=1.2,1.2,1.2,1.2,1.2 EH=-.5,-.1,-.1,-.1,-.1 RSMH2=1.2,1.2,1.2 EH2=-1.2,-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas==2
%     char  basc "RSMH=1.5,1.5,0.9,1.5 EH=-.1,-.1,-.3,-.1 RSMH2=1.2,1.2,0.9 EH2=-1,-1,-1"
%     char  basa "RSMH=1.2,1.2,1.2,1.2 EH=-.5,-.1,-.1,-.1 RSMH2=1.2,1.2,1.2 EH2=-1.2,-1,-1"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH=-.1,-.1,-.1,-.1"
%   elseifd bigbas&gwbas
%     char  basc "RSMH=1.5,1.5,0.9,1.5 EH=-.3,-.2,-.3,-.2 RSMH2=1.5,0.0,0.9 EH2=-1,-1,-1"
%     char  basa "RSMH=1.2,1.2,1.2,1.2 EH=-.6,-.2,-.2,-.2 RSMH2=1.5,1.5 EH2=-1.2,-1"
%     char  base "RSMH=1.4,1.4,1.4,1.4 EH=-.2,-.2,-.2,-.2"
%   elseifd bigbas
%     char  basc "RSMH=1.5,1.5,0.9,1.5 EH=-.3,-.1,-.3,-.1 RSMH2=1.5,0.0,0.9 EH2=-1,-1,-1"
%     char  basa "RSMH=1.2,1.2,1.2,1.2 EH=-.6,-.1,-.1,-.1 RSMH2=1.5,1.5 EH2=-1.2,-1"
%     char  base "RSMH=1.4,1.4,1.4,1.4 EH=-.1,-.1,-.1,-.1"
%   else
%     char  basc "RSMH=1.5,1.5,0.9,1.5 EH=-.5,-.1,-.4,-.1"
%     char  basa "RSMH=1.3,1.3,1.3,1.3 EH=-.8,-.1,-.1,-.1"
%     char  base "RSMH=1.4,1.4,1.4,1.4 EH=-.1,-.1,-.1,-.1"
%   endif
% elseifd cmpd=='CdSe' | cmpd=='HgSe'
#   RT lattice constant from Adachi: awz=4.2999/.5292 q=7.0109/4.2999 = 1.6305 azb=6.077/.5292 = 11.48
#   Lattice parameters from Chen and Sher, Table 1.1 xwz from LDA calc of zero force.
%   ifdef cmpd=='CdSe'
%   const tpan=t metal=f azb=11.44 q=1.631 awz=azb/sqrt(2)*(sqrt(8/3)/q)^(1/3) xwz=0.0033
%   else
%   const tpan=t metal=t azb=11.50
%   endif
%   ifdef strx=='WZ' | strx=='wzx'
%     const lmbec=-1
%     const ngd=40
%   endif
%   const ngd=25
%   ifdef cmpd=='CdSe'
%   char  strnc "P={pval(tpsc,0,4.94,6.5)},{pval(tppc,0,4.93,6.5)},{pval(tpdc,4.91,4.91,5.4)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,4.94,6.5)},{ploc(tppc,0,4.93,6.5)},{ploc(tpdc,0,4.91,5.4)} IDMOD=0,0,0,1,1"
%   else
%   char  strnc "P={pval(tpsc,0,5.94,7.5)},{pval(tppc,0,5.93,7.5)},{pval(tpdc,5.91,5.91,6.4)},5.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,5.94,7.5)},{ploc(tppc,0,5.93,7.5)},{ploc(tpdc,0,5.91,6.4)} IDMOD=0,0,0,1,1"
%   endif
%   char  strna "P={pval(tpsa,0,4.88,5.5)},0,{pval(tpda,4.3,3.95,4.4)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,4.88,5.5)},0,{ploc(tpda,4.3,3.95,4.4)} IDMOD=0,0,{tpda==0?1:0},1,1"
%   ifdef f
#   Patterned after bigbas11 in InP, InAs, GaAs, except Cd d orbital always 4d
%   elseifd bigbas==11 | bigbas==12 | bigbas==13
%     char  basc "RSMH=1.7,1.7,0.90,{lfc?1.7:0},{lgc?1.7:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef f
%     elseif bigbas==11
%     char  basc "{basc} RSMH2=1.5,0,0.90 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.5,1.5,0.90 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==13
%     char  basc "{basc} RSMH2=1.5,1.5,0.90,1.5 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     endif
%     char  basa "RSMH=1.5,1.7,1.7,{lfa?1.7:0},{lga?1.7:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     char  basa "{basa} RSMH2=1.3,1.7,1.7 EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas
%     stop 1 'this basis never checked for CdSe'
%     ifdef tpdc==4
%       char  basc "RSMH=1.2,1.2,0.9,1.2 EH=-.1,-.1,-.1,-.1 RSMH2=1.2,1.2,0.9 EH2=-1,-1,-1 PZ=0,0,5.4 IDMOD=0,0,1"
%       char  basa "P=0,0,5.3 IDMOD=0,0,1 RSMH=1.5,1.7,1.7,1.7 EH=-.6,-.1,-.1,-.1 RSMH2=0.0,1.7,0 EH2=-1,-1,-1"
%       char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%     else
%       char  basc "RSMH=1.2,1.2,0.9,1.2 EH=-.1,-.1,-.1,-.1 RSMH2=1.2,1.2,0.9 EH2=-1,-1,-1"
%       char  basa "P=0,0,5.25 IDMOD=0,0,1 RSMH=1.5,1.7,1.7,1.7 EH=-.6,-.1,-.1,-.1 RSMH2=0.0,1.7,0 EH2=-1,-1,-1"
%       char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%     endif
%   else
%     stop 1 'this basis never checked for CdSe'
%     const ngd=25
%     char  basc "RSMH=1.2,1.2,0.9,1.2 EH=-.1,-.1,-.1,-.1"
%     char  basa "P=0,0,5.25 IDMOD=0,0,1 RSMH=1.5,1.7,1.7,1.7 EH=-.6,-.1,-.1,-.1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   endif
% elseifd cmpd=='BeS' | cmpd=='BeSe' | cmpd=='BeTe'
%   ifdef cmpd=='BeS'
%   const tpan=0 metal=f azb=4.865/.5292
%   elseifd cmpd=='BeSe'
#   lattice constant from PRB52, 7058 (1995)
%   const tpan=0 metal=f azb=5.137/.5292
%   else
#   lattice constant from PRB52, 7058 (1995) : 5.617
%   const tpan=0 metal=f azb=5.627/.5292 gmax=8
%   endif
%   char  strnc          "P={pval(tpsc,2.75,2.75,2.75)},{pval(tppc,2.60,2.60,2.60)},{pval(tpdc,3.25,3.25,3.25)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,2.75,2.75,3.50)},{ploc(tppc,2.60,2.60,3.50)},{ploc(tpdc,0,0,0)} IDMOD=0,0,1,1,1"
%   ifdef cmpd=='BeS'
%   char  strna "P={pval(tpsa,0,3.88,4.5)},0,{pval(tpda,3.3,2.95,3.4)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,3.88,4.5)},0,{ploc(tpda,3.3,2.95,3.4)} IDMOD=0,0,{tpda==0?1:0},1,1"
%   elseifd cmpd=='BeSe'
%   char  strna "P={pval(tpsa,0,4.88,5.5)},0,{pval(tpda,4.3,3.95,4.4)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,4.88,5.5)},0,{ploc(tpda,4.3,3.95,4.4)} IDMOD=0,0,{tpda==0?1:0},1,1"
%   else
%   char  strna "P={pval(tpsa,0,5.88,6.5)},0,{pval(tpda,5.3,4.94,5.4)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,5.88,6.5)},0,{ploc(tpda,5.3,4.94,5.4)} IDMOD=0,0,{tpda==0?1:0},1,1"
%   endif
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.5,1.5,1.5,{lfc?1.5:0},{lgc?1.5:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef f
%     elseif bigbas==11
%     char  basc "{basc} RSMH2=1.5,0,0 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.5,1.5,1.5 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     endif
%     char  basa "RSMH=1.5,1.5,1.5,{lfa?1.5:0},{lga?1.5:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=0.95"
%     char  basa "{basa} RSMH2=1.5,1.5,1.5 EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas
%     const ngd=18
%     char  basc "RSMH=1.4,1.4,1.4,1.4 EH=-.1,-.1,-.1,-.1 RSMH2=1.4,1.4 EH2=-1,-1,-1,-1"
%     char  basa "P=0,0,5.25 IDMOD=0,0,1 RSMH=1.4,1.4,1.4,1.4 EH=-0.7,-.1,-.1,-.1 RSMH2=0,1.4 EH2=-1,-1,-1
%     char  base "RSMH=1.4,1.4,1.4,1.4 EH=-.1,-.1,-.1,-.1"
%   else
%     const ngd=18
%     char  basc "RSMH=1.4,1.4,1.4,1.4 EH=-.1,-.1,-.1,-.1"
%     char  basa "P=0,0,5.25 IDMOD=0,0,1 RSMH=1.4,1.4,1.4,1.4 EH=-0.7,-.1,-.1,-.1"
%     char  base "RSMH=1.4,1.4,1.4,1.4 EH=-.1,-.1,-.1,-.1"
%   endif
% elseifd cmpd=='MgTe'
#   RT lattice constant from Adachi
%   const tpan=0 metal=f azb=6.42/.5292
%   char  strnc "P={pval(tpsc,0,2.94,3.5)},{pval(tppc,0,2.94,3.5)},3.3,4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,2.94,3.5)},{ploc(tppc,0,2.94,3.5)},{ploc(tpdc,0,0,4.15)} IDMOD=0,0,1,1,1"
%   char  strna "P={pval(tpsa,0,5.88,6.5)},0,{pval(tpda,5.3,4.94,5.4)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,5.88,6.5)},0,{ploc(tpda,5.3,4.94,5.4)} IDMOD=0,0,{tpda==0?1:0},1,1"
%   ifdef tpsc==2 | tpsc==3
%   char  strnc "{strnc} Q=0,0,0"
%   endif
%   ifdef tpsc+tppc>0
%     const ngd=24
%     char  strnc "{strnc} RS3=.80"
%   else
%     const ngd=20
%   endif
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.6,1.6,1.6,{lfc?1.6:0},{lgc?1.6:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.6,{tppc==2?.8:{bigbas==11?0:1.6}},1.6 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.80"
%     char  basa "RSMH=1.5,1.5,1.5,{lfa?1.5:0},{lga?1.5:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=0.95"
%     char  basa "{basa} RSMH2=1.5,1.5,1.5 EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   endif
% elseifd cmpd=='ZnTe'
%   const tpan=t metal=f azb=11.53 gmax=9
%   char  strnc "P={pval(tpsc,0,3.94,5.5)},{pval(tppc,0,3.93,5.5)},{pval(tpdc,3.91,3.91,4.4)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,3.94,5.5)},{ploc(tppc,0,3.93,5.5)},{ploc(tpdc,0,3.91,4.4)} IDMOD=0,0,0,1,1"
%   char  strna "P={pval(tpsa,0,5.88,6.5)},{pval(tppa,0,5.76,6.5)},{pval(tpda,5.3,4.95,5.4)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,5.88,6.5)},{ploc(tppa,0,5.75,6.5)},{ploc(tpda,5.3,4.95,5.4)}"
%   char  strna "{strna} IDMOD=0,0,{tpda==0?1:0},1,1"
%   ifdef f
#   Patterned after bigbas11 in CdTe
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.5,1.5,0.90,{lfc?1.5:0},{lgc?1.5:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef f
%     elseif bigbas==11
%     char  basc "{basc} RSMH2=1.5,0,0.90 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.5,1.5,0.90 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     endif
%     char  basa "RSMH=1.5,1.2,1.2,{lfa?1.2:0},{lga?1.2:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     char  basa "{basa} RSMH2=1.2,1.2,1.2 EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==4
%     char  basc "RSMH=1.5,1.5,0.9,1.5,1.5 EH={ehmax},{ehmax},-.3,{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.2,1.2,0.9,1.2 EH2=-1,-1,-1,-1"
%     char  basa "RSMH=1.5,1.5,1.5,1.5,1.5 EH=-.5,{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.5,1.5,1.5,1.5 EH2=-1.2,-1,-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==3
%     char  basc "RSMH=1.5,1.5,0.9,1.5,1.5 EH={ehmax},{ehmax},-.3,{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.5,1.5,0.9 EH2=-1,-1,-1"
%     char  basa "RSMH=1.5,1.5,1.5,1.5,1.5 EH=-.5,{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.5,1.5,1.5 EH2=-1.2,-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas==2
%     char  basc "RSMH=1.5,1.5,0.9,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.5,1.5,0.9 EH2=-1,-1,-1"
%     char  basa "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.5,1.5,1.5 EH2=-1.2,-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas
%     char  basc "RSMH=1.5,1.5,0.9,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.5,1.5,0.9 EH2=-1,-1,-1"
%     char  basa "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.5,1.5 EH2=-1.2,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     char  basc "RSMH=1.5,1.5,0.9,1.5 EH=-.5,{ehmax},-.4,{ehmax}"
%     char  basa "RSMH=1.5,1.5,1.5,1.5 EH=-.6,{ehmax},{ehmax},{ehmax}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   endif
% elseifd cmpd=='CdTe'
#   RT lattice constant from Adachi: a=6.481/.5292 = 12.25
%   const tpan=t metal=f a=12.25
%   const ngd=25
%   char  strnc "P={pval(tpsc,0,4.94,6.5)},{pval(tppc,0,4.93,6.5)},{pval(tpdc,4.91,4.91,5.4)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,4.94,6.5)},{ploc(tppc,0,4.93,6.5)},{ploc(tpdc,0,4.91,5.4)} IDMOD=0,0,0,1,1"
%   char  strna "P={pval(tpsa,0,5.88,6.5)},0,{pval(tpda,5.3,4.95,5.4)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,5.88,6.5)},0,{ploc(tpda,5.3,4.95,5.4)} IDMOD=0,0,{tpda==0?1:0},1,1"
%   ifdef f
#   Patterned after bigbas11 in InP, InAs, GaAs, except Cd d orbital always 4d
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.7,1.7,0.90,{lfc?1.7:0},{lgc?1.7:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef f
%     elseif bigbas==11
%     char  basc "{basc} RSMH2=1.5,0,0.90 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.5,1.5,0.90 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     endif
%     char  basa "RSMH=1.5,1.9,1.9,{lfa?1.9:0},{lga?1.9:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     char  basa "{basa} RSMH2=1.9,1.9,1.9 EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas
%     ifdef tpdc==4
%       char  basc "RSMH=1.2,1.2,0.9,1.2 EH=-.1,-.1,-.1,-.1 RSMH2=1.2,1.2,0.9 EH2=-1,-1,-1 PZ=0,0,5.4 IDMOD=0,0,1"
%       char  basa "P=0,0,5.3 IDMOD=0,0,1 RSMH=1.5,1.9,1.9,1.9 EH=-.6,-.1,-.1,-.1 RSMH2=0.0,1.9,0 EH2=-1,-1,-1"
%       char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%     else
%       char  basc "RSMH=1.2,1.2,0.9,1.2 EH=-.1,-.1,-.1,-.1 RSMH2=1.2,1.2,0.9 EH2=-1,-1,-1"
%       char  basa "P=0,0,5.25 IDMOD=0,0,1 RSMH=1.5,1.9,1.9,1.9 EH=-.6,-.1,-.1,-.1 RSMH2=0.0,1.9,0 EH2=-1,-1,-1"
%       char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%     endif
%   else
%     const ngd=25
%     char  basc "RSMH=1.2,1.2,0.9,1.2 EH=-.1,-.1,-.1,-.1"
%     char  basa "P=0,0,5.25 IDMOD=0,0,1 RSMH=1.5,1.9,1.9,1.9 EH=-.6,-.1,-.1,-.1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   endif
% elseifd cmpd=='HgTe'
%   const tpan=t metal=t azb=12.21
%   const tpan=t metal=f azb=12.25
%   const gmax=10 ngd=24
%   char  strnc "P={pval(tpsc,0,5.94,7.5)},{pval(tppc,0,5.93,7.5)},{pval(tpdc,5.91,5.91,6.4)},5.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,5.94,7.5)},{ploc(tppc,0,5.93,7.5)},{ploc(tpdc,0,5.91,6.4)} IDMOD=0,0,0,1,1"
%   char  strna "P={pval(tpsa,0,5.88,6.5)},0,{pval(tpda,5.3,4.95,5.4)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,5.88,6.5)},0,{ploc(tpda,5.3,4.95,5.4)} IDMOD=0,0,{tpda==0?1:0},1,1"
%   ifdef f
#   Patterned after bigbas11 in InP, InAs, GaAs, except Hg d orbital always 5d
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.7,1.7,0.95,{lfc?1.7:0},{lgc?1.7:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef f
%     elseif bigbas==11
%     char  basc "{basc} RSMH2=1.5,0,0.95 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.5,1.5,0.95 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     endif
%     char  basa "RSMH=1.5,1.9,1.9,{lfa?1.9:0},{lga?1.9:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     char  basa "{basa} RSMH2=1.9,1.9,1.9 EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas
%     ifdef tpdc==4
%       char  basc "RSMH=1.2,1.2,0.95,1.2 EH=-.1,-.1,-.1,-.1 RSMH2=1.2,1.2,0.95 EH2=-1,-1,-1 PZ=0,0,6.4 IDMOD=0,0,1"
%     ifdef bigbas==2
%       char  basa "P=0,0,5.3 IDMOD=0,0,1 RSMH=1.5,1.9,1.9,1.9 EH=-.6,-.1,-.1,-.1 RSMH2=1.5,1.9,1.9 EH2=-1.4,-1,-1"
%     else
%       char  basa "P=0,0,5.3 IDMOD=0,0,1 RSMH=1.5,1.9,1.9,1.9 EH=-.6,-.1,-.1,-.1 RSMH2=0.0,1.9,0 EH2=-1,-1,-1"
%     endif
%       char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%     else
%       char  basc "RSMH=1.2,1.2,0.95,1.2 EH=-.1,-.1,-.1,-.1 RSMH2=1.2,1.2,0.95 EH2=-1,-1,-1"
%     ifdef bigbas==2
%       char  basa "P=0,0,5.25 IDMOD=0,0,1 RSMH=1.5,1.9,1.9,1.9 EH=-.6,-.1,-.1,-.1 RSMH2=1.5,1.9,1.9 EH2=-1.4,-1,-1"
%     else
%       char  basa "P=0,0,5.25 IDMOD=0,0,1 RSMH=1.5,1.9,1.9,1.9 EH=-.6,-.1,-.1,-.1 RSMH2=0.0,1.9,0 EH2=-1,-1,-1"
%     endif
%       char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%     endif
%   else
%     char  basc "RSMH=1.2,1.2,0.95,1.2 EH=-.1,-.1,-.1,-.1"
%     char  basa "P=0,0,5.25 IDMOD=0,0,1 RSMH=1.5,1.9,1.9,1.9 EH=-.6,-.1,-.1,-.1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   endif
% elseifd cmpd=='HgCdTe'
%   const tpan=t metal=f azb=12.25 Zb=81
% elseifd cmpd=='NiMnSb' | cmpd=='CoMnGa' | cmpd=='CoMnSi' | cmpd=='CoMnGe' | cmpd=='CoMnSn'
#   NiMnSb in the C1b structure: Ni plays role of cation, Mn uses info for 'b' atom.
%   cconst cmpd=='NiMnSb' a=5.927/.52918
%   cconst cmpd=='CoMnGa' a=10.904
%   cconst cmpd=='CoMnSi' a=10.685
%   cconst cmpd=='CoMnGe' a=10.853
%   cconst cmpd=='CoMnSn' a=11.338
%   cconst cmpd=='NiMnSn' a=11.439
%   const tpan=t metal=t  elind=-1
%   const tpsb=0 tppb=0 tpdb=0 lfb=0 lgb=0
%   const gmax=(tppc>0|tppb>0|tpda>0)?10:8.5
%   char i c
%   char strn{i}={ploc({tps{i}},0,{{pqnsc(Z{i})}+.94},{{pqnsc(Z{i})}+2.5})}
%   char strn{i}="{strn{i}},{ploc({tpp{i}},0,{{pqnsc(Z{i})}+.93},{{pqnsc(Z{i})}+2.5})}
%   char strn{i}="{strn{i}},{ploc({tpd{i}},0,0,{{pqnd(Z{i})}+1.5})}
%   char strn{i} "PZ={strn{i}} RS3=0.95 IDMOD=0,0,0,1,1"
%   char i b
%   char strn{i}={ploc({tps{i}},0,{{pqnsc(Z{i})}+.94},{{pqnsc(Z{i})}+2.5})}
%   char strn{i}="{strn{i}},{ploc({tpp{i}},0,{{pqnsc(Z{i})}+.93},{{pqnsc(Z{i})}+2.5})}
%   char strn{i}="{strn{i}},{ploc({tpd{i}},0,0,{{pqnd(Z{i})}+1.5})}
%   char strn{i} "PZ={strn{i}} RS3=0.95 IDMOD=0,0,0,1,1"
#   When the A atom is a cation (to the left of col IV)
#   1. The valence s,p are core + 1; but better just to use default values for valence
#      P     : 'p0' = valence, 'plo' = valence, 'phi' = valence
#      PZ    :                 'plo' = core   , 'phi' = valence + 1
#   2. the 'low d' is the valence d; the 'high d' is 'low d' + 1
#      P,PZ  : 'p0' = valence, 'plo' = valence, 'phi' = valence + 1
#   3. The valence d floats
#   When the A atom is an anion (col IV or to the right of col IV)
#   1. The valence s,p are core + 1; but better just to use default values for valence
#      Never put core in valence as local orbital => 'plo' = valence, 'phi' = 'plo' + 1
#   2. the 'high d' is the valence d; the 'low d' is 'high d' - 1
#      Never d core in valence as local orbital =>
#      P     : 'p0' = valence, 'plo' = valence, 'phi' = valence
#      PZ    :                 'plo' = core   , 'phi' = valence + 1
#   3. The valence d needs to be frozen if no local orbital is present
%   char i a
#   sp orbitals, 'cation'-like A atom
%   ifdef Za<14 | 18<Za&Za<32 | 36<Za&Za<50 | 54<Za&Za<80
%   char strn1="P={pval({tps{i}},0,0*{{pqnsc(Z{i})}+1.8},0*{{pqnsc(Z{i})}+1.8})}
%   char strn1="{strn1},{pval({tpp{i}},0,0*{{pqnsc(Z{i})}+1.5},0*{{pqnsc(Z{i})}+1.5})}
%   char strn2="PZ={ploc({tps{i}},0,{{pqnsc(Z{i})}+.94},{{pqnsc(Z{i})}+2.5})}"
%   char strn2="{strn2},{ploc({tpp{i}},0,{{pqnsc(Z{i})}+.93},{{pqnsc(Z{i})}+2.5})}"
#   sp orbitals 'anion'-like A atom
%   else
%   char strn1="P={pval({tps{i}},0,{{pqnsc(Z{i})}+1.88},{{pqnsc(Z{i})}+2.5})}
%   char strn1="{strn1},{pval({tpp{i}},0,{{pqnsc(Z{i})}+1.85},{{pqnsc(Z{i})}+2.5})}
%   char strn2="PZ={ploc({tps{i}},0,{{pqnsc(Z{i})}+1.88},{{pqnsc(Z{i})}+2.5})}"
%   char strn2="{strn2},{ploc({tpp{i}},0,{{pqnsc(Z{i})}+1.85},{{pqnsc(Z{i})}+2.5})}"
%   endif
#   d orbitals, 'cation'-like A atom
%   ifdef Za<14 | 18<Za&Za<32 | 36<Za&Za<50 | 54<Za&Za<80
#   fractional part depends on whether we are close to transition or not
%   var tmpp=({pqnd(Z{i})}<>{pqnd(Z{i}+1)})?.92:(({pqnd(Z{i})}<>{pqnd(Z{i}+2)})?.88:.5)
%   char strn1="{strn1},{pval({tpd{i}},{{pqnd(Z{i})}+tmpp},{{pqnd(Z{i})}+tmpp},{{pqnd(Z{i})}+1.5})}
%   char strn2="{strn2},{ploc({tpd{i}},{{pqnd(Z{i})}+tmpp},{{pqnd(Z{i})}+tmpp},{{pqnd(Z{i})}+1.5})}
%   char strn2 "{strn2} RS3=0.95 IDMOD=0,0,0,1,1"
%   udef tmpp
#   d orbitals 'anion'-like A atom
%   else
%   char strn1="{strn1},{pval({tpd{i}},{{pqnd(Z{i})}+0.3},{{pqnd(Z{i})}+0.3},{{pqnd(Z{i})}+0.3})}
%   char strn2="{strn2},{ploc({tpd{i}},0,{{pqnd(Z{i})}-1+0.93},{{pqnd(Z{i})}+1.5})}
%   char strn2 "{strn2} RS3=0.95 IDMOD=0,0,{tpda<=1|tpda==4?1:0},1,1"
%   endif
%   char strna "{strn1} {strn2}"
%   udef i strn1 strn2
# %   show vars
# %   stop
%   char strnb "{strnb} MMOM=0,0,4"
%   ifdef f
%   elseifd bigbas
%     char  basc "RSMH=2.1,2.1,1.0,{lfc?1.8:0},{lgc?1.8:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=2.1,2.1,1.0 EH2={ehmax-.9},{tppc?-2:ehmax-.9},{ehmax-.9}"
%     char  basb "RSMH=2.1,2.1,1.0,{lfb?2.1:0},{lgb?2.1:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basb "{basb} RSMH2=2.1,2.1,1.0 EH2={ehmax-.9},{tppc?-2:ehmax-.9},{ehmax-.9}"
%     char  basa "RSMH=1.7,1.7,1.7,{lfa?1.7:0},{lga?1.7:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.7,1.7,{tpda==2?0.8:1.7} EH2={ehmax-.9},{ehmax-.9},{ehmax-.9}"
%     char  base "RSMH=1.7,1.7,1.7,1.7 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     char  basc "RSMH=2.1,2.1,1.15 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basb "RSMH=2.1,2.1,1.15 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "RSMH=1.7,1.7,1.7 EH=-.7,{ehmax<-.4?ehmax:-.4},{ehmax},{ehmax}"
%     char  base "RSMH=1.7,1.7,1.7,1.7 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   endif
% elseifd cmpd=='CaF2'
#   CaF2 in the Flourite structure
%   const tpan=t metal=f a=10.3234 elind=-1
% elseifd cmpd=='CuCl' | cmpd=='CuBr'
#   CuCl, CuBr have the ZB structure
%   ifdef f
%   elseifd cmpd=='CuCl'
#   Lattice constant from Madelung
%   const metal=f azb=5.406/.52918 elind=-1 gmax=10
%   char  strna "P={pval(tpsa,3.91,3.91,4.5)},{pval(tppa,3.84,3.84,4.5)},{pval(tpda,3.25,0,3.4)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,3.91,4.5)},{ploc(tppa,0,3.84,4.5)},{ploc(tpda,0,0,3.4)}"
%   char  strna "{strna} IDMOD=0,0,{tpda==0?1:0},1,1"
%   const rsa=1.0
% elseifd cmpd=='CuBr'
%   const metal=f azb=5.68/.52918 elind=-1 gmax=10
%   char  strna "P={pval(tpsa,4.88,4.88,5.5)},{pval(tppa,4.82,4.82,5.5)},{pval(tpda,4.3,3.95,4.4)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,4.88,5.5)},{ploc(tppa,0,4.82,5.5)},{ploc(tpda,4.3,3.95,4.4)}"
%   char  strna "{strna} IDMOD=0,0,{tpda==0?1:0},1,1"
%   const rsa=1.2
%   endif
%   ifdef  asa
%   char  strna "{strna} IDXDN=0,0,2"
%   endif
%   char  strnc       "P={pval(tpsc,0,{{pqnsc(Zc)}+1.5},0)}"
%   char  strnc "{strnc},{pval(tppc,0,{{pqnsc(Zc)}+1.3},{{pqnsc(Zc)}+1.35})}"
%   char  strnc "{strnc},{pval(tpdc,{{pqnsc(Zc)}+.91},{{pqnsc(Zc)}+.91},4.4)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,{{pqnsc(Zc)}+.94},{{pqnsc(Zc)}+2.5})}"
%   char  strnc "{strnc},{ploc(tppc,0,{{pqnsc(Zc)}+.94},{{pqnsc(Zc)}+2.5})}"
%   char  strnc "{strnc},{ploc(tpdc,0,0,{{pqnd(Zc)}+1.5})} IDMOD=0,0,0,1,1 RS3=0.8"
%   const ngd=25
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.2,1.2,0.88,{lfc?1.4:0},{lgc?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.2,1.2,0.88 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     char  basa "RSMH={rsa},{rsa},{rsa},{lfa?1.2:0},{lga?1.2:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     char  basa "{basa} RSMH2={rsa},{rsa},{rsa} EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.2,1.2,1.2,1.2 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas
%     char  basc "RSMH=1.2,1.2,0.88,{lfc?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.2,1.2,0.88 EH2=-1,-1,-1"
%     char  basa "RSMH={rsa},{rsa},{rsa},{lfa?1.2:0},{lga?1.2:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2={rsa},{rsa},{rsa} EH2=-1.3,{ehmax-.8},{ehmax-.8} RS3=1"
%     char  base "RSMH=1.2,1.2,1.2,1.2  EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     char  basc "RSMH=1.4,1.4,.95 EH=-.5,-.1,-.1,-.1"
%     char  basa "RSMH={rsa},{rsa},1.2 EH=-1.,-.2,-.1,-.1"
%     char  base "RSMH=1.2,1.2,1.2 EH=-.1,-.1,-.1,-.1"
%   endif
% elseifd cmpd=='Cu2S'
%   const metal=f a=5.473/.52918 elind=-1 gmax=10
%   char  strnc       "P={pval(tpsc,0,{{pqnsc(Zc)}+1.5},0)}"
%   char  strnc "{strnc},{pval(tppc,0,{{pqnsc(Zc)}+1.3},{{pqnsc(Zc)}+1.35})}"
%   char  strnc "{strnc},{pval(tpdc,{{pqnsc(Zc)}+.91},{{pqnsc(Zc)}+.91},4.4)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,{{pqnsc(Zc)}+.94},{{pqnsc(Zc)}+2.5})}"
%   char  strnc "{strnc},{ploc(tppc,0,{{pqnsc(Zc)}+.94},{{pqnsc(Zc)}+2.5})}"
%   char  strnc "{strnc},{ploc(tpdc,0,0,{{pqnd(Zc)}+1.5})} IDMOD=0,0,0,1,1 RS3=0.9"
%   char  strna "P={pval(tpsa,0,3.88,4.5)},{pval(tppa,0,3.70,4.5)},3.3,4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,3.88,4.5)},{ploc(tppa,0,3.70,4.5)} IDMOD=0,0,1,1,1 RS3=0.9"
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.5,1.5,0.88,{lfc?1.5:0},{lgc?1.5:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef f
%     elseif bigbas==11
%     char  basc "{basc} RSMH2=1.5,0,0.88 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.5,1.5,0.88 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     endif
%     char  basa "RSMH=1.2,1.2,1.2,{lfa?1.2:0},{lga?1.2:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     char  basa "{basa} RSMH2=1.2,1.2,1.2 EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.2,1.2,1.2,1.2*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas
%     char  basc "RSMH=1.4,1.4,0.88,{lfc?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.4,1.4,0.88 EH2=-1,-1,-1"
%     char  basa "RSMH=1.2,1.2,1.2,{lfa?1.2:0},{lga?1.2:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=1.2,1.2,1.2 EH2=-1.3,{ehmax-.8},{ehmax-.8} RS3=1"
%     char  base "RSMH=1.4,1.4,1.4,1.4  EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     char  basc "RSMH=2.0,2.0,1.0 EH=-.5,-.1,-.1,-.1"
%     char  basa "RSMH=1.2,1.2,1.2 EH=-.7,-.1,-.1,-.1"
%     char  base "RSMH=1.2,1.2,1.2 EH=-.1,-.1,-.1,-.1"
%   endif
% elseifd cmpd=='Cu2O'
#   Cu2O has the cuprite structure
%   const metal=f a=4.267/.52918 elind=-1 gmax=10
%   char  strnc       "P={pval(tpsc,0,{{pqnsc(Zc)}+1.5},0)}"
%   char  strnc "{strnc},{pval(tppc,0,{{pqnsc(Zc)}+1.3},{{pqnsc(Zc)}+1.35})}"
%   char  strnc "{strnc},{pval(tpdc,{{pqnsc(Zc)}+.91},{{pqnsc(Zc)}+.91},4.4)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,{{pqnsc(Zc)}+.94},{{pqnsc(Zc)}+2.5})}"
%   char  strnc "{strnc},{ploc(tppc,0,{{pqnsc(Zc)}+.94},{{pqnsc(Zc)}+2.5})}"
%   char  strnc "{strnc},{ploc(tpdc,0,0,{{pqnd(Zc)}+1.5})} IDMOD=0,0,0,1,1 RS3=0.8"
%   char  strna "P={pval(tpsa,0,2.88,3.5)},{pval(tppa,0,2.70,3.5)},3.25,4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,2.88,3.5)},{ploc(tppa,0,2.70,3.5)},0 IDMOD=0,0,1,1,1"
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.5,1.5,0.82,{lfc?1.5:0},{lgc?1.5:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef f
%     elseif bigbas==11
%     char  basc "{basc} RSMH2=1.5,0,0.82 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.5,1.5,0.82 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     endif
%     char  basa "RSMH=0.80,0.80,0.80,{lfa?.80:0} EH={tpsa==3?ehmax:-.5},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=0.80,0.80,0.80 EH2={tpsa==3?ehmax-.8:-1.5},{ehmax-.8},{ehmax-.8} RS3=.9"
%     char  base "RSMH=1.2,1.2,1.2,1.2*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas
%     char  basc "RSMH=1.4,1.4,0.82,{lfc?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax}  RSMH2=1.4,1.4,0.82 EH2=-1,-1,-1"
%     char  basa "RSMH=0.80,0.80,0.80,{lfa?0.80:0} EH=-.5,{ehmax},{ehmax},{ehmax}  RSMH2=0.80,0.80,0 EH2=-1.5,-1,-1"
%     char  base "RSMH=1.4,1.4,1.4,1.4  EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     char  basc "RSMH=2.0,2.0,0.90 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "RSMH=0.85,0.85,0.85 EH=-1.1,-.5,{ehmax},{ehmax}"
%     char  base "RSMH=2.0,2.0,2.0     EH={ehmax},{ehmax},{ehmax}"
%   endif
% elseifd cmpd=='FeO' | cmpd=='MnO' | cmpd=='NiO'
#   The rocksalt structure, or AFII based on it
#   Lattice constant from C. A. McCammon and L.-G. Liu, Phys. Chem. Miner. 10, 106 (1984)
%   ifdef cmpd=='FeO' 
%   const metal=f a=4.334/.52918 elind=-1 gmax=11
%   elseifd cmpd=='MnO' 
%   elseifd cmpd=='NiO'
%   const metal=f a=7.88 elind=-1 gmax=11
%   endif
%   char  strnc       "P={pval(tpsc,0,{{pqnsc(Zc)}+1.5},0)}"
%   char  strnc "{strnc},{pval(tppc,0,{{pqnsc(Zc)}+1.3},{{pqnsc(Zc)}+1.35})}"
%   char  strnc "{strnc},{pval(tpdc,{{pqnsc(Zc)}+.7},{{pqnsc(Zc)}+.7},4.4)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,{{pqnsc(Zc)}+.94},{{pqnsc(Zc)}+2.5})}"
%   char  strnc "{strnc},{ploc(tppc,0,{{pqnsc(Zc)}+.94},{{pqnsc(Zc)}+2.5})}"
%   char  strnc "{strnc},{ploc(tpdc,0,0,{{pqnd(Zc)}+1.5})} IDMOD=0,0,0,1,1 RS3=0.8"
%   char  strna "P={pval(tpsa,0,2.88,3.5)},{pval(tppa,0,2.70,3.5)},3.25,4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,2.88,3.5)},{ploc(tppa,0,2.70,3.5)},0 IDMOD=0,0,1,1,1"
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.5,1.5,0.82,{lfc?1.5:0},{lgc?1.5:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.5,1.5,0.82 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     char  basa "RSMH=0.80,0.80,0.80,{lfa?.80:0} EH={tpsa==3?ehmax:-.5},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=0.80,0.80,0.80 EH2={tpsa==3?ehmax-.8:-1.5},{ehmax-.8},{ehmax-.8} RS3=.9"
%     char  base "RSMH=1.2,1.2,1.2,1.2*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas
%     char  basc "RSMH=1.4,1.4,0.82,{lfc?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax}  RSMH2=1.4,1.4,0.82 EH2=-1,-1,-1"
%     char  basa "RSMH=0.80,0.80,0.80,{lfa?0.80:0} EH=-.5,{ehmax},{ehmax},{ehmax}  RSMH2=0.80,0.80,0 EH2=-1.5,-1,-1"
%     char  base "RSMH=1.4,1.4,1.4,1.4  EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     char  basc "RSMH=2.0,2.0,0.90 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "RSMH=0.90,0.90,0.90 EH=-1.1,-.5,{ehmax},{ehmax}"
%     char  base "RSMH=2.0,2.0,2.0     EH={ehmax},{ehmax},{ehmax}"
%   endif
#   for AFII structure or any AFM superlattice
%   ifdef file
%     char  strnb "{strnc} MMOM=0,0,-3"
%     ifdef cmpd=='FeO' 
%       char  strnb "{strnc} MMOM=0,0,-3"
%     elseifd cmpd=='MnO' 
%     elseifd cmpd=='NiO'
%       char  strnb "{strnc} MMOM=0,0,-1"
%     endif
%     char  basb  "{basc}"
%   endif
%   ifdef cmpd=='FeO' 
%     char  strnc "{strnc} MMOM=0,0,3"
%   elseifd cmpd=='MnO' 
%   elseifd cmpd=='NiO'
%     char  strnc "{strnc} MMOM=0,0,1"
%   endif
% elseifd cmpd=='Bi2Te3' | cmpd=='Bi2Se3'
#   Taken from Wyckoff
%   ifdef cmpd=='Bi2Te3'
%     const a=4.782548 q=4.0154392 zTe=0.364 zBi=0.2 rwc=2.87 rwb=rwc rwa=2.856 rwea=2.17*{les>=10?0:1}
%     char  strnc "P={pval(tpsc,0,5.88,6.5)},0,{pval(tpdc,5.3,4.95,5.4)},4.15,5.12"
%     char  strnc "{strnc} PZ={ploc(tpsc,0,5.88,6.5)},0,{ploc(tpdc,5.3,4.95,5.4)} IDMOD=0,0,{tpdc==0?1:0},1,1"
%   elseifd cmpd=='Bi2Se3'
#     Taken from Wyckoff
#%     const a=4.5147 q=3.996 zTe=0.382 zBi=0.399/2 rwc=2.87 rwb=rwc rwa=2.72 rwea=2.17*{les>=10?0:1}
#     Taken from total energy minimization
%     const a=4.5147 q=3.996 zTe=0.333 zBi=0.394/2 rwc=2.87 rwb=rwc rwa=2.72 rwea=2.17*{les>=10?0:1}
%     char  strnc "P={pval(tpsc,0,4.88,5.5)},0,{pval(tpdc,4.3,3.95,4.4)},4.15,5.12"
%     char  strnc "{strnc} PZ={ploc(tpsc,0,4.88,5.5)},0,{ploc(tpdc,4.3,3.95,4.4)} IDMOD=0,0,{tpdc==0?1:0},1,1"
%   endif
%   const metal=t gmax=9
%   char  strna "P={pval(tpsa,0,6.88,7.5)},0,{pval(tpda,6.3,5.94,6.4)},5.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,6.88,7.5)},0,{ploc(tpda,6.3,5.94,6.4)} IDMOD=0,0,{tpda==0?1:0},1,1"
%   ifdef cmpd=='Bi2Te3' | cmpd=='Bi2Se3'
%     char  strnb "{strnc}"
%   endif
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.2,1.4,1.7,{lfc?1.7:0},{lgc?1.7:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     char  basc "{basc} RSMH2=1.2,1.4,1.7 EH2=-1.5,{ehmax-.8},{ehmax-.8}"
%     char  basa "RSMH=1.2,1.4,1.7,{lfa?1.7:0},{lga?1.7:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%     char  basa "{basa} RSMH2=1.2,1.4,1.7 EH2=-1.5,{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas
%     const ngd=16
%     char  basc "RSMH=1.2,1.4,1.7,1.7 EH=-.3,-.1,-.1,-.1 RSMH2=1.7,0,0,0 EH2=-1"
%     char  basa "RSMH=1.2,1.4,1.7,1.7 EH=-.3,-.1,-.1,-.1 RSMH2=1.7,1.7 EH2=-1,-1"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH=-.1,-.1,-.1,-.1"
%   else
%     char  basc "RSMH=1.2,1.4,1.7,1.7 EH=-.5,-.1,-.1,-.1"
%     char  basa "RSMH=1.2,1.4,1.7,1.7 EH=-.5,-.1,-.1,-.1"
%     char  base "RSMH=1.5,1.5,1.5     EH=-.1,-.1,-.1,-.1"
%   endif
%   ifdef cmpd=='Bi2Te3' | cmpd=='Bi2Se3'
%   char  basb "{basc}
%   endif
# I-III-VI compounds in the chalcopyrite structure
% elseifd cmpd=='CuAlSe2' | cmpd=='CuInSe2' | cmpd=='CuGaSe2'
%   const tpsb=0 tppb=0 tpdb=0 lfb=0 lgb=0
%   char  strnc       "P={pval(tpsc,0,{{pqnsc(Zc)}+1.5},0)}"
%   char  strnc "{strnc},{pval(tppc,0,{{pqnsc(Zc)}+1.3},{{pqnsc(Zc)}+1.35})}"
%   char  strnc "{strnc},{pval(tpdc,{{pqnsc(Zc)}+.85},{{pqnsc(Zc)}+.85},4.4)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,{{pqnsc(Zc)}+.94},{{pqnsc(Zc)}+2.5})}"
%   char  strnc "{strnc},{ploc(tppc,0,{{pqnsc(Zc)}+.94},{{pqnsc(Zc)}+2.5})}"
%   char  strnc "{strnc},{ploc(tpdc,0,0,{{pqnd(Zc)}+1.5})} IDMOD=0,0,0,1,1 RS3=0.8"
%   ifdef f
%   elseifd cmpd=='CuAlSe2'
#   Taken from Phys. Rev. B 29, 1882 (1984) (Zunger)
%   const a=5.604/.52918 q=1.95 u=.25 metal=f elind=-1 gmax=11
%   elseifd cmpd=='CuGaSe2'
#   Some exptl dispersion in a,q avg: a=5.605 q=1.964 u=.248  I get LDA u=.242 q=1.996
#   Phys. Rev. B 29, 1882 (1984) (Zunger) u=.264 from some semi-empirical rule.
#   Phys. Stat. Sol. B241, 2516 (2004) LAPW a=5.542 q=1.957 u=0.261 (u from u='1/2-(q*q/32-1/16)^.5')
#   J. Chem. Phys. 61, 1140 (1974): a=5.5963/.5292 q=1.96623 u=0.2431
#   J. Appl. Cryst. 10, 130 (1977): ?data
%   const a=5.596/.52918 q=1.966 u=.25 metal=f elind=-1 gmax=11
%   elseifd cmpd=='CuInSe2'
#   See Phys. Rev. B 29, 1882 (1984) (Zunger)
#   J. Appl. Cryst. 6, 414 (1973): a=5.782, q=2.0097  Est for u=.235 is rather uncertain
#   Z. Anorg. Chem. 271, 153 (1953): a=5.773 q=2.0007 u=.22
#   Phys. Stat. Sol. B62, 183 (1974): a=5.784 q=2.008 u=.224
#   Phys. Stat. Sol. B241, 2516 (2004) LAPW a=5.733 q=1.988 u=.253 (u from u='1/2-(q*q/32-1/16)^.5')
#   On thin films: a=5.809 q=2.034. No u (Semicond. Sci. Technol. 18, 768)
#   Phys. Rev. B 29, 1882 (1984) (Zunger) u=.237 from some semi-empirical rule.
#   These q and u determined from total energy minimization, bigbas=12, nk=4
#   Calc. LDA lattice constant is 10.8275 au = 5.730 A
%   const a=5.782/.52918 q=2.007 u=.215 metal=f elind=-1 gmax=9
%   endif
%   ifdef f
%   elseifd cmpd=='CuAlSe2'
%   char  strnb "P={pval(tpsb,0,2.94,3.5)},{pval(tppb,0,2.94,3.55)},{pval(tpdb,3.3,0,3.3)},4.15,5.12"
%   char  strnb "{strnb} PZ={ploc(tpsb,0,2.94,4.5)},{ploc(tppb,0,2.94,4.5)},{ploc(tpdb,0,0,4.2)} IDMOD=0,0,1,1,1"
%   elseifd cmpd=='CuGaSe2'
%   char  strnb "P={pval(tpsb,0,3.94,5.5)},{pval(tppb,0,3.93,5.5)},{pval(tpdb,4.3,3.93,4.3)},4.15,5.12"
%   char  strnb "{strnb} PZ={ploc(tpsb,0,3.93,5.5)},{ploc(tppb,0,3.93,5.5)},{ploc(tpdb,4.3,3.92,4.3)} IDMOD=0,0,0,1,1"
%   elseifd cmpd=='CuInSe2'
%   char  strnb "P={pval(tpsb,0,4.94,5.5)},{pval(tppb,0,4.93,5.5)},{pval(tpdb,4.93,4.93,5.4)},4.15,5.12"
%   char  strnb "{strnb} PZ={ploc(tpsb,0,4.94,5.5)},{ploc(tppb,0,4.93,5.5)},{ploc(tpdb,0,4.93,5.4)} IDMOD=0,0,0,1,1"
%   endif
%   ifdef tppb==3
%   char  strnb "{strnb} Q=3,0,{tpdb|zb==49?10:0} RS3=0.8"
%   endif
%   ifdef tpdb==3
%   char  strnb "{strnb} RS3=0.8"
%   endif
%   char  strna "P={pval(tpsa,0,4.88,5.5)},0,{pval(tpda,4.3,3.95,4.4)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,4.88,5.5)},0,{ploc(tpda,4.3,3.95,4.4)} IDMOD=0,0,{tpda==0?1:0},1,1"
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.5,1.5,0.90,{lfc?1.5:0},{lgc?1.5:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef f
%     elseif bigbas==11
%     char  basc "{basc} RSMH2=1.5,0,0.90 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.5,1.5,0.90 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     endif
%     char  basb "RSMH=1.5,1.5,.85,{lfb?1.5:0},{lgb?1.5:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef f
%     elseif bigbas==11
%     char  basb "{basb} RSMH2=1.5,0,.85 EH2={{ehmax-.8}},{{ehmax-.8}},{{ehmax-.8}} RS3=.95"
%     elseif bigbas==12
%     char  basb "{basb} RSMH2=1.5,1.5,.85 EH2={{ehmax-.8}},{{ehmax-.8}},{{ehmax-.8}} RS3=.95"
%     elseif bigbas==13
%     char  basb "{basb} RSMH2=1.5,1.5,.85,1.5 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.95"
%     endif
%     char  basa "RSMH=1.3,1.4,1.9,{lfa?1.9:0},{lga?1.9:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax} RS3=.9"
%     char  basa "{basa} RSMH2=1.4,1.4,1.9 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8}"
%     char  base "RSMH=1.5,1.5,1.5,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas
%     char  basc "RSMH=1.4,1.6,0.9,{lfc?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.4,1.4,0.82 EH2=-1,-1,-1"
%     char  basb "RSMH=1.4,1.5,0.85,1.4 EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.6,0,0,0 EH2=-1"
%     char  basa "RSMH=1.3,1.4,1.9      EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.4,1.4,1.4 EH2=-1,-1,-1"
%     char  base "RSMH=1.4,1.4,1.4      EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     char  basc "RSMH=1.4,1.6,1.0  EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.4,1.4,0.82 EH2=-1,-1,-1"
%     ifdef f
%     elseifd cmpd=='CuGaSe2'
%     char  basb "RSMH=1.1,1.4,0.80 EH={ehmax},{ehmax},-.7,{ehmax}"
%     elseifd cmpd=='CuInSe2'
%     char  basb "RSMH=1.4,1.5,0.85 EH={ehmax},{ehmax},-.7,{ehmax}"
%     endif
%     char  basa "RSMH=1.3,1.4,1.9  EH=-.8,-.2,-.1,-.1
%     char  base "RSMH=1.4,1.4,1.4  EH={ehmax},{ehmax},{ehmax}"
%   endif
# II-IV-V compounds in the chalcopyrite structure
% elseifd calco245
%   const tpsb=0 tppb=0 tpdb=0 lfb=0 lgb=0
%   ifdef f
%   elseifd cmpd=='MgSiP2'
#   from Zunger PRB30, 741 -> A. A. Vaipolin, Fiz. Tverd. Tela 15, 1430 (1973) 
%   const a=10.81113 q=2*0.8823 u=0.292   metal=f elind=-1 gmax=9
%   elseifd cmpd=='ZnSiP2'
#   from Zunger PRB30, 741 -> S. C. Abrahams and J. L. Bernstein, J. Chem. Phys. 52, 5607 (1970) I get a=10.083 tet=1.008 u=0.264
#%  const a=10.20264 q=2*0.9664 u=0.2691  metal=f elind=-1 gmax=9
%   const a=10.20264 q=2*0.9664 u=0.264  metal=f elind=-1 gmax=9
%   elseifd cmpd=='ZnGeP2'
#   from Zunger PRB30, 741 -> M. D. Lind and R. W. Grant, J. Chem. Phys. 58, 357 (1973)  I get a=10.197 tet=1.005 u=0.252
#%  const a=10.31791 q=2*0.9800 u=0.2582  metal=f elind=-1 gmax=9
%   const a=10.31791 q=2*0.9800 u=0.252  metal=f elind=-1 gmax=9   
%   elseifd cmpd=='ZnSnP2'
#   from Zunger PRB30, 741 -> A. A. Vaipolin, et al Phys. Status Solidi 29, 435 (1968) I get a=10.561 tet=1.002 u=0.226
#%  const a=10.67885 q=2*1.0000 u=0.239   metal=f elind=-1 gmax=9
%   const a=10.67885 q=2*1.0000 u=0.226   metal=f elind=-1 gmax=9
%   elseifd cmpd=='ZnSiAs2'
#   from Zunger PRB30, 741 -> M. D. Lind and R. W. Grant, J. Chem. Phys. 58, 357 (1973)   I get a=10.512 tet=1.006 u=.260
#%  const a=10.58247 q=2*0.9700 u=0.2657  metal=f elind=-1 gmax=9
%   const a=10.58247 q=2*0.9700 u=0.260  metal=f elind=-1 gmax=9
%   elseifd cmpd=='ZnGeAs2'
#   from Wei PRB63, 195210 -> Madelung's book.  Wei gets u=0.249.  I get a=10.623 tet=1.004 u=0.248
%   const a=10.7202 q=1.967 u=0.249  metal=f elind=-1 gmax=9
%   elseifd cmpd=='ZnSnAs2'
#   from J. Phys. Chem. Solids 23, 1291 (1962)  a=5.852A, c=11.705A  I get a=10.977 tet=1.003 u=0.224
%   const a=11.058 q=2.000 u=0.224  metal=f elind=-1 gmax=9
%   elseifd cmpd=='CdSiP2'
#   J. Chem. Phys. 55,  796 (1971): a=10.7332 q=1.83644 u=0.2967.  I get a=10.638 tet=1.014 u=0.292
%   const a=10.7332 q=1.836 u=0.2967 metal=f elind=-1 gmax=9
%   elseifd cmpd=='CdGeP2'
#   from a,c/a from Landholt-Bornstein a=5.740 c/a=1.877  I get a=10.746 tet=1.010 u=0.280
%   const a=10.8466 q=1.8774 u=0.280 metal=f elind=-1 gmax=9
%   elseifd cmpd=='CdSnP2'
#   from a,c/a from Madelung a=5.901A=11.1508 c/a=1.951  I get a=11.06 tet=1.006 u=0.253
%   const a=11.1508 q=1.951 u=0.253 metal=f elind=-1 gmax=9
%   elseifd cmpd=='CdSiAs2'
#   from a,c/a from Madelung a=5.885A=11.1206 c/a=1.8489  I get a=11.0551 tet=1.011 u=0.286
%   const a=11.1206 q=1.8489 u=0.286  metal=f elind=-1 gmax=9
%   elseifd cmpd=='CdGeAs2'
#   J. Chem. Phys. 61, 1140 (1974): a=11.2305 q=1.887 u=0.2785 I get (LDA min) a=11.171 tet=1.008 u=0.274
%   const a=11.2305 q=1.887 u=0.2785  metal=f elind=-1 gmax=9
%   elseifd cmpd=='CdSnAs2'
#   from J. Phys. Chem. Solids 23, 1291 (1962)  a=6.093 c=11.936  I get a=11.460 tet=1.003 u=0.250
%   const a=11.51 q=1.959 u=.250  metal=f elind=-1 gmax=9
%   endif
%   char  strnc       "P={pval(tpsc,0,{{pqnsc(Zc)}+1.5},0)}"
%   char  strnc "{strnc},{pval(tppc,0,{{pqnsc(Zc)}+1.3},{{pqnsc(Zc)}+1.35})}"
%   char  strnc "{strnc},{pval(tpdc,{{pqnd(Zc)}+.85},{{pqnd(Zc)}+.85},4.4)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,{{pqnsc(Zc)}+.94},{{pqnsc(Zc)}+2.5})}"
%   char  strnc "{strnc},{ploc(tppc,0,{{pqnsc(Zc)}+.94},{{pqnsc(Zc)}+2.5})}"
%   char  strnc "{strnc},{ploc(tpdc,0,0,{{pqnd(Zc)}+1.5})} IDMOD=0,0,0,1,1 RS3=0.8"
%   ifdef eltc=='Mg'
%   char  basc "RSMH=2.0,2.0,2.0,{lfc?2.0:0},{lgc?2.0:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "{basc} RSMH2=1.6,{tppc==2?.8:{bigbas==11?0:1.6}},1.6 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.80"
%   endif
%   elseifd eltc=='Zn'
%   char  basc "RSMH=1.7,1.7,0.90,{lfc?1.5:0},{lgc?1.5:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%   ifdef f
%   elseifd bigbas==1 | bigbas==11 | bigbas==12
%     char  basc "{basc} RSMH2=1.7,{bigbas>11?1.7:0},{bigbas>1?0.90:0} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%   endif
%   elseifd eltc=='Cd'
%   char  basc "RSMH=1.7,1.7,0.90,{lfc?1.5:0},{lgc?1.5:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "{basc} RSMH2=1.7,1.7,0.90 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%   endif
%   endif
%   ifdef eltb=='Si'
%   stop tpdb==3 'semi.mater: tpdb=3 is nonsensical for Si ...exit'
%   char  strnb "P={pval(tpsb,3.75,2.95,3.5)},{pval(tppb,3.5,2.95,3.5)},{pval(tpdb,3.3,3.3,3.3)},4.15,5.12"
%   char  strnb "{strnb} PZ={ploc(tpsb,0,2.94,4.5)},{ploc(tppb,0,2.94,4.5)},{ploc(tpdb,0,0,4.2)} IDMOD=0,0,1,1,1"
%   char  basb "RSMH=1.2,1.4,1.4,{lfb?1.4:0},{lgb?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basb "{basb} RSMH2=1.2,{tppc==2?.75:1.4},{bigbas>11?1.4:0},{bigbas>12?1.4:0} EH2=-1.2,-1.2,-1.2,-1.2"
%   endif
%   elseifd eltb=='Ge'
%   char  strnb "P={pval(tpsb,4.8,3.95,5.5)},{pval(tppb,4.5,3.95,5.5)},{pval(tpdb,4.3,3.93,4.3)},4.15,5.12"
%   char  strnb "{strnb} PZ={ploc(tpsb,0,3.95,5.5)},{ploc(tppb,0,3.95,5.5)},{ploc(tpdb,4.3,3.93,4.3)}"
%   char  strnb "{strnb} IDMOD=0,0,{tpdb<>3?1:0},1,1 RS3=.9"
%   char  basb "RSMH=1.2,1.4,1.9,{lfb?1.4:0},{lgb?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}
%   ifdef f
%   elseifd bigbas==1 | bigbas==11 | bigbas==12
%     char  basb "{basb} RSMH2=1.4,{tppc==2?.75:1.4},{(tpdc==2|tpdc==4)?0.9:{bigbas>11?1.4:0}},{bigbas>12?1.4:0}"
%     char  basb "{basb} EH2={ehmax-.8},{ehmax-.8},{ehmax-((tpdc==2|tpdc==4)?1.5:.8)},{ehmax-.8}"
%   endif
%   elseifd eltb=='Sn'
%   char  strnb "P={pval(tpsb,5.8,4.94,6.5)},{pval(tppb,5.4,4.93,6.5)},{pval(tpdb,5.3,4.93,5.4)},4.15,5.12"
%   char  strnb "{strnb} PZ={ploc(tpsb,0,4.94,6.5)},{ploc(tppb,0,4.93,6.5)},{ploc(tpdb,5.3,4.93,5.4)}"
%   char  strnb "{strnb} IDMOD=0,0,{tpdb<>3?1:0},1,1 RS3=.9"
%   char  basb "RSMH=1.7,1.7,1.9,{lfb?1.7:0},{lgb?1.7:0} EH={ehmax-.1},{ehmax},{ehmax},{ehmax},{ehmax}"
%   ifdef f
%   elseifd bigbas==1 | bigbas==11 | bigbas==12
%     char  basb "{basb} RSMH2=1.5,1.5,{bigbas>11?{tpdc==3?1.5:1.0}:0} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%   endif
%   endif
%   ifdef elta=='P'
%   char  strna "P={pval(tpsa,3.85,3.85,4.5)},{pval(tppa,3.7,3.7,4.5)},{pval(tpda,3.3,3.3,4.4)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,3.85,4.5)},{ploc(tppa,0,3.7,4.5)},{ploc(tpda,3.3,3.3,4.4)} IDMOD=0,0,1,1,1"
%   char  basa "RSMH=1.4,1.4,1.4,{lfa?1.3:0},{lga?1.3:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%   ifdef f
%   elseifd bigbas==1
%     char  basa "{basa} RSMH2=1.4,1.4,0 EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%   elseifd bigbas==11 | bigbas==12
%     char  basa "{basa} RSMH2=1.4,1.4,1.4 EH2=-1.3,{ehmax-.8},{ehmax-.8}"
%   endif
%   elseifd elta=='As'
%   char  strna "P={pval(tpsa,4.88,4.88,4.88)},{pval(tppa,4.7,4.7,4.7)},{pval(tpda,4.3,3.94,4.3)},4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,3.95,5.5)},{ploc(tppa,0,3.95,5.5)},{ploc(tpda,0,3.94,4.3)}
%   char  strna "{strna} IDMOD=0,0,{tpda<>3?1:0},1,1"
%   char  basa "RSMH=1.4,1.5,1.8,{lfa?1.3:0},{lga?1.3:0} EH={-.6},{ehmax},{ehmax},{ehmax},{ehmax} RS3=1"
%   ifdef f
%   elseifd bigbas==1 | bigbas==11 | bigbas==12
%     char  basa "{basa} RSMH2=1.4,1.5,{bigbas==1?0:{tpda==2?1:1.8}} EH2=-1.3,-1.1,-1.1"
%   endif
%   endif
%   char  base "RSMH=1.4,1.4,1.4      EH={ehmax},{ehmax},{ehmax},{ehmax}"
% elseifd cmpd=='CuAlO2' | cmpd=='CuGaO2' | cmpd=='CuInO2'
%   const tpsb=0 tppb=0 tpdb=0 lfb=0 lgb=0
%   char  strnc       "P={pval(tpsc,0,{{pqnsc(Zc)}+1.5},0)}"
%   char  strnc "{strnc},{pval(tppc,0,{{pqnsc(Zc)}+1.3},{{pqnsc(Zc)}+1.35})}"
%   char  strnc "{strnc},{pval(tpdc,{{pqnsc(Zc)}+.91},{{pqnsc(Zc)}+.91},4.4)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,0,{{pqnsc(Zc)}+.94},{{pqnsc(Zc)}+2.5})}"
%   char  strnc "{strnc},{ploc(tppc,0,{{pqnsc(Zc)}+.94},{{pqnsc(Zc)}+2.5})}"
%   char  strnc "{strnc},{ploc(tpdc,0,0,{{pqnd(Zc)}+1.5})} IDMOD=0,0,0,1,1 RS3=0.8"
#   Compounds are in the delafossite structure
%   ifdef f
%   elseifd cmpd=='CuAlO2'
#   Taken from T. Ishiguro, A. Kitazawa and M. Kato J. Solid State Chem. 40 (1981), p. 170
%   const a=2.8604/sqrt(3)/.52918 c=16.953/.52918 q=c/a/3 zo=.10979 metal=f elind=-1 gmax=11
#   Taken from Su Wei,  Phys. Rev. Lett. 88, 066405 (2002)
%   const a=2.858/sqrt(3)/.52918 c=16.958/.52918 q=c/a/3 zo=.1099 metal=f elind=-1 gmax=11
%   const rwc=1.90 rwb=1.995 rwa=1.618 rwea=1.83*{les>=10?0:1} rwec=1.41*{les>=10?0:1}
%   elseifd cmpd=='CuGaO2'
#   Taken from Su Wei,  Phys. Rev. Lett. 88, 066405 (2002)
%   const a=2.980/sqrt(3)/.52918 c=17.100/.52918 q=c/a/3 zo=.1073 metal=f elind=-1 gmax=11
%   const rwc=1.87 rwb=1.97  rwa=1.59  rwea=1.83*{les>=10?0:1} rwec=1.41*{les>=10?0:1}
%   elseifd cmpd=='CuInO2'
#   Taken from Su Wei,  Phys. Rev. Lett. 88, 066405 (2002)
# %   const a=3.292/sqrt(3)/.52918 c=17.388/.52918 q=c/a/3 zo=.1056 metal=f elind=-1 gmax=11
#   lmf relaxation bas12.tppc3.tpdc4.tpdb3.float gives slighly different zo
%   const a=3.292/sqrt(3)/.52918 c=17.388/.52918 q=c/a/3 zo=.1047 metal=f elind=-1 gmax=11
%   const rwc=1.87 rwb=1.97  rwa=1.59  rwea=1.83*{les>=10?0:1} rwec=1.41*{les>=10?0:1}
%   endif
%   ifdef f
%   elseifd cmpd=='CuAlO2'
%   char  strnb "P={pval(tpsb,0,2.94,3.5)},{pval(tppb,0,2.94,3.55)},{pval(tpdb,3.3,0,3.3)},4.15,5.12"
%   char  strnb "{strnb} PZ={ploc(tpsb,0,2.94,4.5)},{ploc(tppb,0,2.94,4.5)},{ploc(tpdb,0,0,4.2)} IDMOD=0,0,1,1,1"
%   elseifd cmpd=='CuGaO2'
%   char  strnb "P={pval(tpsb,0,3.95,4.5)},{pval(tppb,0,3.95,4.5)},{pval(tpdb,4.3,3.92,4.3)},4.15,5.12"
%   char  strnb "{strnb} PZ={ploc(tpsb,0,3.95,4.5)},{ploc(tppb,0,3.95,4.5)},{ploc(tpdb,4.3,3.92,4.3)} IDMOD=0,0,0,1,1"
%   elseifd cmpd=='CuInO2'
%   char  strnb "P={pval(tpsb,0,4.94,5.5)},{pval(tppb,0,4.93,5.5)},{pval(tpdb,4.91,4.93,5.4)},4.15,5.12"
%   char  strnb "{strnb} PZ={ploc(tpsb,0,4.94,5.5)},{ploc(tppb,0,4.93,5.5)},{ploc(tpdb,0,4.91,5.4)} IDMOD=0,0,0,1,1"
%   endif
%   ifdef tppb==3
%   char  strnb "{strnb} Q=3,0 RS3=0.8"
%   elseifd tpdb==3
%   char  strnb "{strnb} RS3=0.8"
%   endif
%   char  strna "P={pval(tpsa,0,2.88,3.5)},{pval(tppa,0,2.70,3.5)},3.25,4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,2.88,3.5)},{ploc(tppa,0,2.70,3.5)},0 IDMOD=0,0,1,1,1"
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     char  basc "RSMH=1.5,1.5,0.82,{lfc?1.5:0},{lgc?1.5:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef f
%     elseif bigbas==11
%     char  basc "{basc} RSMH2=1.5,0,0.82 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     elseif bigbas==12
%     char  basc "{basc} RSMH2=1.5,1.5,0.82 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=1"
%     endif
%     char  basb "RSMH=1.5,1.5,1.5,{lfb?1.5:0},{lgb?1.5:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef f
%     elseif bigbas==11
%     char  basb "{basb} RSMH2=1.3,0,1.3 EH2={{ehmax-.8}},{{ehmax-.8}},{{ehmax-.8}} RS3=.95"
%     elseif bigbas==12
%     char  basb "{basb} RSMH2=1.3,1.3,1.3 EH2={{ehmax-.8}},{{ehmax-.8}},{{ehmax-.8}} RS3=.95"
%     elseif bigbas==13
%     char  basb "{basb} RSMH2=1.3,1.3,1.3,1.3 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.95"
%     endif
%     char  basa "RSMH=0.80,0.80,0.80,{lfa?.80:0} EH={tpsa==3?ehmax:-.5},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=0.80,0.80,0.80 EH2={tpsa==3?ehmax-.8:-1.5},{ehmax-.8},{ehmax-.8} RS3=.9"
%     char  base "RSMH=1.2,1.2,1.2,1.2*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   elseifd bigbas
%     char  basc "RSMH=1.4,1.4,0.82,{lfc?1.4:0} EH={ehmax},{ehmax},{ehmax},{ehmax}  RSMH2=1.4,1.4,0.82 EH2=-1,-1,-1"
%     char  basb "RSMH=1.4,1.4,1.4,1.4 EH={ehmax},{ehmax},{ehmax},{ehmax} RSMH2=1.6,0,0,0 EH2=-1"
%     char  basa "RSMH=0.80,0.80,0.80,{lfa?0.80:0} EH=-.5,{ehmax},{ehmax},{ehmax}  RSMH2=0.80,0.80,0 EH2=-1.5,-1,-1"
%     char  base "RSMH=1.4,1.4,1.4,1.4  EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     char  basc "RSMH=2.0,2.0,0.90 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basb "RSMH=1.4,1.4,1.4 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "RSMH=0.85,0.85,0.85 EH=-1.1,-.5,{ehmax},{ehmax}"
%     char  base "RSMH=2.0,2.0,2.0     EH={ehmax},{ehmax},{ehmax}"
%   endif
% elseifd cmpd=='CeO2' |  cmpd=='Ce2O3' | cmpd=='HfO2' | cmpd=='ZrO2'
#   CeO2 in the CaF2 structure
%   ifdef f
%   elseifd cmpd=='CeO2'
%     const tpan=t metal=f a=5.413/.529 elind=-1 gmax=10
%   elseifd cmpd=='Ce2O3'
%     const tpan=t metal=f elind=-1 gmax=10
%   elseifd cmpd=='HfO2'
#     Tetragonal structure:
#   Demkov (Phys. Stat Sol. B 226, 57) gets a=6.738 c/a=1.434.  Gets Cubic gap = 3.4 eV  3.77 eV tetragonal
#   Vanderbilt (Phys. Rev. B 65, 233106) gets a=6.756 c/a=1.434
#   Ravi gets from VASP a=6.617 c/a=1.433
%     const metal=f elind=-1 gmax=10
%   elseifd cmpd=='ZrO2'
#     Tetragonal structure:
#     Vanderbilt (Phys. Rev. B 65, 075105) gets a=6.721 c/a=1.434
#     Jansen (Phys. Rev. B 43, 7267) gets a=6.747 c/a=1.425
%     const metal=f elind=-1 gmax=10
%   endif
%   ifdef f
%   elseifd eltc=='Ce'
%   char  strnc "P={pval(tpsc,6.5,5.95,6.5)},{pval(tppc,0,5.93,6.5)},{pval(tpdc,5.3,4.93,5.4)}"
%   char  strnc "{strnc},{pval(tpfc,4.25,4.25,5.5)},5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,6.5,5.95,0.0)},{ploc(tppc,0,5.93,7.5)},0,{ploc(tpfc,4.25,4.25,5.5)}"
#   for now use fractional charge when tpsc>0 to get convergence
%   char  strnc "{strnc} Q={tpsc>=2?0:2},0,{tpsc>=2?1.7:0},2"
%   char  strnc "{strnc} MMOM=0,0,0,1 IDMOD=0 1 1 1 1 RS3=1"
%   elseifd eltc=='Hf'
%   char  strnc "P={pval(tpsc,6.5,5.95,6.5)},{pval(tppc,0,5.93,6.5)},{pval(tpdc,5.3,4.93,5.4)}"
%   char  strnc "{strnc},{pval(tpfc,4.9,4.9,5.5)},5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,6.5,5.95,0.0)},{ploc(tppc,0,5.93,7.5)},0,{ploc(tpfc,4.93,4.93,5.5)}"
%   char  strnc "{strnc} IDMOD=0,{tppc<2|tppc==3?1:0},1,0,1 KMXA=4 RS3=.85"
%   elseifd eltc=='Zr'
%   char  strnc "P={pval(tpsc,5.5,4.94,5.5)},{pval(tppc,5.3,4.93,5.3)},{pval(tpdc,4.3,4.3,4.3)},4.15,5.12"
%   char  strnc "{strnc} PZ={ploc(tpsc,5.5,4.94,6.5)},{ploc(tppc,5.3,4.93,6.5)},{ploc(tpdc,0,0,5.4)}"
%   char  strnc "{strnc} IDMOD=0,0,1,1,1"
%   endif
%   char  strna "P={pval(tpsa,0,2.88,3.5)},{pval(tppa,0,2.70,3.5)},3.25,4.15,5.12"
%   char  strna "{strna} PZ={ploc(tpsa,0,2.88,3.5)},{ploc(tppa,0,2.70,3.5)},0 IDMOD=0,0,1,1,1"
%   ifdef f
%   elseifd bigbas==11 | bigbas==12
%     ifdef f
%     elseifd eltc=='Ce'
%     char  basc "RSMH=3.0,1.2,1.7,1.6,{lgc?1.6:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     ifdef bigbas==11 | bigbas==12
%     char  basc "{basc} RSMH2=3.0,1.2,1.7,1.6 EH2={ehmax-1},{ehmax-1},{ehmax-1},{ehmax-1},{ehmax-1}
%     endif
%     elseifd eltc=='Hf'
%     char  basc "RSMH=1.5,1.0,1.2,{tpfc<>3?0.9:1.3},1.4 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.5,1.0,1.7,{tpfc<>3?0.9:1.3} EH2={ehmax-.8},{ehmax-.8},{ehmax-.8},{ehmax-.8}"
%     elseifd eltc=='Zr'
%     char  basc "RSMH=1.0,1.0,1.0,{lfc?1.1:0},{lgc?1.1:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.0,{bigbas==11?0:1.0},1.0 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.80"
%     endif
%     char  basa "RSMH=0.85,0.75,1.5 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=0.85,0.80,1.5 EH2={ehmax-1},{ehmax-1},{ehmax-1},{ehmax-1}"
%     char  base "RSMH=1.7,1.7,1.7*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     ifdef f
%     elseifd eltc=='Ce'
%     char  basc "RSMH=3.0,1.2,1.7,1.6 EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     elseifd eltc=='Hf'
%     char  basc "RSMH=1.5,1.0,1.7,{tpfc<>3?0.9:1.3} EH={ehmax},-1,{ehmax},{tpfc<>3?-.7:ehmax}"
%     elseifd eltc=='Zr'
%     char  basc "RSMH=1.6,1.0,1.3 EH={ehmax},{tppc=3?-.7:-1.2},{ehmax},{ehmax}"
%     endif
%     char  basa "RSMH=0.85,0.80,1.5 EH=-1.0,{ehmax},{ehmax},{ehmax}"
%     char  base "RSMH=1.7,1.7,1.7*0 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   endif
% elseifd cmpd=='CoO2' | cmpd=='NaCoO2'
#   CoO2 in the trigonal structure
%   ifdef cmpd=='CoO2'
%     const a=3.0226 q=2.65139 nbas={les?4:3} nspec={les?3:2}
%     const rwc=1.92 rwa=1.55  rwea=2.246*{les>=10?0:1}
%   else
%     const a=3.12482 q=3.007445 nbas=4 nspec=3
%     const rwc=2.00 rwa=1.61 rwb=2.65 rwea=0
%   endif
%   const tpan=t metal=f a=5.413/.529 elind=-1 gmax=11
#   Build Co PZ; don't bother with P
%   char i c
%   char strn{i}={ploc({tps{i}},0,{{pqnsc(Z{i})}+.94},{{pqnsc(Z{i})}+2.5})}
%   char strn{i}="{strn{i}},{ploc({tpp{i}},0,{{pqnsc(Z{i})}+.93},{{pqnsc(Z{i})}+2.5})}
%   char strn{i}="{strn{i}},{ploc({tpd{i}},0,0,{{pqnd(Z{i})}+1.5})}
%   char strn{i} "PZ={strn{i}} RS3=0.80 IDMOD=0,0,0,1,1"
%   if nelt>2
%   char strnb "P={pval(tpsb,0,2.94,3.5)},{pval(tppb,0,2.93,3.5)},3.3,4.15,5.12"
%   char strnb "{strnb} PZ={ploc(tpsb,0,2.94,3.5)},{ploc(tppb,0,2.93,3.5)},{ploc(tpdb,0,0,4.15)} IDMOD=0,0,1,1,1"
%   ifdef tpsb==3
%   char strnb "{strnb} Q=0,0,0"
%   endif
%   endif
%   char strna "P={pval(tpsa,0,2.88,3.5)},{pval(tppa,0,2.70,3.5)},3.25,4.15,5.12"
%   char strna "{strna} PZ={ploc(tpsa,0,2.88,3.5)},{ploc(tppa,0,2.70,3.5)},0 IDMOD=0,0,1,1,1"
%   udef i
%   ifdef f
%   elseifd bigbas
%     char  basc "RSMH=1.9,1.9,1.05,{lfc?1.8:0},{lgc?1.8:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basc "{basc} RSMH2=1.9,1.9,1.00 EH2={ehmax-.9},{tppc?-2:ehmax-.9},{ehmax-.9}"
%     if nelt>2
%     char  basb "RSMH=1.5,1.5,1.5,{lfb?1.5:0},{lgb?1.5:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basb "{basb} RSMH2=1.5,{tppb==2?.8:{bigbas==11?0:1.5}},1.5 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8} RS3=.80"
%     endif
%     char  basa "RSMH=0.80,0.80,0.80,{lfa?0.80:0} EH={tpsa==3?ehmax:-.5},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basa "{basa} RSMH2=0.80,0.80,0.80 EH2={tpsa==3?ehmax-.8:-1.5},{ehmax-.8},{ehmax-.8} RS3=.9"
%     char  base "RSMH=1.9,1.9,1.9,1.9  EH={ehmax},{ehmax},{ehmax},{ehmax}"
%   else
%     char  basc "RSMH=1.9,1.9,0.95 EH={ehmax},{ehmax},{ehmax},{ehmax}"
%     if nelt>2
%     char  basb "RSMH=1.5,1.5,1.5,1.5,{lgb?1.5:0} EH={ehmax},{ehmax},{ehmax},{ehmax},{ehmax}"
%     char  basb "{basb} RSMH2=1.5,1.5,1.5 EH2={ehmax-.8},{ehmax-.8},{ehmax-.8}"
%     endif
%     char  basa "RSMH=0.85,0.85,0.85 EH=-1.1,-.5,{ehmax},{ehmax}"
%     char  base "RSMH=1.9,1.9,1.9     EH={ehmax},{ehmax},{ehmax}"
%   endif
% endif
#---------------- Default materials properties  ----------------
% const q=sqrt(8/3)
# % show vars
# % stop
